function f(e){return Object.prototype.toString.call(e)==="[object Array]"}function _(e,r){if(!e)throw new Error(r)}function A(e){return Object.keys(e)}function m(e){return Object.keys(e).map(function(r){return[r,e[r]]})}function p(e,r,n){var t="."+r,a=new RegExp("(\\".concat(r,")?$"));return n(e).replace(a,t)}function G(e){return e.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function X(e){return Array(e+1).join(" ")}function z(e){return e.replace(/([<>&])/g,function(r,n){switch(n){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}})}function W(e,r,n){switch(r){case"txt":{var t="text/plain;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}case"css":{var t="text/css;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}case"html":{var t="text/html;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}case"json":{var t="text/json;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}case"csv":{var t="text/csv;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}case"xls":{var t="text/application/vnd.ms-excel;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}case"xml":{var t="text/application/xml;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:t})):"data:,".concat(t)+encodeURIComponent(e)}default:return""}}function E(e,r,n,t){n===void 0&&(n="download"),t===void 0&&(t=!0);var a=W(e,r,t),o=document.createElement("a");o.href=a,o.download=n,o.setAttribute("style","visibility:hidden"),document.body.appendChild(o),o.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(o)}var x=globalThis&&globalThis.__assign||function(){return x=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},x.apply(this,arguments)},b=globalThis&&globalThis.__read||function(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),a,o=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)o.push(a.value)}catch(c){u={error:c}}finally{try{a&&!a.done&&(n=t.return)&&n.call(t)}finally{if(u)throw u.error}}return o};function Y(e){if(!e||f(e)&&!e.length||!f(e)&&!A(e).length)return function(n){return n};var r=f(e)?e.reduce(function(n,t){var a;return x(x({},n),(a={},a[t]=t,a))},Object.create(null)):e;return function(n){return f(n)?n.map(function(t){return m(t).reduce(function(a,o){var u=b(o,2),c=u[0],i=u[1];return c in r&&(a[r[c]]=i),a},Object.create(null))}).filter(function(t){return A(t).length}):m(n).reduce(function(t,a){var o=b(a,2),u=o[0],c=o[1];return u in r&&(t[r[u]]=c),t},Object.create(null))}}function H(e){var r="Invalid export data. Please provide a valid JSON";try{return typeof e=="string"?JSON.parse(e):e}catch{throw new Error(r)}}function K(e,r,n){r===void 0&&(r=null);var t="Invalid export data. Please provide valid JSON object";try{return JSON.stringify(e,r,n)}catch{throw new Error(t)}}function M(e){return e.map(m).reduce(function(r,n,t){return n.reduce(function(a,o){var u=b(o,2),c=u[0],i=u[1],l=a[c]||Array.from({length:e.length}).map(function(s){return""});return l[t]=(typeof i!="string"?JSON.stringify(i):i)||"",a[c]=l,a},r)},Object.create(null))}function T(e,r){return r===void 0&&(r=function(n){return n}),r(m(e).map(function(n){var t=b(n,2),a=t[0],o=t[1];return{fieldName:a,fieldValues:o}}))}function B(e){var r=/,|"|\n/.test(e)?'"':"",n=e.replace(/"/g,'""');return"".concat(r).concat(n).concat(r)}function Z(e,r){if(r===void 0&&(r=function(c){return c}),!e.length)return"";var n=M(e),t=T(n,r),a=t.map(function(c){var i=c.fieldName;return i}).join(",")+`\r
`,o=t.map(function(c){var i=c.fieldValues;return i}).map(function(c){return c.map(B)}),u=o.reduce(function(c,i){return c.map(function(l,s){return"".concat(l,",").concat(i[s])})});return a+u.join(`\r
`)}function $(e,r){_(e.length>0);var n=M(e),t=T(n,r),a=t.map(function(c){var i=c.fieldName;return i}).join("</b></th><th><b>"),o=t.map(function(c){var i=c.fieldValues;return i}).map(function(c){return c.map(function(i){return"<td>".concat(i,"</td>")})}),u=o.reduce(function(c,i){return c.map(function(l,s){return"".concat(l).concat(i[s])})});return`
    <table>
      <thead>
        <tr><th><b>`.concat(a,`</b></th></tr>
      </thead>
      <tbody>
        <tr>`).concat(u.join(`</tr>
        <tr>`),`</tr>
      </tbody>
    </table>
  `)}function q(e,r){if(r===void 0&&(r=function(t){return t}),!e.length)return"";var n=`<html>
  <head>
    <meta charset="UTF-8" />
  </head >
  <body>
    `.concat($(e,r),`
  </body>
</html >
`);return n}function Q(e){var r=`<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>
`.concat(g(e,"base"),`
`);return r}function g(e,r,n,t){n===void 0&&(n="element"),t===void 0&&(t=0);var a=G(r),o=X(t);if(e==null)return"".concat(o,"<").concat(a," />");var u=f(e)?e.map(function(i){return g(i,n,n,t+2)}).join(`
`):typeof e=="object"?m(e).map(function(i){var l=b(i,2),s=l[0],y=l[1];return g(y,s,n,t+2)}).join(`
`):o+"  "+z(String(e)),c="".concat(o,"<").concat(a,`>
`).concat(u,`
`).concat(o,"</").concat(a,">");return c}var ee={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"};function C(e){var r=e.data,n=e.fileName,t=n===void 0?"download":n,a=e.extension,o=e.fileNameFormatter,u=o===void 0?function(w){return w.replace(/\s+/,"_")}:o,c=e.fields,i=e.exportType,l=i===void 0?"txt":i,s=e.replacer,y=s===void 0?null:s,j=e.space,D=j===void 0?4:j,O=e.processor,v=O===void 0?E:O,L=e.withBOM,F=L===void 0?!1:L,R=e.beforeTableEncode,S=R===void 0?function(w){return w}:R,U="Invalid export data. Please provide an array of objects",J="Can't export unknown data type ".concat(l,"."),V="Can't export string data to ".concat(l,".");if(typeof r=="string")switch(l){case"txt":case"css":case"html":return v(r,l,p(t,a!=null?a:l,u));default:throw new Error(V)}var P=Y(c),d=P(H(r)),N=K(d,y,D);switch(l){case"txt":case"css":case"html":return v(N,l,p(t,a!=null?a:l,u));case"json":return v(N,l,p(t,a!=null?a:"json",u));case"csv":{_(f(d),U);var k="\uFEFF",I=Z(d,S),h=F?k+I:I;return v(h,l,p(t,a!=null?a:"csv",u))}case"xls":{_(f(d),U);var h=q(d,S);return v(h,l,p(t,a!=null?a:"xls",u))}case"xml":{var h=Q(d);return v(h,l,p(t,a!=null?a:"xml",u))}default:throw new Error(J)}}C.types=ee;C.processors={downloadFile:E};export{C as e};
