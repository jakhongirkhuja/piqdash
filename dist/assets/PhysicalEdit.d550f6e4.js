import{G as z}from"./GoBackButton.8ec57f12.js";import{c as w}from"./vue-datepicker.es.17b3f44e.js";import{h as U}from"./maska.esm.cd315c5a.js";import{u as E,r as g,m as x,i as k}from"./index.esm.b21b73c4.js";import{_ as C,r as j,o as n,c as i,f as N,a as s,F as d,e as p,d as b,t as u,l as O,w as f,p as R,n as v,v as y,a2 as V,a3 as B}from"./index.34e73fda.js";import{s as I}from"./globalFunction.5ce06618.js";const P={setup(){return{v$:E()}},directives:{maska:U},components:{GoBackButton:z,Datepicker:w},data(){return{url:"https://api.pharmiq.uz/",name_ru:"",name_uz:"",banner_ru:[],price:0,amount:0,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,descriptionText_ru:"",descriptionText_uz:"",storeChoose:null,store:[],banner_ru_prev:[]}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{descriptionText_ru:{required:g,minLengthValue:x(5)},descriptionText_uz:{required:g,minLengthValue:x(5)},name_ru:{required:g,minLengthValue:x(3)},name_uz:{required:g,minLengthValue:x(3)},price:{required:g,integer:k},amount:{required:g,integer:k},storeChoose:{required:g}}},methods:{async removeImage(l,o){let c=o.split("/").slice(-1)[0];if(c){var r=confirm("Want to delete Image?");if(r){const h={imageName:c},_=I(),e=Object.assign(h,_);var t=new FormData;for(const a in e)t.append(a,e[a]);try{let a=localStorage.getItem("token");const T=await fetch(this.url+"api/v1/store/physicalstore/products/image/delete/"+this.$route.params.id,{method:"POST",body:t,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+a}}),S=await T.json();window.scrollTo({top:0,behavior:"smooth"}),T.status==401?(this.resStringError=S.message,this.added=!1):S.error?(typeof S.message=="object"?this.resError=S.message:this.resStringError=S.message,this.added=!1):(document.querySelector("#s-"+l).remove(),this.resSuccess="Image Successfully Deleted")}catch(a){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",a)}}}},async requestApi(){this.added=!0;const l={name_ru:this.name_ru.toUpperCase(),name_uz:this.name_uz.toUpperCase(),description_ru:this.descriptionText_ru,description_uz:this.descriptionText_uz,price:this.price,amount:this.amount,ordered:0,category_id:1,store_id:this.storeChoose},o=I(),c=Object.assign(l,o);var r=new FormData;this.banner_ru.length!=0&&this.banner_ru.forEach(t=>{r.append("img[]",t)});for(const t in c)r.append(t,c[t]);try{let t=localStorage.getItem("token");const h=await fetch(this.url+"api/v1/store/physicalstore/products/edit/"+this.$route.params.id,{method:"POST",body:r,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+t}}),_=await h.json();window.scrollTo({top:0,behavior:"smooth"}),h.status==401?(this.resStringError=_.message,this.added=!1):_.error?(typeof _.message=="object"?this.resError=_.message:this.resStringError=_.message,this.added=!1):this.resSuccess="Physical Store Product Successfully Updated"}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},uploadFilebannerRu(l){var o=l.target.files||l.dataTransfer.files;if(o.length==0){this.banner_ru=[],this.banner_ru_prev=[];return}for(let c=0;c<o.length;c++){const r=o[c];this.banner_ru.push(r),this.banner_ru_prev.push(URL.createObjectURL(r))}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},requestGetStore(){let l=this.url+"api/v1/getStoresByType?type=phyisical",o=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(l,c).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.store=r.data})},getStore(){let l=this.url+"api/v1/store/physicalstore/products?product_id="+this.$route.params.id,o=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(l,c).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{if(r){this.name_ru=JSON.parse(r.name).ru,this.name_uz=JSON.parse(r.name).uz,this.descriptionText_ru=JSON.parse(r.description).ru,this.descriptionText_uz=JSON.parse(r.description).uz,this.price=r.price,this.amount=r.amount;try{JSON.parse(`${r.img}`).forEach(t=>{this.banner_ru_prev.push(this.url+"files/physicalStoreProduct/"+t)})}catch{this.banner_ru_prev=this.url+"files/physicalStoreProduct/"+r.img}this.storeChoose=r.store_id}})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getStore(),this.requestGetStore()}},m=l=>(V("data-v-5090585e"),l=l(),B(),l),A={class:"mt-3"},q={class:"row"},D={class:"col-md-12 grid-margin stretch-card"},L={class:"card"},$={class:"card-body"},F=m(()=>s("h4",{class:"card-title"},"Update Store",-1)),G={class:"error"},J={key:1,class:"error"},M={key:2,class:"success"},Z={class:"form-group row"},H={class:"col-md-12"},X=m(()=>s("label",{for:"banner"},"Stores",-1)),W=m(()=>s("option",{disabled:"",value:"0"},"Please select one",-1)),K=["value"],Q={class:"col-md-6"},Y=m(()=>s("label",{for:"exampleInputTitleRu"},"Name ru",-1)),ee={class:"col-md-6"},re=m(()=>s("label",{for:"exampleInputTitleRu"},"Name uz",-1)),te={class:"col-md-6"},se=m(()=>s("label",{for:"exampleInputTitleRu"},"Description ru ",-1)),oe={class:"col-md-6"},ne=m(()=>s("label",{for:"exampleInputTitleRu"},"Description uz ",-1)),ie={class:"col-md-12"},ae=m(()=>s("label",{class:"col-sm-4",for:"banner"},"Image",-1)),le={class:"banner"},ce={key:0},ue=["src"],de=["id"],pe=["src"],me=["onClick"],he={class:"col-md-6"},_e=m(()=>s("label",{for:"exampleInputTitleUZ"},"Price $",-1)),ge={class:"col-md-6"},fe=m(()=>s("label",{for:"exampleInputTitleUZ"},"Amount",-1)),ve=["disabled"];function be(l,o,c,r,t,h){const _=j("GoBackButton");return n(),i(d,null,[N(_),s("div",A,[s("div",q,[s("div",D,[s("div",L,[s("div",$,[F,t.resError?(n(!0),i(d,{key:0},p(t.resError,(e,a)=>(n(),i("p",G,u(a)+" : "+u(e[0]),1))),256)):b("",!0),t.resStringError?(n(),i("p",J,u(t.resStringError),1)):b("",!0),t.resSuccess?(n(),i("p",M,u(t.resSuccess),1)):b("",!0),s("form",{class:"forms-sample",onSubmit:o[8]||(o[8]=O(e=>h.submitForm(),["prevent"]))},[s("div",Z,[s("div",H,[X,f(s("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>t.storeChoose=e),class:v(["form-control",{"border border-danger":r.v$.storeChoose.$errors.length>0}])},[W,(n(!0),i(d,null,p(t.store,e=>(n(),i("option",{key:e.id,value:e.id},u(e.name),9,K))),128))],2),[[R,t.storeChoose]]),(n(!0),i(d,null,p(r.v$.storeChoose.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))]),s("div",Q,[Y,f(s("input",{type:"text",class:v(["form-control capilizie",{"border border-danger":r.v$.name_ru.$errors.length>0}]),placeholder:"IPHONE 14 PRO MAX",id:"exampleInputTitleRu","onUpdate:modelValue":o[1]||(o[1]=e=>t.name_ru=e)},null,2),[[y,t.name_ru]]),(n(!0),i(d,null,p(r.v$.name_ru.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))]),s("div",ee,[re,f(s("input",{type:"text",class:v(["form-control capilizie",{"border border-danger":r.v$.name_uz.$errors.length>0}]),placeholder:"IPHONE 14 PRO MAX UZ",id:"exampleInputTitleRu","onUpdate:modelValue":o[2]||(o[2]=e=>t.name_uz=e)},null,2),[[y,t.name_uz]]),(n(!0),i(d,null,p(r.v$.name_uz.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))]),s("div",te,[se,f(s("input",{type:"text",class:v(["form-control",{"border border-danger":r.v$.descriptionText_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":o[3]||(o[3]=e=>t.descriptionText_ru=e)},null,2),[[y,t.descriptionText_ru]]),(n(!0),i(d,null,p(r.v$.descriptionText_ru.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))]),s("div",oe,[ne,f(s("input",{type:"text",class:v(["form-control",{"border border-danger":r.v$.descriptionText_uz.$errors.length>0}]),id:"exampleInputTitleUz","onUpdate:modelValue":o[4]||(o[4]=e=>t.descriptionText_uz=e)},null,2),[[y,t.descriptionText_uz]]),(n(!0),i(d,null,p(r.v$.descriptionText_uz.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))]),s("div",ie,[ae,s("div",le,[typeof t.banner_ru_prev=="string"?(n(),i("div",ce,[t.banner_ru_prev?(n(),i("img",{key:0,src:t.banner_ru_prev,class:"image_prev"},null,8,ue)):b("",!0)])):(n(!0),i(d,{key:1},p(t.banner_ru_prev,(e,a)=>(n(),i("div",{id:"s-"+a},[s("img",{style:{"max-height":"250px"},src:e,width:"100",class:"image_prev"},null,8,pe),t.banner_ru_prev.length>1?(n(),i("span",{key:0,onClick:T=>h.removeImage(a,e)},"remove",8,me)):b("",!0)],8,de))),256))]),s("input",{multiple:"",type:"file",id:"banner",onChange:o[5]||(o[5]=e=>h.uploadFilebannerRu(e)),accept:"image/*",class:"form-control"},null,32)]),s("div",he,[_e,f(s("input",{type:"number",class:v(["form-control",{"border border-danger":r.v$.price.$errors.length>0}]),placeholder:"100",id:"exampleInputTitleUZ","onUpdate:modelValue":o[6]||(o[6]=e=>t.price=e)},null,2),[[y,t.price]]),(n(!0),i(d,null,p(r.v$.price.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))]),s("div",ge,[fe,f(s("input",{type:"number",class:v(["form-control",{"border border-danger":r.v$.amount.$errors.length>0}]),placeholder:"10",id:"exampleInputTitleUZ","onUpdate:modelValue":o[7]||(o[7]=e=>t.amount=e)},null,2),[[y,t.amount]]),(n(!0),i(d,null,p(r.v$.amount.$errors,(e,a)=>(n(),i("small",{class:"error",key:a},u(e.$message),1))),128))])]),t.added?b("",!0):(n(),i("button",{key:0,type:"submit",disabled:h.isDisabled,class:"btn btn-primary mr-2"},"Update",8,ve))],32)])])])])])],64)}const we=C(P,[["render",be],["__scopeId","data-v-5090585e"]]);export{we as default};
