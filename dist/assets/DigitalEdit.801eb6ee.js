import{G as E}from"./GoBackButton.8ec57f12.js";import{c as T}from"./vue-datepicker.es.17b3f44e.js";import{h as U}from"./maska.esm.cd315c5a.js";import{u as x,r as v,m as I,i as w}from"./index.esm.b21b73c4.js";import{_ as C,r as j,o as n,c as i,f as B,a as s,F as p,e as h,d as g,t as u,l as N,w as b,p as O,n as S,v as y,a2 as A,a3 as R}from"./index.34e73fda.js";import{s as z}from"./globalFunction.5ce06618.js";const q={setup(){return{v$:x()}},directives:{maska:U},components:{GoBackButton:E,Datepicker:T},data(){return{url:"https://api.pharmiq.uz/",name_ru:"",name_uz:"",banner_ru:[],price:0,amount:0,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,descriptionText_ru:"",descriptionText_uz:"",storeChoose:null,store:[],banner_ru_prev:[]}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{name_ru:{required:v,minLengthValue:I(3)},name_uz:{required:v,minLengthValue:I(3)},price:{required:v,integer:w},amount:{required:v,integer:w},storeChoose:{required:v}}},methods:{async removeImage(l,o){let c=o.split("/").slice(-1)[0];if(c){var r=confirm("Want to delete Image?");if(r){const d={imageName:c},m=z(),t=Object.assign(d,m);var e=new FormData;for(const a in t)e.append(a,t[a]);try{let a=localStorage.getItem("token");const k=await fetch(this.url+"api/v1/store/digitalstore/products/image/delete/"+this.$route.params.id,{method:"POST",body:e,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+a}}),f=await k.json();window.scrollTo({top:0,behavior:"smooth"}),k.status==401?(this.resStringError=f.message,this.added=!1):f.error?(typeof f.message=="object"?this.resError=f.message:this.resStringError=f.message,this.added=!1):(document.querySelector("#s-"+l).remove(),this.resSuccess="Image Successfully Deleted")}catch(a){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",a)}}}},async requestApi(){this.added=!0;const l={name_ru:this.name_ru.toUpperCase(),name_uz:this.name_uz.toUpperCase(),price:this.price,amount:this.amount,ordered:0,category_id:1,store_id:this.storeChoose},o=z(),c=Object.assign(l,o);var r=new FormData;this.banner_ru.length!=0&&this.banner_ru.forEach(e=>{r.append("img[]",e)});for(const e in c)r.append(e,c[e]);try{let e=localStorage.getItem("token");const d=await fetch(this.url+"api/v1/store/digitalstore/products/edit/"+this.$route.params.id,{method:"POST",body:r,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+e}}),m=await d.json();window.scrollTo({top:0,behavior:"smooth"}),d.status==401?(this.resStringError=m.message,this.added=!1):m.error?(typeof m.message=="object"?this.resError=m.message:this.resStringError=m.message,this.added=!1):this.resSuccess="Digital Store Product Successfully Updated"}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",e)}},uploadFilebannerRu(l){var o=l.target.files||l.dataTransfer.files;if(o.length==0){this.banner_ru=[],this.banner_ru_prev=[];return}for(let c=0;c<o.length;c++){const r=o[c];this.banner_ru.push(r),this.banner_ru_prev.push(URL.createObjectURL(r))}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},requestGetStore(){let l=this.url+"api/v1/getStoresByType?type=digital",o=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(l,c).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.store=r.data})},getStore(){let l=this.url+"api/v1/store/digitalstore/products?product_id="+this.$route.params.id,o=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(l,c).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{if(r){this.name_ru=JSON.parse(r.name).ru,this.name_uz=JSON.parse(r.name).uz,this.price=r.price,this.amount=r.amount;try{JSON.parse(`${r.img}`).forEach(e=>{this.banner_ru_prev.push(this.url+"files/digitalStoresProduct/"+e)})}catch{this.banner_ru_prev=this.url+"files/digitalStoresProduct/"+r.img}this.storeChoose=r.store_id}})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getStore(),this.requestGetStore()}},_=l=>(A("data-v-da2cef2d"),l=l(),R(),l),D={class:"mt-3"},P={class:"row"},V={class:"col-md-12 grid-margin stretch-card"},F={class:"card"},G={class:"card-body"},L=_(()=>s("h4",{class:"card-title"},"Update Store",-1)),$={class:"error"},M={key:1,class:"error"},Z={key:2,class:"success"},H={class:"form-group row"},J={class:"col-md-12"},X=_(()=>s("label",{for:"banner"},"Stores",-1)),W=_(()=>s("option",{disabled:"",value:"0"},"Please select one",-1)),K=["value"],Q={class:"col-md-6"},Y=_(()=>s("label",{for:"exampleInputTitleRu"},"Name ru",-1)),ee={class:"col-md-6"},re=_(()=>s("label",{for:"exampleInputTitleRu"},"Name uz",-1)),te={class:"col-md-12"},se=_(()=>s("label",{class:"col-sm-4",for:"banner"},"Image",-1)),oe={class:"banner"},ne={key:0},ie=["src"],ae=["id"],le=["src"],ce=["onClick"],ue={class:"col-md-6"},de=_(()=>s("label",{for:"exampleInputTitleUZ"},"Price $",-1)),me={class:"col-md-6"},pe=_(()=>s("label",{for:"exampleInputTitleUZ"},"Amount",-1)),he=["disabled"];function _e(l,o,c,r,e,d){const m=j("GoBackButton");return n(),i(p,null,[B(m),s("div",D,[s("div",P,[s("div",V,[s("div",F,[s("div",G,[L,e.resError?(n(!0),i(p,{key:0},h(e.resError,(t,a)=>(n(),i("p",$,u(a)+" : "+u(t[0]),1))),256)):g("",!0),e.resStringError?(n(),i("p",M,u(e.resStringError),1)):g("",!0),e.resSuccess?(n(),i("p",Z,u(e.resSuccess),1)):g("",!0),s("form",{class:"forms-sample",onSubmit:o[6]||(o[6]=N(t=>d.submitForm(),["prevent"]))},[s("div",H,[s("div",J,[X,b(s("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>e.storeChoose=t),class:S(["form-control",{"border border-danger":r.v$.storeChoose.$errors.length>0}])},[W,(n(!0),i(p,null,h(e.store,t=>(n(),i("option",{key:t.id,value:t.id},u(t.name),9,K))),128))],2),[[O,e.storeChoose]]),(n(!0),i(p,null,h(r.v$.storeChoose.$errors,(t,a)=>(n(),i("small",{class:"error",key:a},u(t.$message),1))),128))]),s("div",Q,[Y,b(s("input",{type:"text",class:S(["form-control capilizie",{"border border-danger":r.v$.name_ru.$errors.length>0}]),placeholder:"IPHONE 14 PRO MAX",id:"exampleInputTitleRu","onUpdate:modelValue":o[1]||(o[1]=t=>e.name_ru=t)},null,2),[[y,e.name_ru]]),(n(!0),i(p,null,h(r.v$.name_ru.$errors,(t,a)=>(n(),i("small",{class:"error",key:a},u(t.$message),1))),128))]),s("div",ee,[re,b(s("input",{type:"text",class:S(["form-control capilizie",{"border border-danger":r.v$.name_uz.$errors.length>0}]),placeholder:"IPHONE 14 PRO MAX UZ",id:"exampleInputTitleRu","onUpdate:modelValue":o[2]||(o[2]=t=>e.name_uz=t)},null,2),[[y,e.name_uz]]),(n(!0),i(p,null,h(r.v$.name_uz.$errors,(t,a)=>(n(),i("small",{class:"error",key:a},u(t.$message),1))),128))]),s("div",te,[se,s("div",oe,[typeof e.banner_ru_prev=="string"?(n(),i("div",ne,[e.banner_ru_prev?(n(),i("img",{key:0,src:e.banner_ru_prev,class:"image_prev"},null,8,ie)):g("",!0)])):(n(!0),i(p,{key:1},h(e.banner_ru_prev,(t,a)=>(n(),i("div",{id:"s-"+a},[s("img",{style:{"max-height":"250px"},src:t,width:"100",class:"image_prev"},null,8,le),e.banner_ru_prev.length>1?(n(),i("span",{key:0,onClick:k=>d.removeImage(a,t)},"remove",8,ce)):g("",!0)],8,ae))),256))]),s("input",{multiple:"",type:"file",id:"banner",onChange:o[3]||(o[3]=t=>d.uploadFilebannerRu(t)),accept:"image/*",class:"form-control"},null,32)]),s("div",ue,[de,b(s("input",{type:"number",class:S(["form-control",{"border border-danger":r.v$.price.$errors.length>0}]),placeholder:"100",id:"exampleInputTitleUZ","onUpdate:modelValue":o[4]||(o[4]=t=>e.price=t)},null,2),[[y,e.price]]),(n(!0),i(p,null,h(r.v$.price.$errors,(t,a)=>(n(),i("small",{class:"error",key:a},u(t.$message),1))),128))]),s("div",me,[pe,b(s("input",{type:"number",class:S(["form-control",{"border border-danger":r.v$.amount.$errors.length>0}]),placeholder:"10",id:"exampleInputTitleUZ","onUpdate:modelValue":o[5]||(o[5]=t=>e.amount=t)},null,2),[[y,e.amount]]),(n(!0),i(p,null,h(r.v$.amount.$errors,(t,a)=>(n(),i("small",{class:"error",key:a},u(t.$message),1))),128))])]),e.added?g("",!0):(n(),i("button",{key:0,type:"submit",disabled:d.isDisabled,class:"btn btn-primary mr-2"},"Update",8,he))],32)])])])])])],64)}const Ie=C(q,[["render",_e],["__scopeId","data-v-da2cef2d"]]);export{Ie as default};
