import{G as S}from"./GoBackButton.8ec57f12.js";import{c as T}from"./vue-datepicker.es.17b3f44e.js";import{h as B}from"./maska.esm.cd315c5a.js";import{u as w,b as g,r as C}from"./index.esm.b21b73c4.js";import{_ as q,r as I,o as t,c as a,f as E,a as o,F as p,e as _,d as m,t as c,l as x,w as b,p as y,n as v,v as k,a2 as z,a3 as A}from"./index.34e73fda.js";import{s as F}from"./globalFunction.5ce06618.js";const V={setup(){return{v$:w()}},directives:{maska:B},components:{GoBackButton:S,Datepicker:T},data(){return{url:"https://api.pharmiq.uz/",name_ru:"",name_uz:"",banner_ru:null,price:0,amount:0,added:!1,facevalue:null,barcode:null,resError:!1,importType:0,resSuccess:!1,resStringError:"",userInfo:null,descriptionText_ru:"",descriptionText_uz:"",storeChoose:null,store:[],banner_ru_prev:[]}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{barcode:{required:g(()=>this.importType==0)},facevalue:{required:g(()=>this.importType==0)},storeChoose:{required:C},banner_ru:{required:g(()=>this.importType==1)}}},methods:{async requestApi(){this.added=!0;const l={type:this.importType,barcode:this.barcode,facevalue:this.facevalue,store_id:this.storeChoose},s=F(),f=Object.assign(l,s);var n=new FormData;this.importType==1&&n.append("excel",this.banner_ru);for(const e in f)n.append(e,f[e]);try{let e=localStorage.getItem("token");const h=await fetch(this.url+"api/v1/store/korzinkabarcode/add",{method:"POST",body:n,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+e}}),u=await h.json();window.scrollTo({top:0,behavior:"smooth"}),h.status==401?(this.resStringError=u.message,this.added=!1):u.error?(typeof u.message=="object"?this.resError=u.message:this.resStringError=u.message,this.added=!1):this.resSuccess="Barcode Successfully Added"}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",e)}},uploadFilebannerRu(l){var s=l.target.files||l.dataTransfer.files;if(console.log(s),console.log("22222222"),s.length==0){this.banner_ru=[],this.banner_ru_prev=[];return}this.banner_ru=s[0]},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},requestGetStore(){let l=this.url+"api/v1/store/getStoresByType?type=digital",s=localStorage.getItem("token");const f={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(l,f).then(n=>(n.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),n.json())).then(n=>{this.store=n.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.requestGetStore()}},d=l=>(z("data-v-692d93b8"),l=l(),A(),l),j={class:"mt-3"},G={class:"row"},U={class:"col-md-12 grid-margin stretch-card"},D={class:"card"},N={class:"card-body"},$=d(()=>o("h4",{class:"card-title"},"Add Barcode",-1)),M={class:"error"},O={key:1,class:"error"},R={key:2,class:"success"},K={class:"form-group row"},L={class:"col-md-12"},P=d(()=>o("label",{for:"banner"},"Stores",-1)),H=d(()=>o("option",{disabled:"",value:"0"},"Please select one",-1)),J=["value"],Q={class:"col-md-12"},W=d(()=>o("label",{for:"banner"},"Type",-1)),X=d(()=>o("option",{selected:"",value:"0"},"Custom",-1)),Y=d(()=>o("option",{value:"1"},"File",-1)),Z=[X,Y],ee={key:0,class:"col-md-12"},re=d(()=>o("label",{class:"col-sm-4",for:"banner"},"Upload file",-1)),oe={key:1,class:"col-md-6"},se=d(()=>o("label",{for:"barcode"},"Barcode ",-1)),te={key:2,class:"col-md-6"},ae=d(()=>o("label",{for:"facevalue"},"FaceValue",-1)),ne=["disabled"];function le(l,s,f,n,e,h){const u=I("GoBackButton");return t(),a(p,null,[E(u),o("div",j,[o("div",G,[o("div",U,[o("div",D,[o("div",N,[$,e.resError?(t(!0),a(p,{key:0},_(e.resError,(r,i)=>(t(),a("p",M,c(i)+" : "+c(r[0]),1))),256)):m("",!0),e.resStringError?(t(),a("p",O,c(e.resStringError),1)):m("",!0),e.resSuccess?(t(),a("p",R,c(e.resSuccess),1)):m("",!0),o("form",{class:"forms-sample",onSubmit:s[5]||(s[5]=x(r=>h.submitForm(),["prevent"]))},[o("div",K,[o("div",L,[P,b(o("select",{"onUpdate:modelValue":s[0]||(s[0]=r=>e.storeChoose=r),class:v(["form-control",{"border border-danger":n.v$.storeChoose.$errors.length>0}])},[H,(t(!0),a(p,null,_(e.store,r=>(t(),a("option",{key:r.id,value:r.id},c(r.name),9,J))),128))],2),[[y,e.storeChoose]]),(t(!0),a(p,null,_(n.v$.storeChoose.$errors,(r,i)=>(t(),a("small",{class:"error",key:i},c(r.$message),1))),128))]),o("div",Q,[W,b(o("select",{"onUpdate:modelValue":s[1]||(s[1]=r=>e.importType=r),class:"form-control"},Z,512),[[y,e.importType]])]),e.importType==1?(t(),a("div",ee,[re,o("input",{type:"file",onChange:s[2]||(s[2]=r=>h.uploadFilebannerRu(r)),id:"banner",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",class:v([{"border border-danger":n.v$.banner_ru.$errors.length>0},"form-control"])},null,34),(t(!0),a(p,null,_(n.v$.banner_ru.$errors,(r,i)=>(t(),a("small",{class:"error",key:i},c(r.$message),1))),128))])):m("",!0),e.importType==0?(t(),a("div",oe,[se,b(o("input",{type:"text",class:v(["form-control",{"border border-danger":n.v$.barcode.$errors.length>0}]),placeholder:"Barcode",id:"barcode","onUpdate:modelValue":s[3]||(s[3]=r=>e.barcode=r)},null,2),[[k,e.barcode]]),(t(!0),a(p,null,_(n.v$.barcode.$errors,(r,i)=>(t(),a("small",{class:"error",key:i},c(r.$message),1))),128))])):m("",!0),e.importType==0?(t(),a("div",te,[ae,b(o("input",{type:"number",class:v(["form-control",{"border border-danger":n.v$.facevalue.$errors.length>0}]),placeholder:"0",id:"facevalue","onUpdate:modelValue":s[4]||(s[4]=r=>e.facevalue=r)},null,2),[[k,e.facevalue]]),(t(!0),a(p,null,_(n.v$.facevalue.$errors,(r,i)=>(t(),a("small",{class:"error",key:i},c(r.$message),1))),128))])):m("",!0)]),e.added?m("",!0):(t(),a("button",{key:0,type:"submit",disabled:h.isDisabled,class:"btn btn-primary mr-2"},"Create",8,ne))],32)])])])])])],64)}const he=q(V,[["render",le],["__scopeId","data-v-692d93b8"]]);export{he as default};
