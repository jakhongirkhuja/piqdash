import{G as v}from"./GoBackButton.8ec57f12.js";import{c as C}from"./vue-datepicker.es.17b3f44e.js";import{h as G}from"./maska.esm.cd315c5a.js";import{u as S,r as k,m as w}from"./index.esm.b21b73c4.js";import{_ as z,o as i,c as a,a as o,F as m,e as g,d as u,t as d,l as E,w as _,v as b,n as y,p as L,g as f,a2 as T,a3 as x}from"./index.34e73fda.js";import{s as j}from"./globalFunction.5ce06618.js";const I={setup(){return{v$:S()}},directives:{maska:G},components:{GoBackButton:v,Datepicker:C},data(){return{url:"https://api.pharmiq.uz/",hideGroups:!1,group_id:null,groups:[],generateLink:null,newspage:"",banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",copied:"Click to copy",resGenerateError:null,body_ru:"",startDate:null,endDate:null,body_uz:"",categories:[],generateLinkCopy:null,promocode_id:null,promocodes:[],phonebook_id:null,phonebooks:[],added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,resGenerateErrorGenerate:null,resGenerateNoErrorGenerate:null,generateLinkClickName:"Generate",price:0,bitlink_id:null,category_id:1,sendby:"SMS to phone Number",long_url:"https://downloadapp.pharmiq.uz?utm_source="}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{phonebook_id:{required:k},startDate:{required:k},body_uz:{required:k,minLengthValue:w(10)}}},methods:{copyToClipboard(){this.copied="Copied";const n=document.createElement("input");n.type="text",n.value=this.generateLinkCopy,document.body.appendChild(n),n.select(),document.execCommand("Copy"),document.body.removeChild(n),setTimeout(()=>{this.copied="Click to copy"},2e3)},getvalues(){this.generateLinkCopy="https://bit.ly/"+this.generateLink},async updateLinkClick(){const n={custom_bitlink:"bit.ly/"+this.generateLink,bitlink_id:this.bitlink_id};try{const e=await fetch("https://api-ssl.bitly.com/v4/custom_bitlinks",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer c901f75cdbf7109305be80438d5cfc005d12925b"}}),l=await e.json(),s=e.status;s==200||s==201?(this.generateLinkCopy="https://"+l.custom_bitlink,this.generateLink=l.custom_bitlink.split("/").at(-1),this.resGenerateErrorGenerate=null,this.resGenerateNoErrorGenerate="Updated"):(this.resGenerateErrorGenerate=l.description,this.resGenerateNoErrorGenerate=null)}catch(e){this.resGenerateErrorGenerate=e}},async generateLinkClick(){var n=new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?([^ ])+");if(this.long_url.match(n)){const e={long_url:this.long_url};try{const l=await fetch("https://api-ssl.bitly.com/v4/shorten",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer c901f75cdbf7109305be80438d5cfc005d12925b"}}),s=await l.json(),t=l.status;t==200||t==201?(this.generateLinkCopy=s.link,this.bitlink_id=s.id,this.generateLink=s.link.split("/").at(-1),this.resGenerateNoErrorGenerate="Success"):this.resGenerateErrorGenerate=s.description}catch(l){this.resGenerateErrorGenerate=l}}},getGroups(){let n=this.url+"api/v1/groups?page=1",e=localStorage.getItem("token");const l={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(n,l).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{this.groups=s.data,this.groups.length>0&&(this.group_id=this.groups[0].id)})},uploadFilebannerRu(n){var e=n.target.files||n.dataTransfer.files;!e.length||(this.banner_ru=e[0],this.banner_ru_prev=URL.createObjectURL(e[0]))},uploadFilebannerUz(n){var e=n.target.files||n.dataTransfer.files;!e.length||(this.banner_uz=e[0],this.banner_uz_prev=URL.createObjectURL(e[0]))},async requestApi(){const n={titleName_ru:"sending sms ru",titleName_uz:"sending sms uz",descriptionText_ru:"sending boy ru",descriptionText_uz:this.body_uz,sentBy:this.sendby,newsPage:this.newspage,promocode_id:"",phonebook_id:this.phonebook_id,startDate:this.startDate.replace("T"," ")+":00",endDate:"2070-12-01 17:05:00"},e=j(),l=Object.assign(n,e);var s=new FormData;for(const t in l)s.append(t,l[t]);try{let t=localStorage.getItem("token");const c=await fetch(this.url+"api/v1/inbox/add",{method:"POST",body:s,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+t}}),r=await c.json();window.scrollTo({top:0,behavior:"smooth"}),c.status==401?this.resStringError=r.message:r.error?typeof r.message=="object"?this.resError=r.message:this.resStringError=r.message:this.resSuccess="Sms Successfully Added"}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)},getPromocode(){let n=this.url+"api/v1/promocode?page=1",e=localStorage.getItem("token");const l={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(n,l).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{this.promocodes=s.data})},getPhonebooks(){let n=this.url+"api/v1/groups?page=1",e=localStorage.getItem("token");const l={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(n,l).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{this.phonebooks=s.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getPromocode(),this.getPhonebooks()}},h=n=>(T("data-v-5d9c52e2"),n=n(),x(),n),U={class:"mt-3"},A={class:"row"},D={class:"col-md-12 grid-margin stretch-card"},N={class:"card"},B={class:"card-body"},R=h(()=>o("h4",{class:"card-title"},"Message ",-1)),V={class:"error"},q={key:1,class:"error"},O={key:2,class:"success"},P={class:"form-group row"},F={class:"col-md-12"},Z=h(()=>o("label",{for:"exampleInputbodyUZ"},"Body",-1)),M={class:"form-group row"},H={class:"col-md-6"},J=h(()=>o("label",{for:"exampleInputstartRu"},"Start Date",-1)),K={class:"col-md-6"},Q=h(()=>o("label",{class:"col-sm-12",for:"banner"},"Group",-1)),W=h(()=>o("option",{disabled:""},"Please select one",-1)),X=["value"],Y={class:"form-group row"},$={class:"col-md-12"},ee={key:0,class:"resError"},te={key:1,class:"noError"},re={class:"col-md-6"},oe=h(()=>o("label",{for:""},"Url",-1)),se={class:"input-group"},ne={class:"col-md-6"},ie=h(()=>o("label",{for:""},"Generated link",-1)),ae=f(),le=f(),ce={key:2,class:"resError"},de={class:"input-group mb-3"},ue=h(()=>o("div",{class:"input-group-prepend"},[o("span",{class:"input-group-text",style:{color:"initial"},id:"basic-addon3"},"https://bit.ly/")],-1)),pe=["disabled"],he=["disabled"];function me(n,e,l,s,t,c){return i(),a(m,null,[o("button",{type:"button",class:"btn btn-success",onClick:e[0]||(e[0]=r=>n.$router.replace({name:"sms.control.all"}))},"\xAB Back "),o("div",U,[o("div",A,[o("div",D,[o("div",N,[o("div",B,[R,t.resError?(i(!0),a(m,{key:0},g(t.resError,(r,p)=>(i(),a("p",V,d(p)+" : "+d(r[0]),1))),256)):u("",!0),t.resStringError?(i(),a("p",q,d(t.resStringError),1)):u("",!0),t.resSuccess?(i(),a("p",O,d(t.resSuccess),1)):u("",!0),o("form",{class:"forms-sample",onSubmit:e[11]||(e[11]=E(r=>c.submitForm(),["prevent"]))},[o("div",P,[o("div",F,[Z,_(o("textarea",{rows:"10",type:"text",class:y(["form-control",{"border border-danger":s.v$.body_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":e[1]||(e[1]=r=>t.body_uz=r)},null,2),[[b,t.body_uz]]),(i(!0),a(m,null,g(s.v$.body_uz.$errors,(r,p)=>(i(),a("small",{class:"error",key:p},d(r.$message),1))),128))])]),o("div",M,[o("div",H,[J,_(o("input",{type:"datetime-local",class:y(["form-control",{"border border-danger":s.v$.startDate.$errors.length>0}]),id:"exampleInputstartRu","onUpdate:modelValue":e[2]||(e[2]=r=>t.startDate=r)},null,2),[[b,t.startDate]]),(i(!0),a(m,null,g(s.v$.startDate.$errors,(r,p)=>(i(),a("small",{class:"error",key:p},d(r.$message),1))),128))]),o("div",K,[Q,_(o("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>t.phonebook_id=r),class:y(["form-control",{"border border-danger":s.v$.phonebook_id.$errors.length>0}])},[W,(i(!0),a(m,null,g(t.phonebooks,r=>(i(),a("option",{key:r.id,value:r.id},d(r.groupName),9,X))),128))],2),[[L,t.phonebook_id]]),(i(!0),a(m,null,g(s.v$.phonebook_id.$errors,(r,p)=>(i(),a("small",{class:"error",key:p},d(r.$message),1))),128))])]),o("div",Y,[o("div",$,[t.resGenerateErrorGenerate?(i(),a("div",ee,d(t.resGenerateErrorGenerate),1)):u("",!0),t.resGenerateNoErrorGenerate?(i(),a("div",te,d(t.resGenerateNoErrorGenerate),1)):u("",!0)]),o("div",re,[oe,o("div",se,[_(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=r=>t.long_url=r)},null,512),[[b,t.long_url]]),o("div",{class:"btn btn-primary ml-4",onClick:e[5]||(e[5]=(...r)=>c.generateLinkClick&&c.generateLinkClick(...r))},d(t.generateLinkClickName),1)])]),o("div",ne,[ie,ae,t.generateLinkCopy?(i(),a("span",{key:0,onClick:e[6]||(e[6]=(...r)=>c.copyToClipboard&&c.copyToClipboard(...r)),style:{display:"inline-block","background-color":"#9a9797",padding:"2px 10px","border-radius":"6px",color:"white"}},d(t.generateLinkCopy),1)):u("",!0),le,t.generateLinkCopy?(i(),a("span",{key:1,onClick:e[7]||(e[7]=(...r)=>c.copyToClipboard&&c.copyToClipboard(...r)),style:{"text-decoration":"underline",cursor:"pointer"}},d(t.copied),1)):u("",!0),t.resGenerateError?(i(),a("div",ce,d(t.resGenerateError),1)):u("",!0),o("div",de,[ue,_(o("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=r=>t.generateLink=r),onInput:e[9]||(e[9]=(...r)=>c.getvalues&&c.getvalues(...r)),class:"form-control",id:"basic-url","aria-describedby":"basic-addon3"},null,544),[[b,t.generateLink]]),o("div",{class:"btn btn-primary ml-4",disabled:!t.generateLink,onClick:e[10]||(e[10]=(...r)=>c.updateLinkClick&&c.updateLinkClick(...r))},"Update",8,pe)])])]),t.added?u("",!0):(i(),a("button",{key:0,type:"submit",disabled:c.isDisabled,class:"btn btn-primary mr-2"},"Create",8,he))],32)])])])])])],64)}const ve=z(I,[["render",me],["__scopeId","data-v-5d9c52e2"]]);export{ve as default};
