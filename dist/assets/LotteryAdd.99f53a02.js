import{G as k}from"./GoBackButton.8ec57f12.js";import{c as I}from"./vue-datepicker.es.17b3f44e.js";import{h as L}from"./maska.esm.cd315c5a.js";import{u as w,r as _,m as S,i as x,a as T}from"./index.esm.b21b73c4.js";import{s as U}from"./globalFunction.5ce06618.js";import{C as z,a as E,P as D}from"./ckeditor.713c8e1a.js";import{_ as V,r as A,o as i,c as a,f as C,a as s,F as h,e as p,d as b,t as u,l as q,w as g,v,n as y,a2 as $,a3 as B}from"./index.34e73fda.js";import"./_commonjsHelpers.712cc82f.js";import"./vue.runtime.esm-bundler.cd7c4a87.js";const j={setup(){return{v$:w()}},directives:{maska:L},components:{GoBackButton:k,Datepicker:I,ckeditor:z.component},data(){return{url:"https://api.pharmiq.uz/",name:"",description:"",startDate:null,endDate:null,minDate:"",limit:null,deadline:null,course_id:null,resSuccess:null,course_name:"",courseSearch:"",courses:[],editor:E,editorData_ru:"<p>lottery content ru</p>",editorData_uz:"<p>lottery content uz</p>",editorConfig:{}}},computed:{isDisabled:function(){if(this.v$.$touch(),console.log(this.v$.$touch()),this.v$.$error)return!0}},validations(){return{name:{required:_,minLengthValue:S(3)},description:{required:_,minLengthValue:S(3)},limit:{required:_,integer:x,maxLengthValue:T(5)},startDate:{required:_},deadline:{required:_},endDate:{required:_},course_id:{required:_}}},methods:{chooseCourse(o,e){this.course_id=o,this.course_name=e,this.courses=[]},searchcourse(){clearTimeout(this.timerId),this.courseSearch!=""&&this.courseSearch.length>3?this.timerId=setTimeout(()=>{this.requestApiSearch(1,this.courseSearch)},2e3):this.courses=[]},requestApiSearch(o,e=null){let c=this.url+"api/v1/course?page="+o;e&&(c=this.url+"api/v1/course?page=1&search="+e);let n=localStorage.getItem("token");const r={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n})};fetch(c,r).then(l=>(l.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),l.json())).then(l=>{this.courses=l.data,console.log(this.courses),setTimeout(()=>{this.loading=!1},1e3)})},inputgetseconds(o){if(o=="ru"){document.querySelector("#video_ru").innerHTML=this.video_ru;let c=document.querySelector("#video_ru iframe");const n=new D(c);var e=this;n.getDuration().then(function(r){e.video_ru_length=r}).catch(function(r){console.log(r)})}else{document.querySelector("#video_uz").innerHTML=this.video_uz;let c=document.querySelector("#video_uz iframe");const n=new D(c);var e=this;n.getDuration().then(function(l){e.video_uz_length=l}).catch(function(l){console.log(l)})}},uploadFilebannerRu(o){var e=o.target.files||o.dataTransfer.files;!e.length||(this.banner_ru=e[0],this.banner_ru_prev=URL.createObjectURL(e[0]))},uploadFilebannerUz(o){var e=o.target.files||o.dataTransfer.files;!e.length||(this.banner_uz=e[0],this.banner_uz_prev=URL.createObjectURL(e[0]))},async requestApi(){const o={name:this.name,description:this.description,limit:this.limit,startDate:this.startDate,endDate:this.endDate,deadline:this.deadline,course_id:this.course_id};console.log(o);const e=U(),c=Object.assign(o,e);var n=new FormData;for(const r in c)n.append(r,c[r]);try{let r=localStorage.getItem("token");const l=await fetch(this.url+"api/v1/lottery/add",{method:"POST",body:n,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+r}}),m=await l.json();window.scrollTo({top:0,behavior:"smooth"});const t=l.status;t==401?this.resStringError=m.message:(console.log(t),console.log(m.error),console.log(m.message),m.error?typeof m.message=="object"?this.resError=m.message:this.resStringError=m.message:(this.added=!0,this.resSuccess="Lottery Successfully Added"))}catch(r){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",r)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)}},created(){const o=new Date,e=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),n=String(o.getDate()).padStart(2,"0");this.minDate=`${e}-${c}-${n}`}},f=o=>($("data-v-53ee35d5"),o=o(),B(),o),F={class:"mt-3"},N={class:"row"},R={class:"col-md-12 grid-margin stretch-card"},O={class:"card"},G={class:"card-body"},M=f(()=>s("h4",{class:"card-title"},"Add Lottery",-1)),H={class:"error"},P={key:1,class:"error"},J={key:2,class:"success"},Z={class:"form-group row"},K={class:"col-md-5"},Y=f(()=>s("label",{for:"exampleInputTitleRu"},"Name",-1)),Q={class:"col-md-5"},W=f(()=>s("label",{for:"exampleInputTitleUZ"},"Description",-1)),X={class:"col-md-2"},ee=f(()=>s("label",{for:"exampleInputLimit"},"Limit",-1)),te={class:"form-group row"},re={class:"col-md-4"},se=f(()=>s("label",{for:"exampleInputStartDate"},"Start Date",-1)),oe=["min"],ne={class:"col-md-4"},ie=f(()=>s("label",{for:"exampleInputEnddate"},"End Date",-1)),ae=["min"],le={class:"col-md-4"},de=f(()=>s("label",{for:"exampleInputLimit"},"Deadline",-1)),ce=["min"],ue={class:"row"},me={class:"col-md-12"},he={class:"col-md-12"},pe={class:"col-md-12"},_e=["onClick"],ge=["disabled"];function ve(o,e,c,n,r,l){const m=A("GoBackButton");return i(),a(h,null,[C(m),s("div",F,[s("div",N,[s("div",R,[s("div",O,[s("div",G,[M,o.resError?(i(!0),a(h,{key:0},p(o.resError,(t,d)=>(i(),a("p",H,u(d)+" : "+u(t[0]),1))),256)):b("",!0),o.resStringError?(i(),a("p",P,u(o.resStringError),1)):b("",!0),r.resSuccess?(i(),a("p",J,u(r.resSuccess),1)):b("",!0),s("form",{class:"forms-sample",onSubmit:e[8]||(e[8]=q(t=>l.submitForm(),["prevent"]))},[s("div",Z,[s("div",K,[Y,g(s("input",{type:"text",class:y(["form-control",{"border border-danger":n.v$.name.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":e[0]||(e[0]=t=>r.name=t)},null,2),[[v,r.name]]),(i(!0),a(h,null,p(n.v$.name.$errors,(t,d)=>(i(),a("small",{class:"error",key:d},u(t.$message),1))),128))]),s("div",Q,[W,g(s("input",{type:"text",class:y(["form-control",{"border border-danger":n.v$.description.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":e[1]||(e[1]=t=>r.description=t)},null,2),[[v,r.description]]),(i(!0),a(h,null,p(n.v$.description.$errors,(t,d)=>(i(),a("small",{class:"error",key:d},u(t.$message),1))),128))]),s("div",X,[ee,g(s("input",{type:"text",class:y(["form-control",{"border border-danger":n.v$.limit.$errors.length>0}]),id:"exampleInputLimit","onUpdate:modelValue":e[2]||(e[2]=t=>r.limit=t)},null,2),[[v,r.limit]]),(i(!0),a(h,null,p(n.v$.limit.$errors,(t,d)=>(i(),a("small",{class:"error",key:d},u(t.$message),1))),128))])]),s("div",te,[s("div",re,[se,g(s("input",{type:"date",min:r.minDate,class:y(["form-control",{"border border-danger":n.v$.startDate.$errors.length>0}]),id:"exampleInputStartDate","onUpdate:modelValue":e[3]||(e[3]=t=>r.startDate=t)},null,10,oe),[[v,r.startDate]]),(i(!0),a(h,null,p(n.v$.startDate.$errors,(t,d)=>(i(),a("small",{class:"error",key:d},u(t.$message),1))),128))]),s("div",ne,[ie,g(s("input",{type:"date",min:r.minDate,class:y(["form-control",{"border border-danger":n.v$.endDate.$errors.length>0}]),id:"exampleInpuEnddate","onUpdate:modelValue":e[4]||(e[4]=t=>r.endDate=t)},null,10,ae),[[v,r.endDate]]),(i(!0),a(h,null,p(n.v$.endDate.$errors,(t,d)=>(i(),a("small",{class:"error",key:d},u(t.$message),1))),128))]),s("div",le,[de,g(s("input",{type:"date",min:r.minDate,class:y(["form-control",{"border border-danger":n.v$.deadline.$errors.length>0}]),id:"exampleInputLimit","onUpdate:modelValue":e[5]||(e[5]=t=>r.deadline=t)},null,10,ce),[[v,r.deadline]]),(i(!0),a(h,null,p(n.v$.deadline.$errors,(t,d)=>(i(),a("small",{class:"error",key:d},u(t.$message),1))),128))])]),s("div",ue,[s("div",me,[g(s("input",{type:"search",onInput:e[6]||(e[6]=(...t)=>l.searchcourse&&l.searchcourse(...t)),"onUpdate:modelValue":e[7]||(e[7]=t=>r.courseSearch=t),class:"form-control",placeholder:"Search"},null,544),[[v,r.courseSearch]])]),s("div",he,[s("b",null,u(r.course_name),1)]),s("div",pe,[(i(!0),a(h,null,p(r.courses,t=>(i(),a("div",{class:"items",onClick:d=>l.chooseCourse(t.id,JSON.parse(t.infos.courseTitleName).ru)},u(JSON.parse(t.infos.courseTitleName).ru),9,_e))),256))])]),o.added?b("",!0):(i(),a("button",{key:0,type:"submit",disabled:l.isDisabled,class:"btn btn-primary mr-2 mt-2"},"Create",8,ge))],32)])])])])])],64)}const xe=V(j,[["render",ve],["__scopeId","data-v-53ee35d5"]]);export{xe as default};
