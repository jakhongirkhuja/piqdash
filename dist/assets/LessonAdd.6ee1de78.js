import{G as I}from"./GoBackButton.8ec57f12.js";import{c as T}from"./vue-datepicker.es.17b3f44e.js";import{h as k}from"./maska.esm.cd315c5a.js";import{u as U,r as f,m as y,i as w}from"./index.esm.b21b73c4.js";import{_ as x,r as L,o as i,c as n,f as V,a as r,F as m,e as p,d as z,t as d,l as C,w as h,p as E,n as b,v as g,a2 as j,a3 as B}from"./index.34e73fda.js";import{s as D}from"./globalFunction.5ce06618.js";import{C as R,a as q,P as S}from"./ckeditor.713c8e1a.js";import"./_commonjsHelpers.712cc82f.js";import"./vue.runtime.esm-bundler.cd7c4a87.js";const A={setup(){return{v$:U()}},directives:{maska:k},components:{GoBackButton:I,Datepicker:T,ckeditor:R.component},data(){return{url:"https://api.pharmiq.uz/",banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",video_ru:"",video_uz:"",video_ru_length:0,video_uz_length:0,body_ru:"",startDate:null,endDate:null,body_uz:"",courses:[],order:1,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:null,course_id:2,editor:q,editorData:"<p>Content of the editor.</p>",video_mobi_ru:"",video_mobi_uz:"",editorConfig:{}}},computed:{isDisabled:function(){if(this.v$.$touch(),console.log(this.v$.$touch()),this.v$.$error)return!0}},validations(){return{course_id:{required:f},video_ru:{required:f},video_uz:{required:f},title_ru:{required:f,minLengthValue:y(3)},title_uz:{required:f,minLengthValue:y(3)},order:{required:f,integer:w}}},methods:{inputgetseconds(l){if(l=="ru"){document.querySelector("#video_ru").innerHTML=this.video_ru;let c=document.querySelector("#video_ru iframe");const s=new S(c);var e=this;s.getDuration().then(function(o){e.video_ru_length=o}).catch(function(o){console.log(o)})}else{document.querySelector("#video_uz").innerHTML=this.video_uz;let c=document.querySelector("#video_uz iframe");const s=new S(c);var e=this;s.getDuration().then(function(u){e.video_uz_length=u}).catch(function(u){console.log(u)})}},uploadFilebannerRu(l){var e=l.target.files||l.dataTransfer.files;!e.length||(this.banner_ru=e[0],this.banner_ru_prev=URL.createObjectURL(e[0]))},uploadFilebannerUz(l){var e=l.target.files||l.dataTransfer.files;!e.length||(this.banner_uz=e[0],this.banner_uz_prev=URL.createObjectURL(e[0]))},getCourses(l,e=null){let c=this.url+"api/v1/course?page="+l+"&show=all";e&&(c=this.url+"api/v1/course?page=1&search="+e);let s=localStorage.getItem("token");const o={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(c,o).then(u=>(u.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),u.json())).then(u=>{this.courses=u.data})},async requestApi(){const l={course_id:this.course_id,order:this.order,lessonTitleName_ru:this.title_ru,lessonTitleName_uz:this.title_uz,video_ru:this.video_ru,video_uz:this.video_uz,videoLength_ru:this.video_ru_length,videoLength_uz:this.video_uz_length,videoLocId_uz:this.video_mobi_uz,videoLocId_ru:this.video_mobi_ru},e=D(),c=Object.assign(l,e);var s=new FormData;for(const o in c)s.append(o,c[o]);try{let o=localStorage.getItem("token");const u=await fetch(this.url+"api/v1/lessons/add",{method:"POST",body:s,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+o}}),v=await u.json();window.scrollTo({top:0,behavior:"smooth"}),u.status==401?this.resStringError=v.message:v.error?typeof v.message=="object"?this.resError=v.message:this.resStringError=v.message:(this.added=!0,this.resSuccess="Lesson Successfully Added")}catch(o){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",o)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)},getcourses(){let l=this.url+"api/v1/course/course?page=1",e=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(l,c).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{this.courses=s.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getCourses()}},_=l=>(j("data-v-799d6952"),l=l(),B(),l),Z={class:"mt-3"},N={class:"row"},O={class:"col-md-12 grid-margin stretch-card"},F={class:"card"},M={class:"card-body"},G=_(()=>r("h4",{class:"card-title"},"Add Lessson",-1)),$={class:"error"},H={key:1,class:"error"},P={key:2,class:"success"},J={class:"form-group row"},K={class:"col-md-10"},Q=_(()=>r("label",{for:"banner"},"Courses",-1)),W=_(()=>r("option",{disabled:"",value:"0"},"Please select one",-1)),X=["value"],Y={class:"col-md-2"},ee=_(()=>r("label",{for:"banner"},"Order",-1)),oe={class:"form-group row"},te={class:"col-md-6"},re=_(()=>r("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),se={class:"col-md-6"},ie=_(()=>r("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),ne={class:"form-group row"},le={class:"col-md-6"},ue={for:"exampleInputTitleRu"},de={class:"col-md-6"},ae={for:"exampleInputTitleUZ"},ce={class:"col-md-6"},_e=_(()=>r("label",{for:"exampleInputTitleUZ"},"Video Mobi (UZ) ",-1)),me={class:"col-md-6"},pe=_(()=>r("label",{for:"exampleInputTitleUZ"},"Video Mobi (RU) ",-1)),he=["disabled"],ve=_(()=>r("div",{id:"video_ru",style:{display:"none"}},null,-1)),ge=_(()=>r("div",{id:"video_uz",style:{display:"none"}},null,-1));function fe(l,e,c,s,o,u){const v=L("GoBackButton");return i(),n(m,null,[V(v),r("div",Z,[r("div",N,[r("div",O,[r("div",F,[r("div",M,[G,o.resError?(i(!0),n(m,{key:0},p(o.resError,(t,a)=>(i(),n("p",$,d(a)+" : "+d(t[0]),1))),256)):z("",!0),o.resStringError?(i(),n("p",H,d(o.resStringError),1)):z("",!0),o.resSuccess?(i(),n("p",P,d(o.resSuccess),1)):z("",!0),r("form",{class:"forms-sample",onSubmit:e[10]||(e[10]=C(t=>u.submitForm(),["prevent"]))},[r("div",J,[r("div",K,[Q,h(r("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.course_id=t),class:b(["form-control",{"border border-danger":s.v$.course_id.$errors.length>0}])},[W,(i(!0),n(m,null,p(o.courses,t=>(i(),n("option",{key:t.id,value:t.id},d(JSON.parse(t.infos.courseTitleName).ru)+" ( "+d(JSON.parse(t.infos.courseTitleName).uz)+" )",9,X))),128))],2),[[E,o.course_id]]),(i(!0),n(m,null,p(s.v$.course_id.$errors,(t,a)=>(i(),n("small",{class:"error",key:a},d(t.$message),1))),128))]),r("div",Y,[ee,h(r("input",{type:"number",class:b(["form-control",{"border border-danger":s.v$.order.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":e[1]||(e[1]=t=>o.order=t)},null,2),[[g,o.order]]),(i(!0),n(m,null,p(s.v$.order.$errors,(t,a)=>(i(),n("small",{class:"error",key:a},d(t.$message),1))),128))])]),r("div",oe,[r("div",te,[re,h(r("input",{type:"text",class:b(["form-control",{"border border-danger":s.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":e[2]||(e[2]=t=>o.title_ru=t)},null,2),[[g,o.title_ru]]),(i(!0),n(m,null,p(s.v$.title_ru.$errors,(t,a)=>(i(),n("small",{class:"error",key:a},d(t.$message),1))),128))]),r("div",se,[ie,h(r("input",{type:"text",class:b(["form-control",{"border border-danger":s.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":e[3]||(e[3]=t=>o.title_uz=t)},null,2),[[g,o.title_uz]]),(i(!0),n(m,null,p(s.v$.title_uz.$errors,(t,a)=>(i(),n("small",{class:"error",key:a},d(t.$message),1))),128))])]),r("div",ne,[r("div",le,[r("label",ue,"Video (\u0420\u0423) - "+d(o.video_ru_length)+" seconds",1),h(r("input",{type:"text",class:b(["form-control",{"border border-danger":s.v$.video_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":e[4]||(e[4]=t=>o.video_ru=t),onInput:e[5]||(e[5]=t=>u.inputgetseconds("ru"))},null,34),[[g,o.video_ru]]),(i(!0),n(m,null,p(s.v$.video_ru.$errors,(t,a)=>(i(),n("small",{class:"error",key:a},d(t.$message),1))),128))]),r("div",de,[r("label",ae,"Video (UZ) - "+d(o.video_uz_length)+" seconds ",1),h(r("input",{type:"text",class:b(["form-control",{"border border-danger":s.v$.video_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":e[6]||(e[6]=t=>o.video_uz=t),onInput:e[7]||(e[7]=t=>u.inputgetseconds("uz"))},null,34),[[g,o.video_uz]]),(i(!0),n(m,null,p(s.v$.video_uz.$errors,(t,a)=>(i(),n("small",{class:"error",key:a},d(t.$message),1))),128))]),r("div",ce,[_e,h(r("input",{type:"text",class:"form-control",id:"exampleInputTitleUZ","onUpdate:modelValue":e[8]||(e[8]=t=>o.video_mobi_uz=t)},null,512),[[g,o.video_mobi_uz]])]),r("div",me,[pe,h(r("input",{type:"text",class:"form-control",id:"exampleInputTitleUZ","onUpdate:modelValue":e[9]||(e[9]=t=>o.video_mobi_ru=t)},null,512),[[g,o.video_mobi_ru]])])]),o.added?z("",!0):(i(),n("button",{key:0,type:"submit",disabled:u.isDisabled,class:"btn btn-primary mr-2"},"Create",8,he))],32)])])]),ve,ge])])],64)}const xe=x(A,[["render",fe],["__scopeId","data-v-799d6952"]]);export{xe as default};
