import{G as v}from"./GoBackButton.8ec57f12.js";import{c as S}from"./vue-datepicker.es.17b3f44e.js";import{h as z}from"./maska.esm.cd315c5a.js";import{u as w,r as f,m as E}from"./index.esm.b21b73c4.js";import{_ as G,r as L,o as a,c as l,f as x,a as s,F as _,e as g,d as m,t as c,l as I,w as b,v as k,n as y,p as T,g as j,a2 as C,a3 as U}from"./index.34e73fda.js";import{s as D}from"./globalFunction.5ce06618.js";const B={setup(){return{v$:w()}},directives:{maska:z},components:{GoBackButton:v,Datepicker:S},data(){return{url:"https://api.pharmiq.uz/",hideGroups:!1,group_id:null,groups:[],generateLink:null,newspage:"",banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",resGenerateError:null,body_ru:"",startDate:null,endDate:null,body_uz:"",categories:[],generateLinkCopy:null,promocode_id:null,promocodes:[],phonebook_id:null,phonebooks:[],added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,resGenerateErrorGenerate:null,generateLinkClickName:"Generate",price:0,bitlink_id:null,category_id:1,sendby:"SMS to phone Number",long_url:"https://go.pharmiq.uz/login"}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{phonebook_id:{required:f},startDate:{required:f},body_uz:{required:f,minLengthValue:E(10)}}},methods:{getvalues(){this.generateLinkCopy="https://bit.ly/"+this.generateLink},async updateLinkClick(){const n={custom_bitlink:"bit.ly/"+this.generateLink,bitlink_id:this.bitlink_id};try{const t=await fetch("https://api-ssl.bitly.com/v4/custom_bitlinks",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer c901f75cdbf7109305be80438d5cfc005d12925b"}}),i=await t.json(),e=t.status;e==200||e==201?(this.generateLinkCopy="https://"+i.custom_bitlink,this.generateLink=i.custom_bitlink.split("/").at(-1)):this.resGenerateErrorGenerate=i.description}catch(t){this.resGenerateErrorGenerate=t}},async generateLinkClick(){var n=new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?([^ ])+");if(this.long_url.match(n)){const t={long_url:this.long_url};try{const i=await fetch("https://api-ssl.bitly.com/v4/shorten",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer c901f75cdbf7109305be80438d5cfc005d12925b"}}),e=await i.json(),o=i.status;o==200||o==201?(this.generateLinkCopy=e.link,this.bitlink_id=e.id,this.generateLink=e.link.split("/").at(-1)):this.resGenerateErrorGenerate=e.description}catch(i){this.resGenerateErrorGenerate=i}}},getGroups(){let n=this.url+"api/v1/groups?page=1",t=localStorage.getItem("token");const i={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(n,i).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{this.groups=e.data,this.groups.length>0&&(this.group_id=this.groups[0].id)})},uploadFilebannerRu(n){var t=n.target.files||n.dataTransfer.files;!t.length||(this.banner_ru=t[0],this.banner_ru_prev=URL.createObjectURL(t[0]))},uploadFilebannerUz(n){var t=n.target.files||n.dataTransfer.files;!t.length||(this.banner_uz=t[0],this.banner_uz_prev=URL.createObjectURL(t[0]))},async requestApi(){const n={titleName_ru:"sending sms ru",titleName_uz:"sending sms uz",descriptionText_ru:"sending boy ru",descriptionText_uz:this.body_uz,sentBy:this.sendby,newsPage:this.newspage,promocode_id:"",phonebook_id:this.phonebook_id,startDate:this.startDate.replace("T"," ")+":00",endDate:"2070-12-01 17:05:00"},t=D(),i=Object.assign(n,t);var e=new FormData;for(const o in i)e.append(o,i[o]);try{let o=localStorage.getItem("token");const d=await fetch(this.url+"api/v1/inbox/edit/"+this.$route.params.id,{method:"POST",body:e,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+o}}),p=await d.json();window.scrollTo({top:0,behavior:"smooth"}),d.status==401?this.resStringError=p.message:p.error?typeof p.message=="object"?this.resError=p.message:this.resStringError=p.message:this.resSuccess="Sms Successfully Updated"}catch(o){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",o)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)},getPromocode(){let n=this.url+"api/v1/promocode?page=1",t=localStorage.getItem("token");const i={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(n,i).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{this.promocodes=e.data})},getInbox(){let n=this.url+"api/v1/inbox?inbox_id="+this.$route.params.id,t=localStorage.getItem("token");const i={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(n,i).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{e&&(this.title_ru=JSON.parse(e.titleName).ru,this.title_uz=JSON.parse(e.titleName).uz,this.body_ru=JSON.parse(e.descriptionText).ru,this.body_uz=JSON.parse(e.descriptionText).uz,this.sendby=e.sentBy,this.promocode_id=e.promocode_id,this.newsPage=e.newsPage,this.phonebook_id=e.phonebook_id,this.startDate=e.startDate.replace(" ","T").slice(0,-3),this.endDate=e.endDate.replace(" ","T").slice(0,-3),this.banner_ru_prev=this.url+"files/inboxMessage/"+e.messageIcon)})},getPhonebooks(){let n=this.url+"api/v1/groups?page=1",t=localStorage.getItem("token");const i={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(n,i).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{this.phonebooks=e.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getInbox(),this.getPhonebooks()}},u=n=>(C("data-v-278d093a"),n=n(),U(),n),N={class:"mt-3"},A={class:"row"},O={class:"col-md-12 grid-margin stretch-card"},V={class:"card"},q={class:"card-body"},P=u(()=>s("h4",{class:"card-title"},"Update Message ",-1)),R={class:"error"},F={key:1,class:"error"},J={key:2,class:"success"},Z={class:"form-group row"},M={class:"col-md-12"},H=u(()=>s("label",{for:"exampleInputbodyUZ"},"Body",-1)),K={class:"form-group row"},Q={class:"col-md-6"},W=u(()=>s("label",{for:"exampleInputstartRu"},"Start Date",-1)),X={class:"col-md-6"},Y=u(()=>s("label",{class:"col-sm-12",for:"banner"},"Group",-1)),$=u(()=>s("option",{disabled:""},"Please select one",-1)),ee=["value"],te={class:"form-group row"},oe={class:"col-md-6"},se=u(()=>s("label",{for:""},"Url",-1)),re={class:"input-group"},ne={key:0,class:"resError"},ie={class:"col-md-6"},ae=u(()=>s("label",{for:""},"Generated link",-1)),le=j(),ce={key:0,style:{display:"inline-block","background-color":"#9a9797",padding:"2px 10px","border-radius":"6px",color:"white"}},de={key:1,class:"resError"},ue={class:"input-group mb-3"},pe=u(()=>s("div",{class:"input-group-prepend"},[s("span",{class:"input-group-text",style:{color:"initial"},id:"basic-addon3"},"https://bit.ly/")],-1)),he=["disabled"],me=["disabled"];function _e(n,t,i,e,o,d){const p=L("GoBackButton");return a(),l(_,null,[x(p),s("div",N,[s("div",A,[s("div",O,[s("div",V,[s("div",q,[P,o.resError?(a(!0),l(_,{key:0},g(o.resError,(r,h)=>(a(),l("p",R,c(h)+" : "+c(r[0]),1))),256)):m("",!0),o.resStringError?(a(),l("p",F,c(o.resStringError),1)):m("",!0),o.resSuccess?(a(),l("p",J,c(o.resSuccess),1)):m("",!0),s("form",{class:"forms-sample",onSubmit:t[8]||(t[8]=I(r=>d.submitForm(),["prevent"]))},[s("div",Z,[s("div",M,[H,b(s("textarea",{rows:"10",type:"text",class:y(["form-control",{"border border-danger":e.v$.body_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":t[0]||(t[0]=r=>o.body_uz=r)},null,2),[[k,o.body_uz]]),(a(!0),l(_,null,g(e.v$.body_uz.$errors,(r,h)=>(a(),l("small",{class:"error",key:h},c(r.$message),1))),128))])]),s("div",K,[s("div",Q,[W,b(s("input",{type:"datetime-local",class:y(["form-control",{"border border-danger":e.v$.startDate.$errors.length>0}]),id:"exampleInputstartRu","onUpdate:modelValue":t[1]||(t[1]=r=>o.startDate=r)},null,2),[[k,o.startDate]]),(a(!0),l(_,null,g(e.v$.startDate.$errors,(r,h)=>(a(),l("small",{class:"error",key:h},c(r.$message),1))),128))]),s("div",X,[Y,b(s("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.phonebook_id=r),class:y(["form-control",{"border border-danger":e.v$.phonebook_id.$errors.length>0}])},[$,(a(!0),l(_,null,g(o.phonebooks,r=>(a(),l("option",{key:r.id,value:r.id},c(r.groupName),9,ee))),128))],2),[[T,o.phonebook_id]]),(a(!0),l(_,null,g(e.v$.phonebook_id.$errors,(r,h)=>(a(),l("small",{class:"error",key:h},c(r.$message),1))),128))])]),s("div",te,[s("div",oe,[se,s("div",re,[o.resGenerateErrorGenerate?(a(),l("div",ne,c(o.resGenerateErrorGenerate),1)):m("",!0),b(s("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=r=>o.long_url=r)},null,512),[[k,o.long_url]]),s("div",{class:"btn btn-primary ml-4",onClick:t[4]||(t[4]=(...r)=>d.generateLinkClick&&d.generateLinkClick(...r))},c(o.generateLinkClickName),1)])]),s("div",ie,[ae,le,o.generateLinkCopy?(a(),l("span",ce,c(o.generateLinkCopy),1)):m("",!0),o.resGenerateError?(a(),l("div",de,c(o.resGenerateError),1)):m("",!0),s("div",ue,[pe,b(s("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=r=>o.generateLink=r),onInput:t[6]||(t[6]=(...r)=>d.getvalues&&d.getvalues(...r)),class:"form-control",id:"basic-url","aria-describedby":"basic-addon3"},null,544),[[k,o.generateLink]]),s("div",{class:"btn btn-primary ml-4",disabled:!o.generateLink,onClick:t[7]||(t[7]=(...r)=>d.updateLinkClick&&d.updateLinkClick(...r))},"Update",8,he)])])]),o.added?m("",!0):(a(),l("button",{key:0,type:"submit",disabled:d.isDisabled,class:"btn btn-primary mr-2"},"Update",8,me))],32)])])])])])],64)}const Se=G(B,[["render",_e],["__scopeId","data-v-278d093a"]]);export{Se as default};
