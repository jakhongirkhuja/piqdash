import{G as C}from"./GoBackButton.8ec57f12.js";import{c as k}from"./vue-datepicker.es.17b3f44e.js";import{h as I}from"./maska.esm.cd315c5a.js";import{u as w,r as y,m as v}from"./index.esm.b21b73c4.js";import{_ as z,r as T,o as n,c as i,f as E,a as e,F as h,e as g,d as _,t as d,l as B,w as f,p as x,v as b,n as S,a2 as N,a3 as U}from"./index.34e73fda.js";import{s as j}from"./globalFunction.5ce06618.js";const R={setup(){return{v$:w()}},directives:{maska:I},components:{GoBackButton:C,Datepicker:k},data(){return{url:"https://api.pharmiq.uz/",name_ru:"",name_uz:"",banner_ru:[],storeCategoryTypeChoose:1,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,storeChoose:null,store:[]}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{name_ru:{required:y,minLengthValue:v(3)},name_uz:{required:y,minLengthValue:v(3)}}},methods:{async requestApi(){this.added=!0;const a={name_ru:this.name_ru,name_uz:this.name_uz,global_type:this.storeCategoryTypeChoose},r=j(),m=Object.assign(a,r);var s=new FormData;this.banner_ru.length!=0&&s.append("icon",this.banner_ru);for(const t in m)s.append(t,m[t]);try{let t=localStorage.getItem("token");const u=await fetch(this.url+"api/v1/store/category/edit/"+this.$route.params.id,{method:"POST",body:s,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+t}}),l=await u.json();window.scrollTo({top:0,behavior:"smooth"}),u.status==401?(this.resStringError=l.message,this.added=!1):l.error?(typeof l.message=="object"?this.resError=l.message:this.resStringError=l.message,this.added=!1):this.resSuccess="Store Category Successfully Updated"}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},uploadFilebannerRu(a){var r=a.target.files||a.dataTransfer.files;if(!r.length){this.banner_ru=[],this.banner_ru_prev="";return}this.banner_ru=r[0],this.banner_ru_prev=URL.createObjectURL(r[0])},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},getStore(){let a=this.url+"api/v1/store/category?category_id="+this.$route.params.id,r=localStorage.getItem("token");const m={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r})};fetch(a,m).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{s&&(this.name_ru=JSON.parse(s.name).ru,this.name_uz=JSON.parse(s.name).uz,this.storeCategoryTypeChoose=s.global_type==!0?1:0,this.banner_ru_prev=this.url+"files/storeCategory/"+s.icon)})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getStore()}},c=a=>(N("data-v-06ae10ba"),a=a(),U(),a),V={class:"mt-3"},D={class:"row"},F={class:"col-md-12 grid-margin stretch-card"},L={class:"card"},q={class:"card-body"},A=c(()=>e("h4",{class:"card-title"},"Update Category",-1)),G={class:"error"},O={key:1,class:"error"},$={key:2,class:"success"},J={class:"form-group row"},M={class:"col-md-12"},P=c(()=>e("label",{for:"exampleInputTypee"},"Global type",-1)),H=c(()=>e("option",{value:"0"},"Digital",-1)),K=c(()=>e("option",{value:"1"},"Physical",-1)),Q=[H,K],W={class:"form-group row"},X={class:"col-md-6"},Y=c(()=>e("label",{for:"exampleInputTitleRu"},"Name ru",-1)),Z={class:"col-md-6"},ee=c(()=>e("label",{for:"exampleInputTitleRu"},"Name uz",-1)),te={class:"col-md-12"},re=c(()=>e("label",{class:"col-sm-4",for:"banner"},"Image",-1)),se=["src"],oe=["disabled"];function ae(a,r,m,s,t,u){const l=T("GoBackButton");return n(),i(h,null,[E(l),e("div",V,[e("div",D,[e("div",F,[e("div",L,[e("div",q,[A,t.resError?(n(!0),i(h,{key:0},g(t.resError,(o,p)=>(n(),i("p",G,d(p)+" : "+d(o[0]),1))),256)):_("",!0),t.resStringError?(n(),i("p",O,d(t.resStringError),1)):_("",!0),t.resSuccess?(n(),i("p",$,d(t.resSuccess),1)):_("",!0),e("form",{class:"forms-sample",onSubmit:r[4]||(r[4]=B(o=>u.submitForm(),["prevent"]))},[e("div",J,[e("div",M,[P,f(e("select",{"onUpdate:modelValue":r[0]||(r[0]=o=>t.storeCategoryTypeChoose=o),class:"form-control"},Q,512),[[x,t.storeCategoryTypeChoose]])])]),e("div",W,[e("div",X,[Y,f(e("input",{type:"text",class:S(["form-control",{"border border-danger":s.v$.name_ru.$errors.length>0}]),placeholder:"Category Name",id:"exampleInputTitleRu","onUpdate:modelValue":r[1]||(r[1]=o=>t.name_ru=o)},null,2),[[b,t.name_ru]]),(n(!0),i(h,null,g(s.v$.name_ru.$errors,(o,p)=>(n(),i("small",{class:"error",key:p},d(o.$message),1))),128))]),e("div",Z,[ee,f(e("input",{type:"text",class:S(["form-control",{"border border-danger":s.v$.name_uz.$errors.length>0}]),placeholder:"Category Name",id:"exampleInputTitleRu","onUpdate:modelValue":r[2]||(r[2]=o=>t.name_uz=o)},null,2),[[b,t.name_uz]]),(n(!0),i(h,null,g(s.v$.name_uz.$errors,(o,p)=>(n(),i("small",{class:"error",key:p},d(o.$message),1))),128))]),e("div",te,[re,a.banner_ru_prev?(n(),i("img",{key:0,src:a.banner_ru_prev,class:"image_prev"},null,8,se)):_("",!0),e("input",{type:"file",id:"banner",onChange:r[3]||(r[3]=o=>u.uploadFilebannerRu(o)),accept:"image/*",class:"form-control"},null,32)])]),t.added?_("",!0):(n(),i("button",{key:0,type:"submit",disabled:u.isDisabled,class:"btn btn-primary mr-2"},"Update",8,oe))],32)])])])])])],64)}const me=z(R,[["render",ae],["__scopeId","data-v-06ae10ba"]]);export{me as default};
