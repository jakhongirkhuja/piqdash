import{C as I,P as y}from"./Pagination.b8ff8fbc.js";import{L as v}from"./LanguageSwitcher.c9c9f8e9.js";import{s as S}from"./globalFunction.5ce06618.js";import{_ as C,r as _,o as r,c as i,a as e,b as g,d as c,t as d,F as m,e as b,g as w,a2 as B,a3 as A,h as P}from"./index.34e73fda.js";const U={data(){return{imageUrl:"https://api.pharmiq.uz/files/store/",disabled:!1,modelName:"",modelUserId:"",currentPage:1,last_page:1,total:1,per_page:1,markets:[],response:null,resError:!1,resSuccess:!1,resStringError:"",submitButton:!0,marketsearch:"",timerId:null,url:"https://api.pharmiq.uz/",notUsedBarCode:0,loading:!0,userInfo:null}},components:{CrudButton:I,Pagination:y,LanguageSwitcher:v},computed:{},methods:{showImageUrl(s){return this.imageUrl+s},searchstore(){clearTimeout(this.timerId),this.marketsearch!=""?(this.loading=!0,this.timerId=setTimeout(()=>{this.requestApi(1,this.marketsearch)},2e3)):(this.loading=!0,this.timerId=setTimeout(()=>this.requestApi(this.currentPage),2e3))},showstore(s){this.$router.push({name:"physicalStore.show",params:{id:s}})},openmodel(s,l){this.modelUserId=s,this.modelName=l,this.submitButton=!0,this.resError=!1,this.resSuccess=!1,this.resStringError="",$("#exampleModal").modal("show")},showUrl(){console.log("https://api.pharmiq.uz/")},editstore(s){this.$router.push({name:"korzinka.edit",params:{id:s}})},onPageChange(s){console.log(s),this.currentPage=s,this.loading=!0,this.requestApi(s),localStorage.setItem("currentPageP",s)},refreshList(){this.loading=!0,this.requestApi(1)},async requestApiDelete(){this.disabled=!0;const s={usid:this.modelUserId},l=S(),h=Object.assign(s,l);try{let a=localStorage.getItem("token");const o=await(await fetch(this.url+"api/v1/store/korzinkabarcode/delete/"+this.modelUserId,{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer "+a}})).json();o.error?typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message:(this.resSuccess="Successfully Deleted",this.requestApi(1),this.submitButton=!1)}catch(a){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",a)}},requestApi(s,l=null){let h=this.url+"api/v1/store/korzinkabarcode?page="+s,a=localStorage.getItem("token");const t={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a})};fetch(h,t).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.response=o,this.last_page=o.last_page,this.total=o.total,this.per_page=o.per_page,this.markets=o.data,console.log(o.data),window.scrollTo({top:0,behavior:"smooth"}),this.disabled=!1,setTimeout(()=>{this.loading=!1},1e3)})},requestApiEmptyBarCode(){let s=this.url+"api/v1/store/korzinkabarcode/notUsed",l=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+l})};fetch(s,h).then(a=>(a.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),a.json())).then(a=>{this.notUsedBarCode=a.notUsedBarCode})}},mounted(){this.$i18n.locale="ru"},created(){this.userInfo=JSON.parse(localStorage.getItem("user"));const s=localStorage.getItem("currentPageP");s&&(this.currentPage=parseInt(s)),this.requestApi(1),this.requestApiEmptyBarCode()}},u=s=>(B("data-v-3abc896d"),s=s(),A(),s),q={class:"row"},E={class:"col-md-3"},x=u(()=>e("div",{class:"col-md-6"},null,-1)),z={class:"col-md-3 text-right"},j={style:{"padding-top":"5px","text-decoration":"underline"}},T=w("Not Used: "),N={class:"mt-3"},L={class:"row"},D={class:"col-12"},O={class:"table-responsive"},M={class:"table"},F=u(()=>e("thead",{class:"thead-dark"},[e("tr",null,[e("th",{scope:"col"},"Barcode"),e("th",{scope:"col"},"Face value"),e("th",{scope:"col"},"Actions")])],-1)),V={class:"actions"},G=["onClick"],H=u(()=>e("i",{class:"ti ti-pencil-alt","data-toggle":"tooltip",title:"Edit"},null,-1)),J=[H],K=["onClick"],R=u(()=>e("i",{class:"ti ti-trash","data-toggle":"tooltip",title:"Edit"},null,-1)),Q=[R],W={class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},X={class:"modal-dialog",role:"document"},Y={class:"modal-content"},Z=u(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Delete Barcode"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"\xD7")])],-1)),ee={class:"modal-body text-center"},te={class:"error"},se={key:1,class:"error"},oe={key:2,class:"success"},re=u(()=>e("h4",null,"Are you sure you want to delete this Barcode?",-1)),ae={class:"modal-footer"},ie=u(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Close",-1)),ne=["disabled"],le={key:0,class:"loading"},ce=u(()=>e("img",{src:P},null,-1)),de=[ce];function ue(s,l,h,a,t,o){const f=_("CrudButton"),k=_("Pagination");return r(),i(m,null,[e("div",q,[e("div",E,[t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(r(),g(f,{key:0,urlName:"korzinka.add",btnName:"Add BarCode"})):c("",!0)]),x,e("div",z,[e("span",j,[T,e("b",null,d(t.notUsedBarCode),1)])])]),e("div",N,[e("div",L,[e("div",D,[e("div",O,[e("table",M,[F,e("tbody",null,[(r(!0),i(m,null,b(t.markets,n=>(r(),i("tr",{key:n.id},[e("td",null,d(n.barcode),1),e("td",null,d(n.facevalue.toLocaleString("ru-RU")),1),e("td",V,[t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(r(),i("div",{key:0,onClick:p=>o.editstore(n.id),class:"edit mr-2 cursor-pointer"},J,8,G)):c("",!0),t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(r(),i("div",{key:1,"data-toggle":"modal","data-target":"#exampleModal cursor-pointer",onClick:p=>o.openmodel(n.id,n.barcode),class:"delete text-danger"},Q,8,K)):c("",!0)])]))),128))])])]),t.last_page!=1?(r(),g(k,{key:0,"total-pages":this.last_page,total:this.total,"per-page":this.per_page,"current-page":t.currentPage,onPagechanged:o.onPageChange},null,8,["total-pages","total","per-page","current-page","onPagechanged"])):c("",!0)])])]),e("div",W,[e("div",X,[e("div",Y,[Z,e("div",ee,[t.resError?(r(!0),i(m,{key:0},b(t.resError,(n,p)=>(r(),i("p",te,d(p)+" : "+d(n[0]),1))),256)):c("",!0),t.resStringError?(r(),i("p",se,d(t.resStringError),1)):c("",!0),t.resSuccess?(r(),i("p",oe,d(t.resSuccess),1)):c("",!0),re,e("h4",null,d(t.modelName),1),e("p",null,"barcodeId: "+d(t.modelUserId),1)]),e("div",ae,[ie,t.submitButton?(r(),i("button",{key:0,disabled:t.disabled,type:"button",onClick:l[0]||(l[0]=(...n)=>o.requestApiDelete&&o.requestApiDelete(...n)),class:"btn btn-primary"},"Delete store",8,ne)):c("",!0)])])])]),t.loading?(r(),i("div",le,de)):c("",!0)],64)}const ge=C(U,[["render",ue],["__scopeId","data-v-3abc896d"]]);export{ge as default};
