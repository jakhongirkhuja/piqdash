import{G as x}from"./GoBackButton.8ec57f12.js";import{c as S}from"./vue-datepicker.es.17b3f44e.js";import{h as w}from"./maska.esm.cd315c5a.js";import{u as C,r as y,b as z,c as V,d as D,m as k,i as T}from"./index.esm.b21b73c4.js";import{_ as B,r as R,o as n,c as l,f as G,a as r,F as c,e as p,d as f,t as d,l as j,w as m,p as I,n as h,v as b,a0 as U,a2 as q,a3 as E}from"./index.34e73fda.js";import{s as Z}from"./globalFunction.5ce06618.js";const A={setup(){return{v$:C()}},directives:{maska:w},components:{GoBackButton:x,Datepicker:S},data(){return{url:"https://api.pharmiq.uz/",hideGroups:!1,group_id:null,groups:[],banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",body_ru:"",startDate:null,endDate:null,body_uz:"",categories:[],added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:0,category_id:1,pin:0,order:0}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{category_id:{required:y},startDate:{required:y},order:{required:z(()=>this.pin==!0),maxValue:V(10),minValue:D(0)},title_ru:{required:y,minLengthValue:k(3)},title_uz:{required:y,minLengthValue:k(3)},body_ru:{required:y,minLengthValue:k(10)},body_uz:{required:y,minLengthValue:k(10)},banner_ru:{required:z(()=>this.banner_ru.length==0)},price:{required:z(()=>this.monetized==1),integer:T},group_id:{required:z(()=>this.category_id=="special")},banner_uz:{required:z(()=>this.banner_uz.length==0)}}},methods:{checkCategory(u){this.hideGroups=!1;let t=this.categories.find(g=>g.id==u.target.value);(t&&t.access==!0||this.category_id=="special")&&(this.getGroups(),this.hideGroups=!0)},getGroups(){let u=this.url+"api/v1/groups?page=1&show=all",t=localStorage.getItem("token");const g={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(u,g).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.groups=o.data,this.groups.length>0&&(this.group_id=this.groups[0].id)})},uploadFilebannerRu(u){var t=u.target.files||u.dataTransfer.files;!t.length||(this.banner_ru=t[0],this.banner_ru_prev=URL.createObjectURL(t[0]))},uploadFilebannerUz(u){var t=u.target.files||u.dataTransfer.files;!t.length||(this.banner_uz=t[0],this.banner_uz_prev=URL.createObjectURL(t[0]))},async requestApi(){const u={courseTitleName_ru:this.title_ru,courseTitleName_uz:this.title_uz,courseInfo_ru:this.body_ru,courseInfo_uz:this.body_uz,courseMonetized:this.monetized?1:0,coursePrice:this.price,category_id:this.category_id,startDate:this.startDate,endDate:this.endDate,pin:this.pin,order:this.order},t=Z(),g=Object.assign(u,t);var o=new FormData;o.append("courseBanner_ru",this.banner_ru),o.append("courseBanner_uz",this.banner_uz);for(const s in g)o.append(s,g[s]);this.group_id&&o.append("courseForGroup",this.group_id);try{let s=localStorage.getItem("token");const _=await fetch(this.url+"api/v1/course/submit/add",{method:"POST",body:o,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+s}}),v=await _.json();window.scrollTo({top:0,behavior:"smooth"}),_.status==401?this.resStringError=v.message:v.error?typeof v.message=="object"?this.resError=v.message:this.resStringError=v.message:this.resSuccess="Course Successfully Added"}catch(s){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",s)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.pin)},getvaluePin(){console.log(this.pin)},getCategories(){let u=this.url+"api/v1/course/category?page=1",t=localStorage.getItem("token");const g={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(u,g).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.categories=o.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getCategories()}},a=u=>(q("data-v-23519021"),u=u(),E(),u),L={class:"mt-3"},N={class:"row"},F={class:"col-md-12 grid-margin stretch-card"},P={class:"card"},O={class:"card-body"},M=a(()=>r("h4",{class:"card-title"},"Add Course",-1)),H={class:"error"},J={key:1,class:"error"},Y={key:2,class:"success"},K={class:"form-group row"},Q={class:"col-md-12"},W=a(()=>r("label",{class:"col-sm-3",for:"banner"},"Category",-1)),X=a(()=>r("option",{disabled:"",value:"0"},"Please select one",-1)),$=a(()=>r("option",{value:"special"},"Special",-1)),ee=["value"],re={key:0,class:"col-md-12"},te=a(()=>r("label",{class:"col-sm-3",for:"banner"},"Group",-1)),se=["value"],oe={class:"form-group row"},ne={class:"col-md-6"},le=a(()=>r("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),ae={class:"col-md-6"},ie=a(()=>r("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),ue={class:"form-group row"},de={class:"col-md-6"},ce=a(()=>r("label",{for:"exampleInputbodyRu"},"Body (\u0420\u0423)",-1)),pe={class:"col-md-6"},_e=a(()=>r("label",{for:"exampleInputbodyUZ"},"Body (UZ)",-1)),me={class:"form-group row"},he={class:"col-md-6"},ge=a(()=>r("label",{class:"col-sm-3 col-form-label",for:"banner"},"banner (\u0420\u0423)",-1)),be=["src"],ve={class:"col-md-6"},fe=a(()=>r("label",{class:"col-sm-3 col-form-label",for:"banner"},"banner (UZ)",-1)),ye=["src"],ze={class:"form-group row"},ke={class:"col-md-6"},Ie=a(()=>r("label",{for:"exampleInputstartRu"},"Start Date",-1)),Ue={class:"col-md-6"},xe=a(()=>r("label",{for:"exampleInputendUZ"},"End Date ",-1)),Se={class:"form-group row"},we={class:"col-md-2"},Ce=a(()=>r("label",{for:"exampleInputstartRu"},"Course Monetized",-1)),Ve=a(()=>r("br",null,null,-1)),De={class:"language-switcher"},Te=a(()=>r("span",{class:"slider round"},null,-1)),Be=a(()=>r("span",{class:"select-ru"},"No",-1)),Re=a(()=>r("span",{class:"select-uz"},"Yes",-1)),Ge={class:"col-md-4"},je=a(()=>r("label",{for:"exampleInputendUZ"},"Course Price ",-1)),qe={class:"col-md-2"},Ee=a(()=>r("label",{for:"exampleInputstartRu"},"Course Pin",-1)),Ze=a(()=>r("br",null,null,-1)),Ae={class:"language-switcher"},Le=a(()=>r("span",{class:"slider round"},null,-1)),Ne=a(()=>r("span",{class:"select-ru"},"No",-1)),Fe=a(()=>r("span",{class:"select-uz"},"Yes",-1)),Pe={class:"col-md-4"},Oe=a(()=>r("label",{for:"exampleInpOutendUZ"},"Course Order ( 0 = adding to last item ) ",-1)),Me=["disabled"];function He(u,t,g,o,s,_){const v=R("GoBackButton");return n(),l(c,null,[G(v),r("div",L,[r("div",N,[r("div",F,[r("div",P,[r("div",O,[M,s.resError?(n(!0),l(c,{key:0},p(s.resError,(e,i)=>(n(),l("p",H,d(i)+" : "+d(e[0]),1))),256)):f("",!0),s.resStringError?(n(),l("p",J,d(s.resStringError),1)):f("",!0),s.resSuccess?(n(),l("p",Y,d(s.resSuccess),1)):f("",!0),r("form",{class:"forms-sample",onSubmit:t[17]||(t[17]=j(e=>_.submitForm(),["prevent"]))},[r("div",K,[r("div",Q,[W,m(r("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.category_id=e),onChange:t[1]||(t[1]=(...e)=>_.checkCategory&&_.checkCategory(...e)),class:h(["form-control",{"border border-danger":o.v$.category_id.$errors.length>0}])},[X,$,(n(!0),l(c,null,p(s.categories,e=>(n(),l("option",{key:e.id,value:e.id},d(JSON.parse(e.categoryName).ru)+" - "+d(e.access?"Private":"Public"),9,ee))),128))],34),[[I,s.category_id]]),(n(!0),l(c,null,p(o.v$.category_id.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))]),s.hideGroups?(n(),l("div",re,[te,m(r("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.group_id=e),class:h(["form-control",{"border border-danger":o.v$.group_id.$errors.length>0}])},[(n(!0),l(c,null,p(s.groups,e=>(n(),l("option",{key:e.id,value:e.id},d(e.groupName),9,se))),128))],2),[[I,s.group_id]]),(n(!0),l(c,null,p(o.v$.group_id.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))])):f("",!0)]),r("div",oe,[r("div",ne,[le,m(r("input",{type:"text",class:h(["form-control",{"border border-danger":o.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":t[3]||(t[3]=e=>s.title_ru=e)},null,2),[[b,s.title_ru]]),(n(!0),l(c,null,p(o.v$.title_ru.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))]),r("div",ae,[ie,m(r("input",{type:"text",class:h(["form-control",{"border border-danger":o.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":t[4]||(t[4]=e=>s.title_uz=e)},null,2),[[b,s.title_uz]]),(n(!0),l(c,null,p(o.v$.title_uz.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))])]),r("div",ue,[r("div",de,[ce,m(r("textarea",{rows:"10",type:"text",class:h(["form-control",{"border border-danger":o.v$.body_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":t[5]||(t[5]=e=>s.body_ru=e)},null,2),[[b,s.body_ru]]),(n(!0),l(c,null,p(o.v$.body_ru.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))]),r("div",pe,[_e,m(r("textarea",{rows:"10",type:"text",class:h(["form-control",{"border border-danger":o.v$.body_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":t[6]||(t[6]=e=>s.body_uz=e)},null,2),[[b,s.body_uz]]),(n(!0),l(c,null,p(o.v$.body_uz.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))])]),r("div",me,[r("div",he,[ge,s.banner_ru_prev?(n(),l("img",{key:0,src:s.banner_ru_prev,class:"image_prev"},null,8,be)):f("",!0),r("input",{type:"file",id:"banner",onChange:t[7]||(t[7]=e=>_.uploadFilebannerRu(e)),accept:"image/*",class:h([{"border border-danger":o.v$.banner_ru.$errors.length>0},"form-control"])},null,34),(n(!0),l(c,null,p(o.v$.banner_ru.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))]),r("div",ve,[fe,s.banner_uz_prev?(n(),l("img",{key:0,src:s.banner_uz_prev,class:"image_prev"},null,8,ye)):f("",!0),r("input",{type:"file",id:"banner",onChange:t[8]||(t[8]=e=>_.uploadFilebannerUz(e)),accept:"image/*",class:h([{"border border-danger":o.v$.banner_uz.$errors.length>0},"form-control"])},null,34),(n(!0),l(c,null,p(o.v$.banner_uz.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))])]),r("div",ze,[r("div",ke,[Ie,m(r("input",{type:"date",class:h(["form-control",{"border border-danger":o.v$.startDate.$errors.length>0}]),id:"exampleInputstartRu","onUpdate:modelValue":t[9]||(t[9]=e=>s.startDate=e)},null,2),[[b,s.startDate]]),(n(!0),l(c,null,p(o.v$.startDate.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))]),r("div",Ue,[xe,m(r("input",{type:"date",class:"form-control",id:"exampleInputendUZ","onUpdate:modelValue":t[10]||(t[10]=e=>s.endDate=e)},null,512),[[b,s.endDate]])])]),r("div",Se,[r("div",we,[Ce,Ve,r("label",De,[m(r("input",{onChange:t[11]||(t[11]=(...e)=>_.getvalue&&_.getvalue(...e)),type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>s.monetized=e)},null,544),[[U,s.monetized]]),Te,Be,Re])]),r("div",Ge,[je,m(r("input",{type:"number",class:h(["form-control",{"border border-danger":o.v$.price.$errors.length>0}]),id:"exampleInputendUZ","onUpdate:modelValue":t[13]||(t[13]=e=>s.price=e)},null,2),[[b,s.price]]),(n(!0),l(c,null,p(o.v$.price.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))]),r("div",qe,[Ee,Ze,r("label",Ae,[m(r("input",{onChange:t[14]||(t[14]=(...e)=>_.getvaluePin&&_.getvaluePin(...e)),type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=e=>s.pin=e)},null,544),[[U,s.pin]]),Le,Ne,Fe])]),r("div",Pe,[Oe,m(r("input",{type:"number",class:h(["form-control",{"border border-danger":o.v$.order.$errors.length>0}]),id:"exampleInpOutendUZ","onUpdate:modelValue":t[16]||(t[16]=e=>s.order=e)},null,2),[[b,s.order]]),(n(!0),l(c,null,p(o.v$.order.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},d(e.$message),1))),128))])]),s.added?f("",!0):(n(),l("button",{key:0,type:"submit",disabled:_.isDisabled,class:"btn btn-primary mr-2"},"Create",8,Me))],32)])])])])])],64)}const $e=B(A,[["render",He],["__scopeId","data-v-23519021"]]);export{$e as default};
