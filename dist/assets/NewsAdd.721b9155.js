import{G as T}from"./GoBackButton.8ec57f12.js";import{c as x}from"./vue-datepicker.es.17b3f44e.js";import{h as I}from"./maska.esm.cd315c5a.js";import{u as U,r as g,m as z,b as V}from"./index.esm.b21b73c4.js";import{_ as E,r as w,o as s,c as n,f as b,a as t,F as m,e as p,d as f,t as d,l as q,n as y,w as S,v as D,a2 as B,a3 as C}from"./index.34e73fda.js";import{s as L}from"./globalFunction.5ce06618.js";import{C as N,a as A,P as k}from"./ckeditor.713c8e1a.js";import"./_commonjsHelpers.712cc82f.js";import"./vue.runtime.esm-bundler.cd7c4a87.js";const R={setup(){return{v$:U()}},directives:{maska:I},components:{GoBackButton:T,Datepicker:x,ckeditor:N.component},data(){return{url:"https://api.pharmiq.uz/",banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",video_ru:"",video_uz:"",video_ru_length:0,video_uz_length:0,body_ru:"",startDate:null,endDate:null,body_uz:"",courses:[],order:1,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:null,course_id:2,editor:A,editorData_ru:"<p>News content ru</p>",editorData_uz:"<p>News content uz</p>",editorConfig:{}}},computed:{isDisabled:function(){if(this.v$.$touch(),console.log(this.v$.$touch()),this.v$.$error)return!0}},validations(){return{title_ru:{required:g,minLengthValue:z(3)},title_uz:{required:g,minLengthValue:z(3)},editorData_ru:{required:g},editorData_uz:{required:g},banner_ru:{required:V(()=>this.banner_ru.length==0)}}},methods:{inputgetseconds(l){if(l=="ru"){document.querySelector("#video_ru").innerHTML=this.video_ru;let c=document.querySelector("#video_ru iframe");const i=new k(c);var r=this;i.getDuration().then(function(e){r.video_ru_length=e}).catch(function(e){console.log(e)})}else{document.querySelector("#video_uz").innerHTML=this.video_uz;let c=document.querySelector("#video_uz iframe");const i=new k(c);var r=this;i.getDuration().then(function(u){r.video_uz_length=u}).catch(function(u){console.log(u)})}},uploadFilebannerRu(l){var r=l.target.files||l.dataTransfer.files;!r.length||(this.banner_ru=r[0],this.banner_ru_prev=URL.createObjectURL(r[0]))},uploadFilebannerUz(l){var r=l.target.files||l.dataTransfer.files;!r.length||(this.banner_uz=r[0],this.banner_uz_prev=URL.createObjectURL(r[0]))},async requestApi(){const l={title_ru:this.title_ru,title_uz:this.title_uz,content_ru:this.editorData_ru,content_uz:this.editorData_uz,postedDate:new Date().toISOString().replace("T"," ")},r=L(),c=Object.assign(l,r);var i=new FormData;i.append("banner",this.banner_ru);for(const e in c)i.append(e,c[e]);try{let e=localStorage.getItem("token");const u=await fetch(this.url+"api/v1/news/add",{method:"POST",body:i,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+e}}),_=await u.json();window.scrollTo({top:0,behavior:"smooth"}),u.status==401?this.resStringError=_.message:_.error?typeof _.message=="object"?this.resError=_.message:this.resStringError=_.message:(this.added=!0,this.resSuccess="News Successfully Added")}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",e)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)}},created(){this.userInfo=JSON.parse(localStorage.getItem("user"))}},h=l=>(B("data-v-2f865997"),l=l(),C(),l),F={class:"mt-3"},j={class:"row"},O={class:"col-md-12 grid-margin stretch-card"},Z={class:"card"},$={class:"card-body"},G=h(()=>t("h4",{class:"card-title"},"Add News",-1)),M={class:"error"},P={key:1,class:"error"},H={key:2,class:"success"},J={class:"form-group row"},K={class:"col-md-12"},Q=h(()=>t("label",{class:"col-sm-3 col-form-label",for:"banner"},"Banner",-1)),W=["src"],X={class:"form-group row"},Y={class:"col-md-6"},ee=h(()=>t("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),re={class:"col-md-6"},te=h(()=>t("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),oe={class:"form-group row"},se={class:"col-md-6"},ne=h(()=>t("label",{for:"exampleInputTitleRu"},"Text (\u0420\u0423)",-1)),ie={class:"col-md-6"},le=h(()=>t("label",{for:"exampleInputTitleUZ"},"Text (UZ)",-1)),ae=["disabled"];function ue(l,r,c,i,e,u){const _=w("GoBackButton"),v=w("ckeditor");return s(),n(m,null,[b(_),t("div",F,[t("div",j,[t("div",O,[t("div",Z,[t("div",$,[G,e.resError?(s(!0),n(m,{key:0},p(e.resError,(o,a)=>(s(),n("p",M,d(a)+" : "+d(o[0]),1))),256)):f("",!0),e.resStringError?(s(),n("p",P,d(e.resStringError),1)):f("",!0),e.resSuccess?(s(),n("p",H,d(e.resSuccess),1)):f("",!0),t("form",{class:"forms-sample",onSubmit:r[5]||(r[5]=q(o=>u.submitForm(),["prevent"]))},[t("div",J,[t("div",K,[Q,e.banner_ru_prev?(s(),n("img",{key:0,src:e.banner_ru_prev,class:"image_prev",width:"250"},null,8,W)):f("",!0),t("input",{type:"file",id:"banner",onChange:r[0]||(r[0]=o=>u.uploadFilebannerRu(o)),accept:"image/*",class:y([{"border border-danger":i.v$.banner_ru.$errors.length>0},"form-control"])},null,34),(s(!0),n(m,null,p(i.v$.banner_ru.$errors,(o,a)=>(s(),n("small",{class:"error",key:a},d(o.$message),1))),128))])]),t("div",X,[t("div",Y,[ee,S(t("input",{type:"text",class:y(["form-control",{"border border-danger":i.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":r[1]||(r[1]=o=>e.title_ru=o)},null,2),[[D,e.title_ru]]),(s(!0),n(m,null,p(i.v$.title_ru.$errors,(o,a)=>(s(),n("small",{class:"error",key:a},d(o.$message),1))),128))]),t("div",re,[te,S(t("input",{type:"text",class:y(["form-control",{"border border-danger":i.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":r[2]||(r[2]=o=>e.title_uz=o)},null,2),[[D,e.title_uz]]),(s(!0),n(m,null,p(i.v$.title_uz.$errors,(o,a)=>(s(),n("small",{class:"error",key:a},d(o.$message),1))),128))])]),t("div",oe,[t("div",se,[ne,b(v,{editor:e.editor,modelValue:e.editorData_ru,"onUpdate:modelValue":r[3]||(r[3]=o=>e.editorData_ru=o),config:e.editorConfig},null,8,["editor","modelValue","config"]),(s(!0),n(m,null,p(i.v$.editorData_ru.$errors,(o,a)=>(s(),n("small",{class:"error",key:a},d(o.$message),1))),128))]),t("div",ie,[le,b(v,{editor:e.editor,modelValue:e.editorData_uz,"onUpdate:modelValue":r[4]||(r[4]=o=>e.editorData_uz=o),config:e.editorConfig},null,8,["editor","modelValue","config"]),(s(!0),n(m,null,p(i.v$.editorData_uz.$errors,(o,a)=>(s(),n("small",{class:"error",key:a},d(o.$message),1))),128))])]),e.added?f("",!0):(s(),n("button",{key:0,type:"submit",disabled:u.isDisabled,class:"btn btn-primary mr-2"},"Create",8,ae))],32)])])])])])],64)}const be=E(R,[["render",ue],["__scopeId","data-v-2f865997"]]);export{be as default};
