import{G as z}from"./GoBackButton.8ec57f12.js";import{c as C}from"./vue-datepicker.es.17b3f44e.js";import{h as U}from"./maska.esm.cd315c5a.js";import{u as w,r as g,m as I,i as T}from"./index.esm.b21b73c4.js";import{_ as E,r as N,o as n,c as i,f as j,a as s,F as d,e as p,d as y,t as u,l as V,w as v,p as O,n as f,v as b,a2 as R,a3 as A}from"./index.34e73fda.js";import{s as k}from"./globalFunction.5ce06618.js";const D={setup(){return{v$:w()}},directives:{maska:U},components:{GoBackButton:z,Datepicker:C},data(){return{url:"https://api.pharmiq.uz/",name_ru:"",name_uz:"",banner_ru:[],price:0,priceIQC:0,amount:0,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,descriptionText_ru:"",descriptionText_uz:"",storeChoose:null,store:[],banner_ru_prev:[]}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{descriptionText_ru:{required:g,minLengthValue:I(5)},descriptionText_uz:{required:g,minLengthValue:I(5)},name_ru:{required:g,minLengthValue:I(3)},name_uz:{required:g,minLengthValue:I(3)},price:{required:g,integer:T},priceIQC:{required:g,integer:T},amount:{required:g,integer:T},storeChoose:{required:g}}},methods:{async removeImage(a,o){let c=o.split("/").slice(-1)[0];if(c){var r=confirm("Want to delete Image?");if(r){const h={imageName:c},_=k(),e=Object.assign(h,_);var t=new FormData;for(const l in e)t.append(l,e[l]);try{let l=localStorage.getItem("token");const x=await fetch(this.url+"api/v1/store/product/deleteImage/"+this.$route.params.id,{method:"POST",body:t,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+l}}),S=await x.json();window.scrollTo({top:0,behavior:"smooth"}),x.status==401?(this.resStringError=S.message,this.added=!1):S.error?(typeof S.message=="object"?this.resError=S.message:this.resStringError=S.message,this.added=!1):(document.querySelector("#s-"+a).remove(),this.resSuccess="Image Successfully Deleted")}catch(l){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",l)}}}},async requestApi(){this.added=!0;const a={productName_ru:this.name_ru.toUpperCase(),productName_uz:this.name_uz.toUpperCase(),productDescription_ru:this.descriptionText_ru,productDescription_uz:this.descriptionText_uz,productCost:this.price,productAmount:this.amount,category_id:1,store_id:this.storeChoose,iqc:this.priceIQC},o=k(),c=Object.assign(a,o);var r=new FormData;this.banner_ru.length!=0&&this.banner_ru.forEach(t=>{r.append("productIMG[]",t)});for(const t in c)r.append(t,c[t]);try{let t=localStorage.getItem("token");const h=await fetch(this.url+"api/v1/store/product/edit/"+this.$route.params.id,{method:"POST",body:r,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+t}}),_=await h.json();window.scrollTo({top:0,behavior:"smooth"}),h.status==401?(this.resStringError=_.message,this.added=!1):_.error?(typeof _.message=="object"?this.resError=_.message:this.resStringError=_.message,this.added=!1):this.resSuccess="Store Successfully Updated"}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},uploadFilebannerRu(a){var o=a.target.files||a.dataTransfer.files;if(o.length==0){this.banner_ru=[],this.banner_ru_prev=[];return}for(let c=0;c<o.length;c++){const r=o[c];this.banner_ru.push(r),this.banner_ru_prev.push(URL.createObjectURL(r))}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},requestGetStore(){let a=this.url+"api/v1/store?page=1",o=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(a,c).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.store=r.data})},getStore(){let a=this.url+"api/v1/store/product?product_id="+this.$route.params.id,o=localStorage.getItem("token");const c={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(a,c).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{if(r){this.name_ru=JSON.parse(r.productName).ru,this.name_uz=JSON.parse(r.productName).uz,this.descriptionText_ru=JSON.parse(r.productDescription).ru,this.descriptionText_uz=JSON.parse(r.productDescription).uz,this.price=r.productCost,this.amount=r.productAmount,this.priceIQC=r.iqc;try{JSON.parse(`${r.productIMG}`).forEach(t=>{this.banner_ru_prev.push(this.url+"files/store/"+t)})}catch{this.banner_ru_prev=this.url+"files/store/"+r.productIMG}this.storeChoose=r.store_id}})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getStore(),this.requestGetStore()}},m=a=>(R("data-v-741a2673"),a=a(),A(),a),q={class:"mt-3"},B={class:"row"},G={class:"col-md-12 grid-margin stretch-card"},$={class:"card"},L={class:"card-body"},F=m(()=>s("h4",{class:"card-title"},"Update Store",-1)),M={class:"error"},P={key:1,class:"error"},Q={key:2,class:"success"},Z={class:"form-group row"},J={class:"col-md-12"},H=m(()=>s("label",{for:"banner"},"Stores",-1)),X=m(()=>s("option",{disabled:"",value:"0"},"Please select one",-1)),W=["value"],K={class:"col-md-6"},Y=m(()=>s("label",{for:"exampleInputTitleRu"},"Name ru",-1)),ee={class:"col-md-6"},re=m(()=>s("label",{for:"exampleInputTitleRu"},"Name uz",-1)),te={class:"col-md-6"},se=m(()=>s("label",{for:"exampleInputTitleRu"},"Description ru ",-1)),oe={class:"col-md-6"},ne=m(()=>s("label",{for:"exampleInputTitleRu"},"Description uz ",-1)),ie={class:"col-md-12"},le=m(()=>s("label",{class:"col-sm-4",for:"banner"},"Image",-1)),ae={class:"banner"},ce={key:0},ue=["src"],de=["id"],pe=["src"],me=["onClick"],he={class:"col-md-12"},_e={class:"row mt-3"},ge={class:"col-md-4"},ve=m(()=>s("label",{for:"exampleInputTitleUZ"},"Price $",-1)),fe={class:"col-md-4"},be=m(()=>s("label",{for:"exampleInputTitleUZ"},"IQC",-1)),ye={class:"col-md-4"},Se=m(()=>s("label",{for:"exampleInputTitleUZ"},"Amount",-1)),Ie=["disabled"];function xe(a,o,c,r,t,h){const _=N("GoBackButton");return n(),i(d,null,[j(_),s("div",q,[s("div",B,[s("div",G,[s("div",$,[s("div",L,[F,t.resError?(n(!0),i(d,{key:0},p(t.resError,(e,l)=>(n(),i("p",M,u(l)+" : "+u(e[0]),1))),256)):y("",!0),t.resStringError?(n(),i("p",P,u(t.resStringError),1)):y("",!0),t.resSuccess?(n(),i("p",Q,u(t.resSuccess),1)):y("",!0),s("form",{class:"forms-sample",onSubmit:o[9]||(o[9]=V(e=>h.submitForm(),["prevent"]))},[s("div",Z,[s("div",J,[H,v(s("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>t.storeChoose=e),class:f(["form-control",{"border border-danger":r.v$.storeChoose.$errors.length>0}])},[X,(n(!0),i(d,null,p(t.store,e=>(n(),i("option",{key:e.id,value:e.id},u(e.storeName),9,W))),128))],2),[[O,t.storeChoose]]),(n(!0),i(d,null,p(r.v$.storeChoose.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",K,[Y,v(s("input",{type:"text",class:f(["form-control capilizie",{"border border-danger":r.v$.name_ru.$errors.length>0}]),placeholder:"IPHONE 14 PRO MAX",id:"exampleInputTitleRu","onUpdate:modelValue":o[1]||(o[1]=e=>t.name_ru=e)},null,2),[[b,t.name_ru]]),(n(!0),i(d,null,p(r.v$.name_ru.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",ee,[re,v(s("input",{type:"text",class:f(["form-control capilizie",{"border border-danger":r.v$.name_uz.$errors.length>0}]),placeholder:"IPHONE 14 PRO MAX UZ",id:"exampleInputTitleRu","onUpdate:modelValue":o[2]||(o[2]=e=>t.name_uz=e)},null,2),[[b,t.name_uz]]),(n(!0),i(d,null,p(r.v$.name_uz.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",te,[se,v(s("input",{type:"text",class:f(["form-control",{"border border-danger":r.v$.descriptionText_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":o[3]||(o[3]=e=>t.descriptionText_ru=e)},null,2),[[b,t.descriptionText_ru]]),(n(!0),i(d,null,p(r.v$.descriptionText_ru.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",oe,[ne,v(s("input",{type:"text",class:f(["form-control",{"border border-danger":r.v$.descriptionText_uz.$errors.length>0}]),id:"exampleInputTitleUz","onUpdate:modelValue":o[4]||(o[4]=e=>t.descriptionText_uz=e)},null,2),[[b,t.descriptionText_uz]]),(n(!0),i(d,null,p(r.v$.descriptionText_uz.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",ie,[le,s("div",ae,[typeof t.banner_ru_prev=="string"?(n(),i("div",ce,[t.banner_ru_prev?(n(),i("img",{key:0,src:t.banner_ru_prev,class:"image_prev"},null,8,ue)):y("",!0)])):(n(!0),i(d,{key:1},p(t.banner_ru_prev,(e,l)=>(n(),i("div",{id:"s-"+l},[s("img",{style:{"max-height":"250px"},src:e,width:"100",class:"image_prev"},null,8,pe),t.banner_ru_prev.length>1?(n(),i("span",{key:0,onClick:x=>h.removeImage(l,e)},"remove",8,me)):y("",!0)],8,de))),256))]),s("input",{multiple:"",type:"file",id:"banner",onChange:o[5]||(o[5]=e=>h.uploadFilebannerRu(e)),accept:"image/*",class:"form-control"},null,32)]),s("div",he,[s("div",_e,[s("div",ge,[ve,v(s("input",{type:"number",class:f(["form-control",{"border border-danger":r.v$.price.$errors.length>0}]),placeholder:"100",id:"exampleInputTitleUZ","onUpdate:modelValue":o[6]||(o[6]=e=>t.price=e)},null,2),[[b,t.price]]),(n(!0),i(d,null,p(r.v$.price.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",fe,[be,v(s("input",{type:"number",class:f(["form-control",{"border border-danger":r.v$.price.$errors.length>0}]),placeholder:"100",id:"exampleInputTitleUZ","onUpdate:modelValue":o[7]||(o[7]=e=>t.priceIQC=e)},null,2),[[b,t.priceIQC]]),(n(!0),i(d,null,p(r.v$.price.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))]),s("div",ye,[Se,v(s("input",{type:"number",class:f(["form-control",{"border border-danger":r.v$.amount.$errors.length>0}]),placeholder:"10",id:"exampleInputTitleUZ","onUpdate:modelValue":o[8]||(o[8]=e=>t.amount=e)},null,2),[[b,t.amount]]),(n(!0),i(d,null,p(r.v$.amount.$errors,(e,l)=>(n(),i("small",{class:"error",key:l},u(e.$message),1))),128))])])])]),t.added?y("",!0):(n(),i("button",{key:0,type:"submit",disabled:h.isDisabled,class:"btn btn-primary mr-2"},"Update",8,Ie))],32)])])])])])],64)}const Ne=E(D,[["render",xe],["__scopeId","data-v-741a2673"]]);export{Ne as default};
