import{G as U}from"./GoBackButton.8ec57f12.js";import{c as x}from"./vue-datepicker.es.17b3f44e.js";import{h as w}from"./maska.esm.cd315c5a.js";import{u as C,r as y,b as k,c as D,d as T,m as z,i as V}from"./index.esm.b21b73c4.js";import{_ as B,r as N,o as n,c as l,f as E,a as e,F as p,e as _,d as v,t as c,l as G,w as m,p as I,n as g,v as b,a0 as S,a2 as j,a3 as O}from"./index.34e73fda.js";import{s as R}from"./globalFunction.5ce06618.js";const P={setup(){return{v$:C()}},directives:{maska:w},components:{GoBackButton:U,Datepicker:x},data(){return{url:"https://api.pharmiq.uz/",hideGroups:!1,group_id:null,groups:[],banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",body_ru:"",startDate:null,endDate:null,body_uz:"",categories:[],added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:0,category_id:1,pin:0,order:0}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{category_id:{required:y},startDate:{required:y},order:{required:k(()=>this.pin==!0),maxValue:D(10),minValue:T(0)},title_ru:{required:y,minLengthValue:z(3)},title_uz:{required:y,minLengthValue:z(3)},body_ru:{required:y,minLengthValue:z(10)},body_uz:{required:y,minLengthValue:z(10)},price:{required:k(()=>this.monetized==1),integer:V},group_id:{required:k(()=>this.category_id=="special")}}},methods:{checkCategory(a){this.hideGroups=!1;let s=this.categories.find(h=>h.id==a.target.value);(s&&s.access==!0||this.category_id=="special")&&(this.getGroups(),this.hideGroups=!0)},getvaluePin(){console.log(this.pin)},getGroups(){let a=this.url+"api/v1/groups?page=1",s=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(a,h).then(t=>(t.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),t.json())).then(t=>{this.groups=t.data})},uploadFilebannerRu(a){var s=a.target.files||a.dataTransfer.files;!s.length||(this.banner_ru=s[0],this.banner_ru_prev=URL.createObjectURL(s[0]))},uploadFilebannerUz(a){var s=a.target.files||a.dataTransfer.files;!s.length||(this.banner_uz=s[0],this.banner_uz_prev=URL.createObjectURL(s[0]))},async requestApi(){const a={courseTitleName_ru:this.title_ru,courseTitleName_uz:this.title_uz,courseInfo_ru:this.body_ru,courseInfo_uz:this.body_uz,courseMonetized:this.monetized?1:0,coursePrice:this.price,category_id:this.category_id,startDate:this.startDate,endDate:this.endDate,pin:this.pin,order:this.order},s=R(),h=Object.assign(a,s);var t=new FormData;this.banner_ru.length!=0&&t.append("courseBanner_ru",this.banner_ru),this.banner_uz.length!=0&&t.append("courseBanner_uz",this.banner_uz);for(const o in h)t.append(o,h[o]);this.group_id&&t.append("courseForGroup",this.group_id);try{let o=localStorage.getItem("token");const d=await fetch(this.url+"api/v1/course/editNew/"+this.$route.params.id,{method:"POST",body:t,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+o}}),f=await d.json();window.scrollTo({top:0,behavior:"smooth"}),d.status==401?this.resStringError=f.message:f.error?typeof f.message=="object"?this.resError=f.message:this.resStringError=f.message:this.resSuccess="Course Successfully Edited"}catch(o){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",o)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)},getCourse(){let a=this.url+"api/v1/course?id="+this.$route.params.id,s=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(a,h).then(t=>(t.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),t.json())).then(t=>{Object.keys(t).length==0&&this.$router.push({name:"courses.list"}),t.courseTypeByAccess==0||t.access?(this.category_id="special",this.group_id=t.courseForGroup,this.hideGroups=!0,this.getGroups(),t.access&&(this.category_id=t.category_id)):this.category_id=t.category_id,this.monetized=t.courseMonetized==1,this.price=t.coursePrice?t.coursePrice:0,this.startDate=t.startDate,this.endDate=t.endDate,this.pin=t.pin,this.order=t.order?t.order:0,this.title_ru=JSON.parse(t.infos.courseTitleName).ru,this.title_uz=JSON.parse(t.infos.courseTitleName).uz,this.body_ru=JSON.parse(t.infos.courseInfo).ru,this.body_uz=JSON.parse(t.infos.courseInfo).uz,this.banner_ru_prev=this.url+"files/course/"+JSON.parse(t.infos.courseBanner).ru,this.banner_uz_prev=this.url+"files/course/"+JSON.parse(t.infos.courseBanner).uz})},getCategories(){let a=this.url+"api/v1/course/category?page=1",s=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(a,h).then(t=>(t.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),t.json())).then(t=>{this.categories=t.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getCourse(),this.getCategories()}},i=a=>(j("data-v-713c1589"),a=a(),O(),a),Z={class:"mt-3"},q={class:"row"},F={class:"col-md-12 grid-margin stretch-card"},L={class:"card"},A={class:"card-body"},J=i(()=>e("h4",{class:"card-title"},"Edit Course",-1)),M={class:"error"},H={key:1,class:"error"},Y={key:2,class:"success"},K={class:"form-group row"},Q={class:"col-md-12"},W=i(()=>e("label",{class:"col-sm-3 col-form-label",for:"banner"},"Category",-1)),X=i(()=>e("option",{disabled:"",value:"0"},"Please select one",-1)),$=i(()=>e("option",{value:"special"},"Special",-1)),ee=["selected","value"],re={key:0,class:"col-md-12"},te=i(()=>e("label",{class:"col-sm-3",for:"banner"},"Group",-1)),se=["value"],oe={class:"form-group row"},ne={class:"col-md-6"},le=i(()=>e("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),ie={class:"col-md-6"},ae=i(()=>e("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),ue={class:"form-group row"},ce={class:"col-md-6"},de=i(()=>e("label",{for:"exampleInputbodyRu"},"Body (\u0420\u0423)",-1)),pe={class:"col-md-6"},_e=i(()=>e("label",{for:"exampleInputbodyUZ"},"Body (UZ)",-1)),me={class:"form-group row"},he={class:"col-md-6"},ge=i(()=>e("label",{class:"col-sm-3 col-form-label",for:"banner"},"banner (\u0420\u0423)",-1)),be=["src"],fe={class:"col-md-6"},ve=i(()=>e("label",{class:"col-sm-3 col-form-label",for:"banner"},"banner (UZ)",-1)),ye=["src"],ze={class:"form-group row"},ke={class:"col-md-6"},Ie=i(()=>e("label",{for:"exampleInputstartRu"},"Start Date",-1)),Se={class:"col-md-6"},Ue=i(()=>e("label",{for:"exampleInputendUZ"},"End Date ",-1)),xe={class:"form-group row"},we={class:"col-md-2"},Ce=i(()=>e("label",{for:"exampleInputstartRu"},"Course Monetized",-1)),De=i(()=>e("br",null,null,-1)),Te={class:"language-switcher"},Ve=i(()=>e("span",{class:"slider round"},null,-1)),Be=i(()=>e("span",{class:"select-ru"},"No",-1)),Ne=i(()=>e("span",{class:"select-uz"},"Yes",-1)),Ee={class:"col-md-4"},Ge=i(()=>e("label",{for:"exampleInputendUZ"},"Course Price ",-1)),je={class:"col-md-2"},Oe=i(()=>e("label",{for:"exampleInputstartRu"},"Course Pin",-1)),Re=i(()=>e("br",null,null,-1)),Pe={class:"language-switcher"},Ze=i(()=>e("span",{class:"slider round"},null,-1)),qe=i(()=>e("span",{class:"select-ru"},"No",-1)),Fe=i(()=>e("span",{class:"select-uz"},"Yes",-1)),Le={class:"col-md-4"},Ae=i(()=>e("label",{for:"exampleInpOutendUZ"},"Course Order ( 0 = adding to last item ) ",-1)),Je=["disabled"];function Me(a,s,h,t,o,d){const f=N("GoBackButton");return n(),l(p,null,[E(f),e("div",Z,[e("div",q,[e("div",F,[e("div",L,[e("div",A,[J,o.resError?(n(!0),l(p,{key:0},_(o.resError,(r,u)=>(n(),l("p",M,c(u)+" : "+c(r[0]),1))),256)):v("",!0),o.resStringError?(n(),l("p",H,c(o.resStringError),1)):v("",!0),o.resSuccess?(n(),l("p",Y,c(o.resSuccess),1)):v("",!0),e("form",{class:"forms-sample",onSubmit:s[17]||(s[17]=G(r=>d.submitForm(),["prevent"]))},[e("div",K,[e("div",Q,[W,m(e("select",{"onUpdate:modelValue":s[0]||(s[0]=r=>o.category_id=r),onChange:s[1]||(s[1]=(...r)=>d.checkCategory&&d.checkCategory(...r)),class:g(["form-control",{"border border-danger":t.v$.category_id.$errors.length>0}])},[X,$,(n(!0),l(p,null,_(o.categories,r=>(n(),l("option",{key:r.id,selected:o.category_id==r.id,value:r.id},c(JSON.parse(r.categoryName).ru)+" - "+c(r.access?"Private":"Public"),9,ee))),128))],34),[[I,o.category_id]]),(n(!0),l(p,null,_(t.v$.category_id.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))]),o.hideGroups?(n(),l("div",re,[te,m(e("select",{"onUpdate:modelValue":s[2]||(s[2]=r=>o.group_id=r),class:g(["form-control",{"border border-danger":t.v$.group_id.$errors.length>0}])},[(n(!0),l(p,null,_(o.groups,r=>(n(),l("option",{key:r.id,value:r.id},c(r.groupName),9,se))),128))],2),[[I,o.group_id]]),(n(!0),l(p,null,_(t.v$.group_id.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))])):v("",!0)]),e("div",oe,[e("div",ne,[le,m(e("input",{type:"text",class:g(["form-control",{"border border-danger":t.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":s[3]||(s[3]=r=>o.title_ru=r)},null,2),[[b,o.title_ru]]),(n(!0),l(p,null,_(t.v$.title_ru.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))]),e("div",ie,[ae,m(e("input",{type:"text",class:g(["form-control",{"border border-danger":t.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":s[4]||(s[4]=r=>o.title_uz=r)},null,2),[[b,o.title_uz]]),(n(!0),l(p,null,_(t.v$.title_uz.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))])]),e("div",ue,[e("div",ce,[de,m(e("textarea",{rows:"10",type:"text",class:g(["form-control",{"border border-danger":t.v$.body_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":s[5]||(s[5]=r=>o.body_ru=r)},null,2),[[b,o.body_ru]]),(n(!0),l(p,null,_(t.v$.body_ru.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))]),e("div",pe,[_e,m(e("textarea",{rows:"10",type:"text",class:g(["form-control",{"border border-danger":t.v$.body_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":s[6]||(s[6]=r=>o.body_uz=r)},null,2),[[b,o.body_uz]]),(n(!0),l(p,null,_(t.v$.body_uz.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))])]),e("div",me,[e("div",he,[ge,o.banner_ru_prev?(n(),l("img",{key:0,src:o.banner_ru_prev,class:"image_prev"},null,8,be)):v("",!0),e("input",{type:"file",id:"banner",onChange:s[7]||(s[7]=r=>d.uploadFilebannerRu(r)),accept:"image/*",class:"form-control"},null,32)]),e("div",fe,[ve,o.banner_uz_prev?(n(),l("img",{key:0,src:o.banner_uz_prev,class:"image_prev"},null,8,ye)):v("",!0),e("input",{type:"file",id:"banner",onChange:s[8]||(s[8]=r=>d.uploadFilebannerUz(r)),accept:"image/*",class:"form-control"},null,32)])]),e("div",ze,[e("div",ke,[Ie,m(e("input",{type:"date",class:g(["form-control",{"border border-danger":t.v$.startDate.$errors.length>0}]),id:"exampleInputstartRu","onUpdate:modelValue":s[9]||(s[9]=r=>o.startDate=r)},null,2),[[b,o.startDate]]),(n(!0),l(p,null,_(t.v$.startDate.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))]),e("div",Se,[Ue,m(e("input",{type:"date",class:"form-control",id:"exampleInputendUZ","onUpdate:modelValue":s[10]||(s[10]=r=>o.endDate=r)},null,512),[[b,o.endDate]])])]),e("div",xe,[e("div",we,[Ce,De,e("label",Te,[m(e("input",{onChange:s[11]||(s[11]=(...r)=>d.getvalue&&d.getvalue(...r)),type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=r=>o.monetized=r)},null,544),[[S,o.monetized]]),Ve,Be,Ne])]),e("div",Ee,[Ge,m(e("input",{type:"number",class:g(["form-control",{"border border-danger":t.v$.price.$errors.length>0}]),id:"exampleInputendUZ","onUpdate:modelValue":s[13]||(s[13]=r=>o.price=r)},null,2),[[b,o.price]]),(n(!0),l(p,null,_(t.v$.price.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))]),e("div",je,[Oe,Re,e("label",Pe,[m(e("input",{onChange:s[14]||(s[14]=(...r)=>d.getvaluePin&&d.getvaluePin(...r)),type:"checkbox","onUpdate:modelValue":s[15]||(s[15]=r=>o.pin=r)},null,544),[[S,o.pin]]),Ze,qe,Fe])]),e("div",Le,[Ae,m(e("input",{type:"number",class:g(["form-control",{"border border-danger":t.v$.order.$errors.length>0}]),id:"exampleInpOutendUZ","onUpdate:modelValue":s[16]||(s[16]=r=>o.order=r)},null,2),[[b,o.order]]),(n(!0),l(p,null,_(t.v$.order.$errors,(r,u)=>(n(),l("small",{class:"error",key:u},c(r.$message),1))),128))])]),o.added?v("",!0):(n(),l("button",{key:0,type:"submit",disabled:d.isDisabled,class:"btn btn-primary mr-2"},"Edit",8,Je))],32)])])])])])],64)}const $e=B(P,[["render",Me],["__scopeId","data-v-713c1589"]]);export{$e as default};
