import{C as v,P as C}from"./Pagination.b8ff8fbc.js";import{L as S}from"./LanguageSwitcher.c9c9f8e9.js";import{s as I}from"./globalFunction.5ce06618.js";import{_ as k,r as p,o as a,c as n,a as e,b as m,d as c,w,v as N,f as P,t as l,F as g,e as _,h as q}from"./index.34e73fda.js";const A={data(){return{imageUrl:"https://api.pharmiq.uz/files/category/",disabled:!1,modelName:"",modelUserId:"",currentPage:1,last_page:1,total:1,per_page:1,categories:[],response:null,resError:!1,resSuccess:!1,resStringError:"",submitButton:!0,categorySearch:"",timerId:null,url:"https://api.pharmiq.uz/",loading:!0,userInfo:null}},components:{CrudButton:v,Pagination:C,LanguageSwitcher:S},computed:{},methods:{showImageUrl(t){return this.imageUrl+t},searchCategory(){clearTimeout(this.timerId),this.categorySearch!=""?(this.loading=!0,this.timerId=setTimeout(()=>{this.requestApi(1,this.categorySearch)},2e3)):(this.loading=!0,this.timerId=setTimeout(()=>this.requestApi(this.currentPage),2e3))},showCategory(t){this.$router.push({name:"categories.show",params:{id:t}})},openmodel(t,i){this.modelUserId=t,this.modelName=i,this.submitButton=!0,this.resError=!1,this.resSuccess=!1,this.resStringError="",$("#exampleModal").modal("show")},showUrl(){console.log("https://api.pharmiq.uz/")},editCategory(t){this.$router.push({name:"categories.edit",params:{id:t}})},onPageChange(t){console.log(t),this.currentPage=t,this.loading=!0,this.requestApi(t),localStorage.setItem("currentPage",t)},refreshList(){this.loading=!0,this.requestApi(1)},async requestApiDelete(){this.disabled=!0;const t={usid:this.modelUserId},i=I(),u=Object.assign(t,i);try{let d=localStorage.getItem("token");console.log(this.modelUserId);const o=await(await fetch(this.url+"api/v1/course/category/delete/"+this.modelUserId,{method:"POST",body:JSON.stringify(u),headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer "+d}})).json();o.error?typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message:(this.resSuccess="Successfully Deleted",this.requestApi(1),this.submitButton=!1)}catch(d){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",d)}},requestApi(t,i=null){let u=this.url+"api/v1/course/category?page="+t;i&&(u=this.url+"api/v1/course/category?page=1&search="+i);let d=localStorage.getItem("token");const s={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+d})};fetch(u,s).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.response=o,this.last_page=o.last_page,this.total=o.total,this.per_page=o.per_page,this.categories=o.data,window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{this.loading=!1},1e3)})}},mounted(){this.$i18n.locale="ru",console.log(this.$i18n.availableLocales)},created(){this.userInfo=JSON.parse(localStorage.getItem("user"));const t=localStorage.getItem("currentPage");t&&(this.currentPage=parseInt(t)),this.requestApi(1)}},E={class:"row"},B={class:"col-md-3"},U={class:"col-md-6"},O=["placeholder"],L={class:"col-md-3 text-center"},T={class:"mt-3"},j={class:"row"},z={class:"col-12"},D={class:"table-responsive"},x={class:"table"},J={class:"thead-dark"},M={scope:"col"},V={scope:"col"},F={scope:"col"},G={scope:"col"},H=["src"],R={class:"actions"},K=["onClick"],Q=e("i",{class:"ti ti-menu","data-toggle":"tooltip",title:"Order Courses"},null,-1),W=[Q],X=["onClick"],Y=e("i",{class:"ti ti-eye","data-toggle":"tooltip",title:"Show"},null,-1),Z=[Y],ee=["onClick"],te=e("i",{class:"ti ti-pencil-alt","data-toggle":"tooltip",title:"Edit"},null,-1),se=[te],oe=["onClick"],re=e("i",{class:"ti ti-trash","data-toggle":"tooltip",title:"Edit"},null,-1),ie=[re],ae={class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},le={class:"modal-dialog",role:"document"},ne={class:"modal-content"},ce=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Delete Category"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"\xD7")])],-1),de={class:"modal-body text-center"},ue={class:"error"},he={key:1,class:"error"},pe={key:2,class:"success"},ge=e("h4",null,"Are you sure you want to delete this user?",-1),me={class:"modal-footer"},_e=e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Close",-1),ye=["disabled"],fe={key:0,class:"loading"},be=e("img",{src:q},null,-1),ve=[be];function Ce(t,i,u,d,s,o){const y=p("CrudButton"),f=p("LanguageSwitcher"),b=p("Pagination");return a(),n(g,null,[e("div",E,[e("div",B,[s.userInfo&&(s.userInfo.role=="Creator"||s.userInfo.role=="Owner")?(a(),m(y,{key:0,urlName:"categories.add",btnName:t.$t("addCategory")},null,8,["btnName"])):c("",!0)]),e("div",U,[w(e("input",{style:{visibility:"hidden"},type:"search",onInput:i[0]||(i[0]=(...r)=>o.searchCategory&&o.searchCategory(...r)),"onUpdate:modelValue":i[1]||(i[1]=r=>s.categorySearch=r),class:"form-control",placeholder:t.$t("search")+" Category Name"},null,40,O),[[N,s.categorySearch]])]),e("div",L,[P(f)])]),e("div",T,[e("div",j,[e("div",z,[e("div",D,[e("table",x,[e("thead",J,[e("tr",null,[e("th",M,l(t.$t("icon")),1),e("th",V,l(t.$t("title")),1),e("th",F,l(t.$t("access")),1),e("th",G,l(t.$t("actions")),1)])]),e("tbody",null,[(a(!0),n(g,null,_(s.categories,r=>(a(),n("tr",{key:r.id},[e("td",null,[e("img",{src:o.showImageUrl(t.$i18n.locale=="ru"?JSON.parse(r.categoryIcon).ru:JSON.parse(r.categoryIcon).uz),alt:""},null,8,H)]),e("td",null,l(t.$i18n.locale=="ru"?JSON.parse(r.categoryName).ru:JSON.parse(r.categoryName).uz),1),e("td",null,l(r.access?"Private":"Public"),1),e("td",R,[e("div",{class:"edit mr-3 cursor-pointer",onClick:h=>this.$router.push({name:"pins.all",params:{id:r.id}})},W,8,K),e("div",{onClick:h=>o.showCategory(r.id),class:"show text-primary mr-2 cursor-pointer"},Z,8,X),s.userInfo&&s.userInfo.role=="Creator"?(a(),n("div",{key:0,onClick:h=>o.editCategory(r.id),class:"edit mr-2 cursor-pointer"},se,8,ee)):c("",!0),s.userInfo&&(s.userInfo.role=="Creator"||s.userInfo.role=="Owner")?(a(),n("div",{key:1,"data-toggle":"modal","data-target":"#exampleModal cursor-pointer",onClick:h=>o.openmodel(r.id,JSON.parse(r.categoryName).ru),class:"delete text-danger"},ie,8,oe)):c("",!0)])]))),128))])])]),s.last_page!=1?(a(),m(b,{key:0,"total-pages":this.last_page,total:this.total,"per-page":this.per_page,"current-page":s.currentPage,onPagechanged:o.onPageChange},null,8,["total-pages","total","per-page","current-page","onPagechanged"])):c("",!0)])])]),e("div",ae,[e("div",le,[e("div",ne,[ce,e("div",de,[s.resError?(a(!0),n(g,{key:0},_(s.resError,(r,h)=>(a(),n("p",ue,l(h)+" : "+l(r[0]),1))),256)):c("",!0),s.resStringError?(a(),n("p",he,l(s.resStringError),1)):c("",!0),s.resSuccess?(a(),n("p",pe,l(s.resSuccess),1)):c("",!0),ge,e("h4",null,l(s.modelName),1),e("p",null,"CategoryId: "+l(s.modelUserId),1)]),e("div",me,[_e,s.submitButton?(a(),n("button",{key:0,disabled:s.disabled,type:"button",onClick:i[2]||(i[2]=(...r)=>o.requestApiDelete&&o.requestApiDelete(...r)),class:"btn btn-primary"},"Delete Category",8,ye)):c("",!0)])])])]),s.loading?(a(),n("div",fe,ve)):c("",!0)],64)}const Ne=k(A,[["render",Ce]]);export{Ne as default};
