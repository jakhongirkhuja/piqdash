import{C as I,P as v}from"./Pagination.b8ff8fbc.js";import{L as k}from"./LanguageSwitcher.c9c9f8e9.js";import{s as w}from"./globalFunction.5ce06618.js";import{_ as P,r as _,o as l,c as i,a as e,b as g,d as n,f as C,F as m,e as f,t as a,a2 as A,a3 as q,h as x}from"./index.34e73fda.js";const E={data(){return{imageUrl:"https://api.pharmiq.uz/files/store/",disabled:!1,modelName:"",modelUserId:"",currentPage:1,last_page:1,total:1,per_page:1,sellers:[],response:null,resError:!1,resSuccess:!1,resStringError:"",submitButton:!0,sellersearch:"",timerId:null,url:"https://api.pharmiq.uz/",loading:!0,userInfo:null}},components:{CrudButton:I,Pagination:v,LanguageSwitcher:k},computed:{},methods:{showImageUrl(s){return this.imageUrl+s},searchstore(){clearTimeout(this.timerId),this.sellersearch!=""?(this.loading=!0,this.timerId=setTimeout(()=>{this.requestApi(1,this.sellersearch)},2e3)):(this.loading=!0,this.timerId=setTimeout(()=>this.requestApi(this.currentPage),2e3))},showstore(s){this.$router.push({name:"sellers.show",params:{id:s}})},openmodel(s,d){this.modelUserId=s,this.modelName=d,this.submitButton=!0,this.resError=!1,this.resSuccess=!1,this.resStringError="",$("#exampleModal").modal("show")},showUrl(){console.log("https://api.pharmiq.uz/")},editstore(s){this.$router.push({name:"sellers.edit",params:{id:s}})},onPageChange(s){console.log(s),this.currentPage=s,this.loading=!0,this.requestApi(s),localStorage.setItem("currentPageP",s)},refreshList(){this.loading=!0,this.requestApi(1)},async requestApiDelete(){this.disabled=!0;const s={usid:this.modelUserId},d=w(),h=Object.assign(s,d);try{let u=localStorage.getItem("token");const o=await(await fetch(this.url+"api/v1/store/seller/delete/"+this.modelUserId,{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer "+u}})).json();o.error?typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message:(this.resSuccess="Successfully Deleted",this.requestApi(1),this.submitButton=!1)}catch(u){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",u)}},requestApi(s,d=null){let h=this.url+"api/v1/store/seller?page="+s,u=localStorage.getItem("token");const t={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+u})};fetch(h,t).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.response=o,this.last_page=o.last_page,this.total=o.total,this.per_page=o.per_page,this.sellers=o.data,console.log(o.data),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{this.loading=!1},1e3)})}},mounted(){this.$i18n.locale="ru"},created(){this.userInfo=JSON.parse(localStorage.getItem("user"));const s=localStorage.getItem("currentPageP");s&&(this.currentPage=parseInt(s)),this.requestApi(1)}},c=s=>(A("data-v-db1f5400"),s=s(),q(),s),N={class:"row"},B={class:"col-md-3"},L=c(()=>e("div",{class:"col-md-6"},null,-1)),T={class:"col-md-3 text-center"},U={class:"mt-3"},j={class:"row"},O={class:"col-12"},D={class:"table-responsive"},z={class:"table"},M=c(()=>e("thead",{class:"thead-dark"},[e("tr",null,[e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Phone"),e("th",{scope:"col"},"Role"),e("th",{scope:"col"},"Store"),e("th",{scope:"col"},"Telegram"),e("th",{scope:"col"},"Actions")])],-1)),V={key:0},F={key:0},J=c(()=>e("a",{href:"tg://user?id={{seller.telegram.telegram_id}}",target:"_blank"},"Open telegram",-1)),R=[J],G={class:"actions"},H=["onClick"],K=c(()=>e("i",{class:"ti ti-eye","data-toggle":"tooltip",title:"Show"},null,-1)),Q=[K],W=["onClick"],X=c(()=>e("i",{class:"ti ti-pencil-alt","data-toggle":"tooltip",title:"Edit"},null,-1)),Y=[X],Z=["onClick"],ee=c(()=>e("i",{class:"ti ti-trash","data-toggle":"tooltip",title:"Edit"},null,-1)),te=[ee],se={class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},oe={class:"modal-dialog",role:"document"},re={class:"modal-content"},le=c(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Delete store"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"\xD7")])],-1)),ie={class:"modal-body text-center"},ne={class:"error"},ae={key:1,class:"error"},ce={key:2,class:"success"},de=c(()=>e("h4",null,"Are you sure you want to delete this store?",-1)),ue={class:"modal-footer"},he=c(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Close",-1)),pe=["disabled"],_e={key:0,class:"loading"},me=c(()=>e("img",{src:x},null,-1)),ge=[me];function fe(s,d,h,u,t,o){const b=_("CrudButton"),S=_("LanguageSwitcher"),y=_("Pagination");return l(),i(m,null,[e("div",N,[e("div",B,[t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(l(),g(b,{key:0,urlName:"sellers.add",btnName:"Add Seller"})):n("",!0)]),L,e("div",T,[C(S)])]),e("div",U,[e("div",j,[e("div",O,[e("div",D,[e("table",z,[M,e("tbody",null,[(l(!0),i(m,null,f(t.sellers,r=>(l(),i("tr",{key:r.id},[e("td",null,a(r.sellerName),1),e("td",null,a("+"+r.sellerPhone.substring(0,3)+" ( "+r.sellerPhone.substring(3,5)+" ) "+r.sellerPhone.substring(5,8)+"-"+r.sellerPhone.substring(8,10)+"-"+r.sellerPhone.substring(10,12)),1),e("td",null,a(r.role?"Store Owner":"Seller"),1),e("td",null,[r.seller_store_list&&r.seller_store_list.store?(l(),i("span",V,a(r.seller_store_list.store.storeName),1)):n("",!0)]),e("td",null,[r.telegram?(l(),i("span",F,R)):n("",!0)]),e("td",G,[e("div",{onClick:p=>o.showstore(r.id),class:"show text-primary mr-2 cursor-pointer"},Q,8,H),t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(l(),i("div",{key:0,onClick:p=>o.editstore(r.id),class:"edit mr-2 cursor-pointer"},Y,8,W)):n("",!0),t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(l(),i("div",{key:1,"data-toggle":"modal","data-target":"#exampleModal cursor-pointer",onClick:p=>o.openmodel(r.id,r.sellerName),class:"delete text-danger"},te,8,Z)):n("",!0)])]))),128))])])]),t.last_page!=1?(l(),g(y,{key:0,"total-pages":this.last_page,total:this.total,"per-page":this.per_page,"current-page":t.currentPage,onPagechanged:o.onPageChange},null,8,["total-pages","total","per-page","current-page","onPagechanged"])):n("",!0)])])]),e("div",se,[e("div",oe,[e("div",re,[le,e("div",ie,[t.resError?(l(!0),i(m,{key:0},f(t.resError,(r,p)=>(l(),i("p",ne,a(p)+" : "+a(r[0]),1))),256)):n("",!0),t.resStringError?(l(),i("p",ae,a(t.resStringError),1)):n("",!0),t.resSuccess?(l(),i("p",ce,a(t.resSuccess),1)):n("",!0),de,e("h4",null,a(t.modelName),1),e("p",null,"storeId: "+a(t.modelUserId),1)]),e("div",ue,[he,t.submitButton?(l(),i("button",{key:0,disabled:t.disabled,type:"button",onClick:d[0]||(d[0]=(...r)=>o.requestApiDelete&&o.requestApiDelete(...r)),class:"btn btn-primary"},"Delete store",8,pe)):n("",!0)])])])]),t.loading?(l(),i("div",_e,ge)):n("",!0)],64)}const ve=P(E,[["render",fe],["__scopeId","data-v-db1f5400"]]);export{ve as default};
