import{G as E}from"./GoBackButton.8ec57f12.js";import{c as I}from"./vue-datepicker.es.17b3f44e.js";import{h as T}from"./maska.esm.cd315c5a.js";import{u as D,r as g,m as z}from"./index.esm.b21b73c4.js";import{_ as U,r as w,o as a,c as n,f as v,a as r,F as p,e as h,d as f,t as u,l as x,w as k,v as y,n as S,a2 as N,a3 as R}from"./index.34e73fda.js";import{s as V}from"./globalFunction.5ce06618.js";import{C as L,a as j}from"./ckeditor.713c8e1a.js";import"./_commonjsHelpers.712cc82f.js";import"./vue.runtime.esm-bundler.cd7c4a87.js";const B={setup(){return{v$:D()}},directives:{maska:T},components:{GoBackButton:E,Datepicker:I,ckeditor:L.component},data(){return{url:"https://api.pharmiq.uz/",banner_ru:[],banner_ru_prev:[],banner_uz:[],banner_uz_prev:[],title_ru:"",title_uz:"",video_ru:"",video_uz:"",video_ru_length:0,video_uz_length:0,body_ru:"",startDate:null,endDate:null,body_uz:"",news:[],order:1,added:!1,resError:!1,checkEditorEror:!1,checkEditorok:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:null,course_id:2,editor:j,editorData_ru:"",editorData_uz:"",disableClick:[],addEditor:!1,addTag:!1,addImg:!1,contents:[],content_order:1,editorConfig:{}}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{title_ru:{required:g,minLengthValue:z(3)},title_uz:{required:g,minLengthValue:z(3)},editorData_ru:{required:g},editorData_uz:{required:g}}},methods:{addingEditor(){this.addEditor=!0,this.addTag=!1,this.addImg=!1},addingTag(){this.addTag=!0,this.addEditor=!1,this.addImg=!1},addingImg(){this.addImg=!0,this.addTag=!1,this.addEditor=!1},uploadFileImageRu(o,e){var l=o.target.files||o.dataTransfer.files;!l.length||(this.banner_ru[e]=l[0],this.banner_ru_prev[e]=URL.createObjectURL(l[0]))},uploadFileImageUz(o,e){var l=o.target.files||o.dataTransfer.files;!l.length||(this.banner_uz[e]=l[0],this.banner_uz_prev[e]=URL.createObjectURL(l[0]))},uploadFilebannerRu(o){var e=o.target.files||o.dataTransfer.files;!e.length||(this.banner_ru=e[0],this.banner_ru_prev=URL.createObjectURL(e[0]))},uploadFilebannerUz(o){var e=o.target.files||o.dataTransfer.files;!e.length||(this.banner_uz=e[0],this.banner_uz_prev=URL.createObjectURL(e[0]))},getNews(){let o=this.url+"api/v1/news?id="+this.$route.params.id,e=localStorage.getItem("token");const l={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(o,l).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{console.log(s),this.banner_ru_prev="https://api.pharmiq.uz/files/news/"+s.banner,this.course_id=s.course_id,this.title_ru=JSON.parse(s.title).ru,this.title_uz=JSON.parse(s.title).uz,this.editorData_ru=JSON.parse(s.content).ru,this.editorData_uz=JSON.parse(s.content).uz})},async requestApi(){const o={title_ru:this.title_ru,title_uz:this.title_uz,content_ru:this.editorData_ru,content_uz:this.editorData_uz,postedDate:new Date().toISOString().replace("T"," ")},e=V(),l=Object.assign(o,e);var s=new FormData;this.banner_ru.length!=0&&s.append("banner",this.banner_ru);for(const t in l)s.append(t,l[t]);try{let t=localStorage.getItem("token");const _=await fetch(this.url+"api/v1/news/edit/"+this.$route.params.id,{method:"POST",body:s,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+t}}),c=await _.json();window.scrollTo({top:0,behavior:"smooth"}),_.status==401?this.resStringError=c.message:c.error?typeof c.message=="object"?this.resError=c.message:this.resStringError=c.message:(this.added=!0,this.resSuccess="News Successfully Updated")}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getNews()}},m=o=>(N("data-v-1820ae14"),o=o(),R(),o),C={class:"mt-3"},O={class:"row"},F={class:"col-md-12 grid-margin stretch-card"},q={class:"card"},A={class:"card-body"},G=m(()=>r("h4",{class:"card-title"},"Edit News",-1)),J={class:"error"},Z={key:1,class:"error"},M={key:2,class:"success"},$={class:"form-group row"},H={class:"col-md-12"},K=m(()=>r("label",{class:"col-sm-3 col-form-label",for:"banner"},"Banner",-1)),P=["src"],Q={class:"form-group row"},W={class:"col-md-6"},X=m(()=>r("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),Y={class:"col-md-6"},ee=m(()=>r("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),te={class:"form-group row"},re={class:"col-md-6"},se=m(()=>r("label",{for:"exampleInputTitleRu"},"Text (\u0420\u0423)",-1)),oe={class:"col-md-6"},ie=m(()=>r("label",{for:"exampleInputTitleUZ"},"Text (UZ)",-1)),ae=["disabled"];function ne(o,e,l,s,t,_){const c=w("GoBackButton"),b=w("ckeditor");return a(),n(p,null,[v(c),r("div",C,[r("div",O,[r("div",F,[r("div",q,[r("div",A,[G,t.resError?(a(!0),n(p,{key:0},h(t.resError,(i,d)=>(a(),n("p",J,u(d)+" : "+u(i[0]),1))),256)):f("",!0),t.resStringError?(a(),n("p",Z,u(t.resStringError),1)):f("",!0),t.resSuccess?(a(),n("p",M,u(t.resSuccess),1)):f("",!0),r("form",{class:"forms-sample",onSubmit:e[5]||(e[5]=x(i=>_.submitForm(),["prevent"]))},[r("div",$,[r("div",H,[K,t.banner_ru_prev?(a(),n("img",{key:0,src:t.banner_ru_prev,class:"image_prev",width:"250"},null,8,P)):f("",!0),r("input",{type:"file",id:"banner",onChange:e[0]||(e[0]=i=>_.uploadFilebannerRu(i)),accept:"image/*",class:"form-control"},null,32)])]),r("div",Q,[r("div",W,[X,k(r("input",{type:"text",class:S(["form-control",{"border border-danger":s.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":e[1]||(e[1]=i=>t.title_ru=i)},null,2),[[y,t.title_ru]]),(a(!0),n(p,null,h(s.v$.title_ru.$errors,(i,d)=>(a(),n("small",{class:"error",key:d},u(i.$message),1))),128))]),r("div",Y,[ee,k(r("input",{type:"text",class:S(["form-control",{"border border-danger":s.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":e[2]||(e[2]=i=>t.title_uz=i)},null,2),[[y,t.title_uz]]),(a(!0),n(p,null,h(s.v$.title_uz.$errors,(i,d)=>(a(),n("small",{class:"error",key:d},u(i.$message),1))),128))])]),r("div",te,[r("div",re,[se,v(b,{editor:t.editor,modelValue:t.editorData_ru,"onUpdate:modelValue":e[3]||(e[3]=i=>t.editorData_ru=i),config:t.editorConfig},null,8,["editor","modelValue","config"]),(a(!0),n(p,null,h(s.v$.editorData_ru.$errors,(i,d)=>(a(),n("small",{class:"error",key:d},u(i.$message),1))),128))]),r("div",oe,[ie,v(b,{editor:t.editor,modelValue:t.editorData_uz,"onUpdate:modelValue":e[4]||(e[4]=i=>t.editorData_uz=i),config:t.editorConfig},null,8,["editor","modelValue","config"]),(a(!0),n(p,null,h(s.v$.editorData_uz.$errors,(i,d)=>(a(),n("small",{class:"error",key:d},u(i.$message),1))),128))])]),t.added?f("",!0):(a(),n("button",{key:0,type:"submit",disabled:_.isDisabled,class:"btn btn-primary mr-2"},"Edit",8,ae))],32)])])])])])],64)}const ge=U(B,[["render",ne],["__scopeId","data-v-1820ae14"]]);export{ge as default};
