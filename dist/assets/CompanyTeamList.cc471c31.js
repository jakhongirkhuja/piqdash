import{C as I,P as v}from"./Pagination.b8ff8fbc.js";import{L as w}from"./LanguageSwitcher.c9c9f8e9.js";import{s as S}from"./globalFunction.5ce06618.js";import{_ as k,r as _,o as r,c as n,a as e,b as g,d,t as l,F as h,e as y,a2 as T,a3 as C,h as x}from"./index.34e73fda.js";const A={data(){return{imageUrl:"https://api.pharmiq.uz/files/team/",disabled:!1,modelName:"",modelUserId:"",currentPage:1,last_page:1,total:1,per_page:1,teams:[],response:null,resError:!1,resSuccess:!1,resStringError:"",submitButton:!0,teamsearch:"",timerId:null,url:"https://api.pharmiq.uz/",loading:!0,companyName:"",companyId:null,userInfo:null}},components:{CrudButton:I,Pagination:v,LanguageSwitcher:w},computed:{},methods:{checkStatus(s,a){let c=new Date(s);return a&&new Date>a?"Arxived":c>new Date?(console.log(c,new Date),"upgoing"):(c<=new Date,"ongoing")},showImageUrl(s){return this.imageUrl+s},searchteam(){clearTimeout(this.timerId),this.teamsearch!=""?(this.loading=!0,this.timerId=setTimeout(()=>{this.requestApi(1,this.teamsearch)},2e3)):(this.loading=!0,this.timerId=setTimeout(()=>this.requestApi(this.currentPage),2e3))},showteam(s){this.$router.push({name:"companyTeams.show",params:{team_id:s}})},openmodel(s,a){this.modelUserId=s,this.modelName=a,this.submitButton=!0,this.resError=!1,this.resSuccess=!1,this.resStringError="",$("#exampleModal").modal("show")},showUrl(){console.log("https://api.pharmiq.uz/")},editteam(s){this.$router.push({name:"companyTeams.edit",params:{team_id:s}})},onPageChange(s){console.log(s),this.currentPage=s,this.loading=!0,this.requestApi(s),localStorage.setItem("currentPage",s)},refreshList(){this.loading=!0,this.requestApi(1)},async requestApiDelete(){this.disabled=!0;const s={usid:this.modelUserId,team_id:this.modelUserId},a=S(),c=Object.assign(s,a);try{let u=localStorage.getItem("token");console.log(this.modelUserId);const o=await(await fetch(this.url+"api/v1/company/team/delete/",{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer "+u}})).json();o.error?typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message:(this.resSuccess="Successfully Deleted",this.disabled=!1,this.requestApi(1),this.submitButton=!1)}catch(u){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",u)}},requestApi(s,a=null){let c=this.url+"api/v1/company/team/show/"+this.$route.params.company_id+"?page="+s;a&&(c=this.url+"api/v1/company/team/show?page=1&search="+a);let u=localStorage.getItem("token");const t={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+u})};fetch(c,t).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{o.company&&(this.companyName=o.company.companyName,this.companyId=o.company.id),o.companyTeams&&(this.response=o.companyTeams,this.last_page=o.companyTeams.last_page,this.total=o.companyTeams.total,this.per_page=o.companyTeams.per_page,this.teams=o.companyTeams.data),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{this.loading=!1},1e3)})}},mounted(){this.$i18n.locale="ru"},created(){this.userInfo=JSON.parse(localStorage.getItem("user"));const s=localStorage.getItem("currentPage");s&&(this.currentPage=parseInt(s)),this.requestApi(1)}},m=s=>(T("data-v-844ec45c"),s=s(),C(),s),P={class:"row"},N={class:"col-md-6"},q={class:"col-md-6 text-right",style:{"padding-top":"10px"}},B=m(()=>e("div",{class:"col-md-3 text-center"},null,-1)),E={class:"mt-3"},D={class:"row"},U={class:"col-12"},j={class:"table-responsive"},L={class:"table"},O=m(()=>e("thead",{class:"thead-dark"},[e("tr",null,[e("th",{scope:"col"},"Team Name (Employee)"),e("th",{scope:"col"},"Team Type"),e("th",{scope:"col"},"Actions")])],-1)),z={class:"actions"},M=["onClick"],F=m(()=>e("i",{class:"ti ti-eye","data-toggle":"tooltip",title:"Show"},null,-1)),J=[F],V=["onClick"],G=m(()=>e("i",{class:"ti ti-pencil-alt","data-toggle":"tooltip",title:"Edit"},null,-1)),H=[G],R=["onClick"],K=m(()=>e("i",{class:"ti ti-trash","data-toggle":"tooltip",title:"Delete"},null,-1)),Q=[K],W={class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},X={class:"modal-dialog",role:"document"},Y={class:"modal-content"},Z=m(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Delete team"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"\xD7")])],-1)),ee={class:"modal-body text-center"},te={class:"error"},se={key:1,class:"error"},oe={key:2,class:"success"},re=m(()=>e("h4",null,"Are you sure you want to delete this team?",-1)),ae={class:"modal-footer"},ie=m(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Close",-1)),ne=["disabled"],le={key:0,class:"loading"},ce=m(()=>e("img",{src:x},null,-1)),de=[ce];function me(s,a,c,u,t,o){const f=_("CrudButton"),b=_("Pagination");return r(),n(h,null,[e("div",P,[e("div",N,[t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")&&t.companyId?(r(),g(f,{key:0,urlName:"companyTeams.add",btnName:"Add Team"})):d("",!0)]),e("div",q,l(t.companyName),1),B]),e("div",E,[e("div",D,[e("div",U,[e("div",j,[e("table",L,[O,e("tbody",null,[(r(!0),n(h,null,y(t.teams,i=>(r(),n("tr",{key:i.id},[e("td",null,l(i.teamName)+" ("+l(i.company_team_list.length)+")",1),e("td",null,l(i.teamType?"Special":"Branch"),1),e("td",z,[e("div",{onClick:p=>o.showteam(i.id),class:"show text-primary mr-2 cursor-pointer"},J,8,M),t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(r(),n("div",{key:0,onClick:p=>o.editteam(i.id),class:"edit mr-2 cursor-pointer"},H,8,V)):d("",!0),t.userInfo&&(t.userInfo.role=="Creator"||t.userInfo.role=="Owner")?(r(),n("div",{key:1,"data-toggle":"modal","data-target":"#exampleModal cursor-pointer",onClick:p=>o.openmodel(i.id,i.teamName),class:"delete text-danger"},Q,8,R)):d("",!0)])]))),128))])])]),t.last_page!=1?(r(),g(b,{key:0,"total-pages":this.last_page,total:this.total,"per-page":this.per_page,"current-page":t.currentPage,onPagechanged:o.onPageChange},null,8,["total-pages","total","per-page","current-page","onPagechanged"])):d("",!0)])])]),e("div",W,[e("div",X,[e("div",Y,[Z,e("div",ee,[t.resError?(r(!0),n(h,{key:0},y(t.resError,(i,p)=>(r(),n("p",te,l(p)+" : "+l(i[0]),1))),256)):d("",!0),t.resStringError?(r(),n("p",se,l(t.resStringError),1)):d("",!0),t.resSuccess?(r(),n("p",oe,l(t.resSuccess),1)):d("",!0),re,e("h4",null,l(t.modelName),1),e("p",null,"teamId: "+l(t.modelUserId),1)]),e("div",ae,[ie,t.submitButton?(r(),n("button",{key:0,disabled:t.disabled,type:"button",onClick:a[0]||(a[0]=(...i)=>o.requestApiDelete&&o.requestApiDelete(...i)),class:"btn btn-primary"},"Delete team",8,ne)):d("",!0)])])])]),t.loading?(r(),n("div",le,de)):d("",!0)],64)}const ge=k(A,[["render",me],["__scopeId","data-v-844ec45c"]]);export{ge as default};
