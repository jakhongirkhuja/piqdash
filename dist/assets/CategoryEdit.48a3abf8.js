import{G as I}from"./GoBackButton.8ec57f12.js";import{c as k}from"./vue-datepicker.es.17b3f44e.js";import{h as w}from"./maska.esm.cd315c5a.js";import{u as U,r as v,m as y,a as b}from"./index.esm.b21b73c4.js";import{_ as E,r as x,o as c,c as n,f as N,a as t,F as h,e as g,d,t as _,l as T,w as f,p as C,v as z,n as S,a2 as L,a3 as B}from"./index.34e73fda.js";import{s as V}from"./globalFunction.5ce06618.js";const j={setup(){return{v$:U()}},directives:{maska:w},components:{GoBackButton:I,Datepicker:k},data(){return{url:"https://api.pharmiq.uz/",icon_ru:[],access:0,icon_ru_prev:null,icon_uz:[],icon_uz_prev:null,title_ru:"",title_uz:"",added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{title_ru:{required:v,minLengthValue:y(3),maxLengthValue:b(30)},title_uz:{required:v,minLengthValue:y(3),maxLengthValue:b(30)}}},methods:{checkAccess(i){this.access=i.target.value},uploadFileIconRu(i){var e=i.target.files||i.dataTransfer.files;!e.length||(this.icon_ru=e[0],this.icon_ru_prev=URL.createObjectURL(e[0]))},uploadFileIconUz(i){var e=i.target.files||i.dataTransfer.files;!e.length||(this.icon_uz=e[0],this.icon_uz_prev=URL.createObjectURL(e[0]))},async requestApi(){const i={categoryName_ru:this.title_ru,categoryName_uz:this.title_uz,access:this.access},e=V(),p=Object.assign(i,e);var o=new FormData;console.log(this.icon_ru.length!=0),this.icon_ru.length!=0&&o.append("categoryIcon_ru",this.icon_ru),this.icon_uz.length!=0&&o.append("categoryIcon_uz",this.icon_uz);for(const s in p)o.append(s,p[s]);try{let s=localStorage.getItem("token");const a=await fetch(this.url+"api/v1/course/category/editNew/"+this.$route.params.id,{method:"POST",body:o,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+s}}),u=await a.json();window.scrollTo({top:0,behavior:"smooth"}),a.status==401?this.resStringError=u.message:u.error?typeof u.message=="object"?this.resError=u.message:this.resStringError=u.message:(this.added=!0,this.resSuccess="Course Successfully Updated")}catch(s){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",s)}},getCategoryInfo(){let i=this.url+"api/v1/course/category?category_id="+this.$route.params.id,e=localStorage.getItem("token");const p={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(i,p).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.access=o.access?1:0,this.title_ru=JSON.parse(o.categoryName).ru,this.title_uz=JSON.parse(o.categoryName).uz,this.icon_ru_prev=this.url+"files/category/"+JSON.parse(o.categoryIcon).ru,this.icon_uz_prev=this.url+"files/category/"+JSON.parse(o.categoryIcon).uz})},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getCategoryInfo()}},l=i=>(L("data-v-e3332a0e"),i=i(),B(),i),A={class:"mt-3"},F={class:"row"},O={class:"col-md-12 grid-margin stretch-card"},R={class:"card"},q={class:"card-body"},D=l(()=>t("h4",{class:"card-title"},"Edit category",-1)),G={class:"error"},J={key:1,class:"error"},Z={key:2,class:"success"},M={class:"form-group row"},P={class:"col-md-12"},H=l(()=>t("label",{class:"col-sm-3",for:"banner"},"Access",-1)),K=l(()=>t("option",{selected:"",value:"0"},"Public",-1)),Q=l(()=>t("option",{value:"1"},"Private",-1)),W=[K,Q],X={class:"col-md-6"},Y=l(()=>t("label",{class:"col-sm-3 col-form-label",for:"icon"},"Icon (\u0420\u0423)",-1)),$=["src"],ee={class:"col-md-6"},te=l(()=>t("label",{class:"col-sm-3 col-form-label",for:"icon"},"Icon (UZ)",-1)),se=["src"],re={class:"form-group row"},oe={class:"col-md-6"},ie=l(()=>t("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),ce={class:"col-md-6"},ne=l(()=>t("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),ae=["disabled"];function le(i,e,p,o,s,a){const u=x("GoBackButton");return c(),n(h,null,[N(u),t("div",A,[t("div",F,[t("div",O,[t("div",R,[t("div",q,[D,s.resError?(c(!0),n(h,{key:0},g(s.resError,(r,m)=>(c(),n("p",G,_(m)+" : "+_(r[0]),1))),256)):d("",!0),s.resStringError?(c(),n("p",J,_(s.resStringError),1)):d("",!0),s.resSuccess?(c(),n("p",Z,_(s.resSuccess),1)):d("",!0),t("form",{class:"forms-sample",onSubmit:e[6]||(e[6]=T(r=>a.submitForm(),["prevent"]))},[t("div",M,[t("div",P,[H,f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.access=r),onChange:e[1]||(e[1]=(...r)=>a.checkAccess&&a.checkAccess(...r)),class:"form-control"},W,544),[[C,s.access]])]),t("div",X,[Y,s.icon_ru_prev?(c(),n("img",{key:0,src:s.icon_ru_prev,class:"image_prev"},null,8,$)):d("",!0),t("input",{type:"file",id:"icon",onChange:e[2]||(e[2]=r=>a.uploadFileIconRu(r)),accept:"image/*",class:"form-control"},null,32)]),t("div",ee,[te,s.icon_uz_prev?(c(),n("img",{key:0,src:s.icon_uz_prev,class:"image_prev"},null,8,se)):d("",!0),t("input",{type:"file",id:"icon",onChange:e[3]||(e[3]=r=>a.uploadFileIconUz(r)),accept:"image/*",class:"form-control"},null,32)])]),t("div",re,[t("div",oe,[ie,f(t("input",{type:"text",class:S(["form-control",{"border border-danger":o.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":e[4]||(e[4]=r=>s.title_ru=r)},null,2),[[z,s.title_ru]]),(c(!0),n(h,null,g(o.v$.title_ru.$errors,(r,m)=>(c(),n("small",{class:"error",key:m},_(r.$message),1))),128))]),t("div",ce,[ne,f(t("input",{type:"text",class:S(["form-control",{"border border-danger":o.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":e[5]||(e[5]=r=>s.title_uz=r)},null,2),[[z,s.title_uz]]),(c(!0),n(h,null,g(o.v$.title_uz.$errors,(r,m)=>(c(),n("small",{class:"error",key:m},_(r.$message),1))),128))])]),s.added?d("",!0):(c(),n("button",{key:0,type:"submit",disabled:a.isDisabled,class:"btn btn-primary mr-2"},"Edit",8,ae))],32)])])])])])],64)}const ge=E(j,[["render",le],["__scopeId","data-v-e3332a0e"]]);export{ge as default};
