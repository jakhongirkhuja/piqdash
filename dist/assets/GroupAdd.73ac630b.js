import{G as v}from"./GoBackButton.8ec57f12.js";import{u as S,r as y}from"./index.esm.b21b73c4.js";import{s as f}from"./globalFunction.5ce06618.js";import{_ as b,r as w,o as l,c as u,f as k,a as n,F as h,e as _,d as p,t as d,l as j,w as I,v as A,n as E,a2 as T,a3 as B}from"./index.34e73fda.js";const z={setup(){return{v$:S()}},components:{GoBackButton:v},data(){return{url:"https://api.pharmiq.uz/",name:"",startDate:null,endDate:null,body_uz:"",courses:[],order:1,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:null,course_id:2}},computed:{isDisabled:function(){if(this.v$.$touch(),console.log(this.v$.$touch()),this.v$.$error)return!0}},validations(){return{name:{required:y}}},methods:{getCourses(r,a=null){let i=this.url+"api/v1/course?page="+r;a&&(i=this.url+"api/v1/course?page=1&search="+a);let s=localStorage.getItem("token");const e={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(i,e).then(t=>(t.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),t.json())).then(t=>{this.courses=t.data})},async requestApi(){const r={groupName:this.name},a=f(),i=Object.assign(r,a);var s=new FormData;for(const e in i)s.append(e,i[e]);try{let e=localStorage.getItem("token");const t=await fetch(this.url+"api/v1/groups",{method:"POST",body:s,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+e}}),o=await t.json();window.scrollTo({top:0,behavior:"smooth"}),t.status==401?this.resStringError=o.message:o.error?typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message:(this.added=!0,this.resSuccess="Group Successfully Added",this.requestApiT(o.group_id))}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",e)}},async requestApiT(r){let a={group_id:r,gender:"all",ageRange:"all",roleList:"all"};const i=f(),s=Object.assign(a,i);var e=new FormData;for(const t in s)e.append(t,s[t]);try{const t=await fetch(this.url+"api/v1/targetFilter/add",{method:"POST",body:e,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}),o=await t.json();window.scrollTo({top:0,behavior:"smooth"}),t.status==401?(this.resStringError=o.message,this.added=!1):o.error?(typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message,this.added=!1):setTimeout(()=>{this.$router.push({name:"groups.edit",params:{id:r}})},2e3)}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)},getcourses(){let r=this.url+"api/v1/course/course?page=1",a=localStorage.getItem("token");const i={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+a})};fetch(r,i).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{this.courses=s.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user"))}},g=r=>(T("data-v-f6038459"),r=r(),B(),r),G={class:"mt-3"},q={class:"row"},$={class:"col-md-12 grid-margin stretch-card"},x={class:"card"},D={class:"card-body"},C=g(()=>n("h4",{class:"card-title"},"Add Group",-1)),F={class:"error"},N={key:1,class:"error"},O={key:2,class:"success"},R=g(()=>n("div",{class:"form-group row"},null,-1)),U={class:"form-group row"},V={class:"col-md-12"},L=g(()=>n("label",{for:"exampleInputTitleRu"},"Group Name",-1)),H=["disabled"];function M(r,a,i,s,e,t){const o=w("GoBackButton");return l(),u(h,null,[k(o),n("div",G,[n("div",q,[n("div",$,[n("div",x,[n("div",D,[C,e.resError?(l(!0),u(h,{key:0},_(e.resError,(c,m)=>(l(),u("p",F,d(m)+" : "+d(c[0]),1))),256)):p("",!0),e.resStringError?(l(),u("p",N,d(e.resStringError),1)):p("",!0),e.resSuccess?(l(),u("p",O,d(e.resSuccess),1)):p("",!0),n("form",{class:"forms-sample",onSubmit:a[1]||(a[1]=j(c=>t.submitForm(),["prevent"]))},[R,n("div",U,[n("div",V,[L,I(n("input",{type:"text",class:E(["form-control",{"border border-danger":s.v$.name.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":a[0]||(a[0]=c=>e.name=c)},null,2),[[A,e.name]]),(l(!0),u(h,null,_(s.v$.name.$errors,(c,m)=>(l(),u("small",{class:"error",key:m},d(c.$message),1))),128))])]),e.added?p("",!0):(l(),u("button",{key:0,type:"submit",disabled:t.isDisabled,class:"btn btn-primary mr-2"},"Create",8,H))],32)])])])])])],64)}const W=b(z,[["render",M],["__scopeId","data-v-f6038459"]]);export{W as default};
