import{G as x}from"./GoBackButton.8ec57f12.js";import{c as w}from"./vue-datepicker.es.17b3f44e.js";import{h as T}from"./maska.esm.cd315c5a.js";import{u as z,r as b,m as k,b as S}from"./index.esm.b21b73c4.js";import{_ as U,r as D,o as n,c as l,f as V,a as t,F as c,e as p,d as g,t as u,l as B,w as m,v as y,n as _,p as I,a2 as j,a3 as E}from"./index.34e73fda.js";import{s as R}from"./globalFunction.5ce06618.js";const A={setup(){return{v$:z()}},directives:{maska:T},components:{GoBackButton:x,Datepicker:w},data(){return{url:"https://api.pharmiq.uz/",hideGroups:!1,group_id:null,groups:[],newspage:"",banner_ru:[],banner_ru_prev:null,banner_uz:[],mobileNotificationIsActive:!1,banner_uz_prev:null,title_ru:"",title_uz:"",body_ru:"",startDate:null,endDate:null,body_uz:"",categories:[],promocode_id:null,promocodes:[],messageType:["Notification","Event","Gift","Webinar","Other"],messageTypeIndex:0,phonebook_id:null,phonebooks:[],added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,price:0,category_id:1,sendby:"inbox message to LMS"}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{phonebook_id:{required:b},startDate:{required:b},endDate:{required:b},sendby:{required:b},title_ru:{required:b,minLengthValue:k(3)},title_uz:{required:b,minLengthValue:k(3)},body_ru:{required:b,minLengthValue:k(10)},body_uz:{required:b,minLengthValue:k(10)},banner_ru:{required:S(()=>this.messageTypeIndex==this.messageType.length-1)}}},methods:{checkCategory(){this.hideGroups=!1,this.category_id=="special"&&(this.getGroups(),this.hideGroups=!0)},getGroups(){let a=this.url+"api/v1/groups?page=1",s=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(a,h).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.groups=r.data,this.groups.length>0&&(this.group_id=this.groups[0].id)})},uploadFilebannerRu(a){var s=a.target.files||a.dataTransfer.files;!s.length||(this.banner_ru=s[0],this.banner_ru_prev=URL.createObjectURL(s[0]))},uploadFilebannerUz(a){var s=a.target.files||a.dataTransfer.files;!s.length||(this.banner_uz=s[0],this.banner_uz_prev=URL.createObjectURL(s[0]))},async requestApi(){const a={messageType:this.messageType[this.messageTypeIndex],titleName_ru:this.title_ru,titleName_uz:this.title_uz,descriptionText_ru:this.body_ru,descriptionText_uz:this.body_uz,sentBy:this.sendby,newsPage:this.newspage,promocode_id:this.promocode_id?this.promocode_id:"",phonebook_id:this.phonebook_id,startDate:this.startDate.replace("T"," ")+":00",endDate:this.endDate.replace("T"," ")+":00"},s=R(),h=Object.assign(a,s);var r=new FormData;r.append("messageIcon",this.banner_ru);for(const o in h)r.append(o,h[o]);try{let o=localStorage.getItem("token");const v=await fetch(this.url+"api/v1/inbox/add",{method:"POST",body:r,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+o}}),f=await v.json();window.scrollTo({top:0,behavior:"smooth"}),v.status==401?this.resStringError=f.message:f.error?typeof f.message=="object"?this.resError=f.message:this.resStringError=f.message:this.resSuccess="Inbox Successfully Added"}catch(o){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",o)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},checkvalue(){console.log(this.startDate)},getvalue(){console.log(this.monetized)},getPromocode(){let a=this.url+"api/v1/promocode?page=1",s=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(a,h).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.promocodes=r.data})},getPhonebooks(){let a=this.url+"api/v1/groups?page=1",s=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s})};fetch(a,h).then(r=>(r.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.phonebooks=r.data})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getPromocode(),this.getPhonebooks()}},d=a=>(j("data-v-78c4f387"),a=a(),E(),a),G={class:"mt-3"},L={class:"row"},M={class:"col-md-12 grid-margin stretch-card"},q={class:"card"},N={class:"card-body"},P=d(()=>t("h4",{class:"card-title"},"Add Inbox",-1)),C={class:"error"},F={key:1,class:"error"},Z={key:2,class:"success"},O={class:"form-group row"},H={class:"col-md-6"},J=d(()=>t("label",{for:"exampleInputTitleRu"},"Title (\u0420\u0423)",-1)),W={class:"col-md-6"},K=d(()=>t("label",{for:"exampleInputTitleUZ"},"Title (UZ)",-1)),Q={class:"form-group row"},X={class:"col-md-6"},Y=d(()=>t("label",{for:"exampleInputbodyRu"},"Body (\u0420\u0423)",-1)),$={class:"col-md-6"},ee=d(()=>t("label",{for:"exampleInputbodyUZ"},"Body (UZ)",-1)),oe={class:"form-group row"},te={class:"col-md-6"},se=d(()=>t("label",{class:"col-sm-3",for:"banner"},"Send By",-1)),re=d(()=>t("option",{value:"inbox message to LMS"},"Inbox message to LMS",-1)),ne=d(()=>t("option",{value:"Mobile notification"},"Mobile notification",-1)),le=[re,ne],ie={key:0,class:"col-md-6"},ae=d(()=>t("label",{class:"col-sm-4",for:"messageType"},"Message Type",-1)),de=["value"],ue=d(()=>t("label",{class:"col-sm-4",for:"banner"},"Message Icon",-1)),ce=["src"],pe={class:"form-group row"},me={class:"col-md-6"},_e=d(()=>t("label",{for:"exampleInputstartRu"},"Start Date",-1)),he={class:"col-md-6"},ge=d(()=>t("label",{for:"exampleInputendUZ"},"End Date ",-1)),be={class:"form-group row"},fe={key:0,class:"col-md-6"},ye=d(()=>t("label",{class:"col-sm-12",for:"banner"},"PromoCode",-1)),ve=d(()=>t("option",{value:"0"},"Please select one if need",-1)),ke=["value"],Ie=d(()=>t("label",{class:"col-sm-12",for:"banner"},"Group",-1)),xe=d(()=>t("option",{disabled:""},"Please select one",-1)),we=["value"],Te={key:0,class:"form-group row"},ze={class:"col-md-12"},Se=d(()=>t("label",{for:"exampleInputTitleRu"},"NewsPage Exp( https://pharmiq.uz/ )",-1)),Ue=["disabled"];function De(a,s,h,r,o,v){const f=D("GoBackButton");return n(),l(c,null,[V(f),t("div",G,[t("div",L,[t("div",M,[t("div",q,[t("div",N,[P,o.resError?(n(!0),l(c,{key:0},p(o.resError,(e,i)=>(n(),l("p",C,u(i)+" : "+u(e[0]),1))),256)):g("",!0),o.resStringError?(n(),l("p",F,u(o.resStringError),1)):g("",!0),o.resSuccess?(n(),l("p",Z,u(o.resSuccess),1)):g("",!0),t("form",{class:"forms-sample",onSubmit:s[12]||(s[12]=B(e=>v.submitForm(),["prevent"]))},[t("div",O,[t("div",H,[J,m(t("input",{type:"text",class:_(["form-control",{"border border-danger":r.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":s[0]||(s[0]=e=>o.title_ru=e)},null,2),[[y,o.title_ru]]),(n(!0),l(c,null,p(r.v$.title_ru.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))]),t("div",W,[K,m(t("input",{type:"text",class:_(["form-control",{"border border-danger":r.v$.title_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":s[1]||(s[1]=e=>o.title_uz=e)},null,2),[[y,o.title_uz]]),(n(!0),l(c,null,p(r.v$.title_uz.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))])]),t("div",Q,[t("div",X,[Y,m(t("textarea",{rows:"10",type:"text",class:_(["form-control",{"border border-danger":r.v$.body_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":s[2]||(s[2]=e=>o.body_ru=e)},null,2),[[y,o.body_ru]]),(n(!0),l(c,null,p(r.v$.body_ru.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))]),t("div",$,[ee,m(t("textarea",{rows:"10",type:"text",class:_(["form-control",{"border border-danger":r.v$.body_uz.$errors.length>0}]),id:"exampleInputTitleUZ","onUpdate:modelValue":s[3]||(s[3]=e=>o.body_uz=e)},null,2),[[y,o.body_uz]]),(n(!0),l(c,null,p(r.v$.body_uz.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))])]),t("div",oe,[t("div",te,[se,m(t("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>o.sendby=e),class:_(["form-control",{"border border-danger":r.v$.sendby.$errors.length>0}])},le,2),[[I,o.sendby]]),(n(!0),l(c,null,p(r.v$.sendby.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))]),o.sendby!="Mobile notification"?(n(),l("div",ie,[ae,m(t("select",{"onUpdate:modelValue":s[5]||(s[5]=e=>o.messageTypeIndex=e),class:"form-control"},[(n(!0),l(c,null,p(o.messageType,(e,i)=>(n(),l("option",{key:i,value:i},u(e),9,de))),128))],512),[[I,o.messageTypeIndex]]),o.messageTypeIndex==o.messageType.length-1?(n(),l(c,{key:0},[ue,o.banner_ru_prev?(n(),l("img",{key:0,src:o.banner_ru_prev,class:"image_prev"},null,8,ce)):g("",!0),t("input",{type:"file",id:"banner",onChange:s[6]||(s[6]=e=>v.uploadFilebannerRu(e)),accept:"image/*",class:_([{"border border-danger":r.v$.banner_ru.$errors.length>0},"form-control"])},null,34),(n(!0),l(c,null,p(r.v$.banner_ru.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))],64)):g("",!0)])):g("",!0)]),t("div",pe,[t("div",me,[_e,m(t("input",{type:"datetime-local",class:_(["form-control",{"border border-danger":r.v$.startDate.$errors.length>0}]),id:"exampleInputstartRu","onUpdate:modelValue":s[7]||(s[7]=e=>o.startDate=e)},null,2),[[y,o.startDate]]),(n(!0),l(c,null,p(r.v$.startDate.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))]),t("div",he,[ge,m(t("input",{type:"datetime-local",class:_(["form-control",{"border border-danger":r.v$.endDate.$errors.length>0}]),id:"exampleInputendUZ","onUpdate:modelValue":s[8]||(s[8]=e=>o.endDate=e)},null,2),[[y,o.endDate]]),(n(!0),l(c,null,p(r.v$.endDate.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))])]),t("div",be,[!o.newspage&&o.sendby!="Mobile notification"?(n(),l("div",fe,[ye,m(t("select",{"onUpdate:modelValue":s[9]||(s[9]=e=>o.promocode_id=e),class:"form-control"},[ve,(n(!0),l(c,null,p(o.promocodes,e=>(n(),l("option",{key:e.id,value:e.id},u(e.promocode),9,ke))),128))],512),[[I,o.promocode_id]])])):g("",!0),t("div",{class:_({"col-md-12":o.newspage,"col-md-6":!o.newspage})},[Ie,m(t("select",{"onUpdate:modelValue":s[10]||(s[10]=e=>o.phonebook_id=e),class:_(["form-control",{"border border-danger":r.v$.phonebook_id.$errors.length>0}])},[xe,(n(!0),l(c,null,p(o.phonebooks,e=>(n(),l("option",{key:e.id,value:e.id},u(e.groupName),9,we))),128))],2),[[I,o.phonebook_id]]),(n(!0),l(c,null,p(r.v$.phonebook_id.$errors,(e,i)=>(n(),l("small",{class:"error",key:i},u(e.$message),1))),128))],2)]),!o.promocode_id&&o.sendby!="Mobile notification"?(n(),l("div",Te,[t("div",ze,[Se,m(t("input",{type:"text",placeholder:"https://pharmiq.uz/",class:"form-control",id:"exampleInputNewsPAgeRu","onUpdate:modelValue":s[11]||(s[11]=e=>o.newspage=e)},null,512),[[y,o.newspage]])])])):g("",!0),o.added?g("",!0):(n(),l("button",{key:1,type:"submit",disabled:v.isDisabled,class:"btn btn-primary mr-2"},"Create",8,Ue))],32)])])])])])],64)}const Ge=U(A,[["render",De],["__scopeId","data-v-78c4f387"]]);export{Ge as default};
