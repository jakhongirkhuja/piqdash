import{G as y}from"./GoBackButton.8ec57f12.js";import{c as q}from"./vue-datepicker.es.17b3f44e.js";import{h as k}from"./maska.esm.cd315c5a.js";import{u as S,r as w,i as v,b as A}from"./index.esm.b21b73c4.js";import{_ as T,r as L,o as t,c as o,f as B,a as r,F as d,e as u,d as g,t as a,l as E,w as f,p as z,n as h,v as b}from"./index.34e73fda.js";import{s as P}from"./globalFunction.5ce06618.js";const I={setup(){return{v$:S()}},directives:{maska:k},components:{GoBackButton:y,Datepicker:q},data(){return{url:"https://api.pharmiq.uz/",lessons:[],order:1,iqc:20,limit:8,rightAnswer:8,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,lesson_id:12,prizeLimit:10,selected:"with reward",quizType:["without reward","with reward","with limited reward"]}},computed:{isDisabled:function(){if(this.v$.$touch(),console.log(this.v$.$touch()),this.v$.$error)return!0}},validations(){return{lesson_id:{required:w},iqc:{required:w,integer:v},limit:{required:w,integer:v},rightAnswer:{required:w,integer:v},prizeLimit:{required:A(()=>this.selected=="with limited reward"),integer:v}}},methods:{onChangeQuizType(p){console.log(p.target.value),p.target.value=="without reward"&&(this.iqc=0)},async requestApi(){let i={quizz:{prizeIQC:this.iqc,timeLimits:this.limit,numberRightAnswersToPass:this.rightAnswer}};const _={lesson_id:this.lesson_id,quiz:JSON.stringify(i),type:this.selected,prizeStatus:0},n=P(),s=Object.assign(_,n);var m=new FormData;this.selected=="with limited reward"&&m.append("prizeLimit",parseInt(this.prizeLimit));for(const c in s)m.append(c,s[c]);try{let c=localStorage.getItem("token");const e=await fetch(this.url+"api/v1/quizz/add",{method:"POST",body:m,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+c}}),l=await e.json();window.scrollTo({top:0,behavior:"smooth"}),e.status==401?this.resStringError=l.message:l.error?typeof l.message=="object"?this.resError=l.message:this.resStringError=l.message:(this.added=!0,this.resSuccess="Quiz Successfully Added",this.$router.push({name:"quizzes.edit",params:{id:l.quizz.id},query:{adding:this.resSuccess}}))}catch(c){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",c)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},getLessons(){let p=this.url+"api/v1/lessons?page=1&show=all",i=localStorage.getItem("token");const _={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+i})};fetch(p,_).then(n=>(n.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),n.json())).then(n=>{this.lessons=n.data,console.log(this.lessons)})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getLessons()}},V={class:"mt-3"},C={class:"row"},N={class:"col-md-12 grid-margin stretch-card"},j={class:"card"},U={class:"card-body"},Q=r("h4",{class:"card-title"},"Add Quizz",-1),R={class:"error"},D={key:1,class:"error"},O={key:2,class:"success"},F={class:"form-group row"},G={class:"col-md-12"},x=r("label",{for:"banner"},"Lesson",-1),J=r("option",{disabled:"",value:"0"},"Please select one",-1),$=["value"],M={class:"col-md-12 mt-2"},H=r("label",{for:"QuizType"},"Type",-1),K=["value"],W={key:0,class:"col-md-4 mt-2"},X=r("label",{for:"Prizeiqc"},"Prize iqc:",-1),Y=r("label",{for:"Timelimits"},"Time limits:",-1),Z=r("label",{for:"RightAnswersToPass"},"Right answers to pass",-1),ee={key:1,class:"col-md-12 mt-2"},se=r("label",{for:"RightAnswersToPassprizeLimit"},"Prize Limit",-1),re=["disabled"];function te(p,i,_,n,s,m){const c=L("GoBackButton");return t(),o(d,null,[B(c),r("div",V,[r("div",C,[r("div",N,[r("div",j,[r("div",U,[Q,s.resError?(t(!0),o(d,{key:0},u(s.resError,(e,l)=>(t(),o("p",R,a(l)+" : "+a(e[0]),1))),256)):g("",!0),s.resStringError?(t(),o("p",D,a(s.resStringError),1)):g("",!0),s.resSuccess?(t(),o("p",O,a(s.resSuccess),1)):g("",!0),r("form",{class:"forms-sample",onSubmit:i[7]||(i[7]=E(e=>m.submitForm(),["prevent"]))},[r("div",F,[r("div",G,[x,f(r("select",{"onUpdate:modelValue":i[0]||(i[0]=e=>s.lesson_id=e),class:h(["form-control",{"border border-danger":n.v$.lesson_id.$errors.length>0}])},[J,(t(!0),o(d,null,u(s.lessons,e=>(t(),o("option",{key:e.id,value:e.id},a(JSON.parse(e.lessonTitleName).ru)+" ( "+a(JSON.parse(e.lessonTitleName).uz)+" )",9,$))),128))],2),[[z,s.lesson_id]]),(t(!0),o(d,null,u(n.v$.lesson_id.$errors,(e,l)=>(t(),o("small",{class:"error",key:l},a(e.$message),1))),128))]),r("div",M,[H,f(r("select",{class:"form-control","onUpdate:modelValue":i[1]||(i[1]=e=>s.selected=e),onChange:i[2]||(i[2]=e=>m.onChangeQuizType(e))},[(t(!0),o(d,null,u(s.quizType,(e,l)=>(t(),o("option",{value:e},a(e),9,K))),256))],544),[[z,s.selected]])]),s.selected!="without reward"?(t(),o("div",W,[X,f(r("input",{type:"number",class:h(["form-control",{"border border-danger":n.v$.iqc.$errors.length>0}]),id:"Prizeiqc","onUpdate:modelValue":i[3]||(i[3]=e=>s.iqc=e)},null,2),[[b,s.iqc]]),(t(!0),o(d,null,u(n.v$.iqc.$errors,(e,l)=>(t(),o("small",{class:"error",key:l},a(e.$message),1))),128))])):g("",!0),r("div",{class:h(["col-md-4 mt-2",{"col-md-6":s.selected=="without reward"}])},[Y,f(r("input",{type:"number",class:h(["form-control",{"border border-danger":n.v$.limit.$errors.length>0}]),id:"Timelimits","onUpdate:modelValue":i[4]||(i[4]=e=>s.limit=e)},null,2),[[b,s.limit]]),(t(!0),o(d,null,u(n.v$.limit.$errors,(e,l)=>(t(),o("small",{class:"error",key:l},a(e.$message),1))),128))],2),r("div",{class:h(["col-md-4 mt-2",{"col-md-6":s.selected=="without reward"}])},[Z,f(r("input",{type:"number",class:h(["form-control",{"border border-danger":n.v$.rightAnswer.$errors.length>0}]),id:"RightAnswersToPass","onUpdate:modelValue":i[5]||(i[5]=e=>s.rightAnswer=e)},null,2),[[b,s.rightAnswer]]),(t(!0),o(d,null,u(n.v$.rightAnswer.$errors,(e,l)=>(t(),o("small",{class:"error",key:l},a(e.$message),1))),128))],2),s.selected=="with limited reward"?(t(),o("div",ee,[se,f(r("input",{type:"number",class:h(["form-control",{"border border-danger":n.v$.prizeLimit.$errors.length>0}]),id:"RightAnswersToPassprizeLimit","onUpdate:modelValue":i[6]||(i[6]=e=>s.prizeLimit=e)},null,2),[[b,s.prizeLimit]]),(t(!0),o(d,null,u(n.v$.prizeLimit.$errors,(e,l)=>(t(),o("small",{class:"error",key:l},a(e.$message),1))),128))])):g("",!0)]),s.added?g("",!0):(t(),o("button",{key:0,type:"submit",disabled:m.isDisabled,class:"btn btn-primary mr-2"},"Create",8,re))],32)])])])])])],64)}const ue=T(I,[["render",te]]);export{ue as default};
