import{G as D}from"./GoBackButton.8ec57f12.js";import{c as w}from"./vue-datepicker.es.17b3f44e.js";import{h as S}from"./maska.esm.cd315c5a.js";import{u as k,r as v,m as I,i as x}from"./index.esm.b21b73c4.js";import{_ as U,r as z,o as n,c as i,f as T,a as e,F as m,e as f,d as b,t as d,l as E,w as u,a0 as A,v as g,n as y,a2 as B,a3 as P}from"./index.34e73fda.js";import{s as V}from"./globalFunction.5ce06618.js";const C={setup(){return{v$:k()}},directives:{maska:S},components:{GoBackButton:D,Datepicker:w},data(){return{url:"https://api.pharmiq.uz/",promo:"",price:null,startDate:null,endDate:null,added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:0,winner:null}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{startDate:{required:v},endDate:{required:v},promo:{required:v,minLengthValue:I(3)},price:{required:v,integer:x}}},methods:{async requestApi(){const c={promocode:this.promo.toUpperCase(),prizeType:this.monetized,prizeAmount:this.price,startDate:this.startDate.replace("T"," ")+":00",endDate:this.endDate.replace("T"," ")+":00",amountOfWinners:this.winner==""?null:this.winner},r=V(),h=Object.assign(c,r);var o=new FormData;for(const t in h)o.append(t,h[t]);try{let t=localStorage.getItem("token");const _=await fetch(this.url+"api/v1/promocode/edit/"+this.$route.params.id,{method:"POST",body:o,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+t}}),p=await _.json();window.scrollTo({top:0,behavior:"smooth"}),_.status==401?(this.resStringError=p.message,this.added=!1):p.error?(typeof p.message=="object"?this.resError=p.message:this.resStringError=p.message,this.added=!1):this.resSuccess="PromoCode Successfully Updated"}catch(t){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",t)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},getPromoCode(){let c=this.url+"api/v1/promocode?promo_id="+this.$route.params.id,r=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r})};fetch(c,h).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.promo=o.promocode,this.price=o.prizeAmount,this.startDate=o.startDate.slice(0,-3),this.endDate=o.endDate.slice(0,-3),this.monetized=o.prizeType,this.winner=o.amountOfWinners})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.getPromoCode()}},l=c=>(B("data-v-53f2fcce"),c=c(),P(),c),j={class:"mt-3"},q={class:"row"},R={class:"col-md-12 grid-margin stretch-card"},$={class:"card"},O={class:"card-body"},Z=l(()=>e("h4",{class:"card-title"},"Update PromoCode",-1)),F={class:"error"},G={key:1,class:"error"},L={key:2,class:"success"},M={class:"form-group row"},N=l(()=>e("div",{class:"col-md-6"},null,-1)),W={class:"col-md-6 text-right"},H=l(()=>e("label",{for:"exampleInputstartRu"},"Prize Type",-1)),J=l(()=>e("br",null,null,-1)),Q={class:"language-switcher"},K=l(()=>e("span",{class:"slider round"},null,-1)),X=l(()=>e("span",{class:"select-ru"},"iqc",-1)),Y=l(()=>e("span",{class:"select-uz"},"exp",-1)),ee={class:"form-group row"},te={class:"col-md-4"},se=l(()=>e("label",{for:"exampleInputTitleRu"},"Promocode",-1)),oe={class:"col-md-4"},re=l(()=>e("label",{for:"exampleInputTitleUZ"},"Price Amount",-1)),ne={class:"col-md-4"},ie=l(()=>e("label",{for:"exampleInputTitlewinnerUZ"},"Amount Of Winners",-1)),le={class:"form-group row"},ae={class:"col-md-6"},ce=l(()=>e("label",{for:"exampleInputstartRu"},"Start Date",-1)),de={class:"col-md-6"},pe=l(()=>e("label",{for:"exampleInputendUZ"},"End Date ",-1)),me=["disabled"];function ue(c,r,h,o,t,_){const p=z("GoBackButton");return n(),i(m,null,[T(p),e("div",j,[e("div",q,[e("div",R,[e("div",$,[e("div",O,[Z,t.resError?(n(!0),i(m,{key:0},f(t.resError,(s,a)=>(n(),i("p",F,d(a)+" : "+d(s[0]),1))),256)):b("",!0),t.resStringError?(n(),i("p",G,d(t.resStringError),1)):b("",!0),t.resSuccess?(n(),i("p",L,d(t.resSuccess),1)):b("",!0),e("form",{class:"forms-sample",onSubmit:r[6]||(r[6]=E(s=>_.submitForm(),["prevent"]))},[e("div",M,[N,e("div",W,[H,J,e("label",Q,[u(e("input",{type:"checkbox",disabled:"","onUpdate:modelValue":r[0]||(r[0]=s=>t.monetized=s)},null,512),[[A,t.monetized]]),K,X,Y])])]),e("div",ee,[e("div",te,[se,u(e("input",{type:"text",class:y(["form-control capilizie",{"border border-danger":o.v$.promo.$errors.length>0}]),placeholder:"PHARMIQ245",id:"exampleInputTitleRu","onUpdate:modelValue":r[1]||(r[1]=s=>t.promo=s)},null,2),[[g,t.promo]]),(n(!0),i(m,null,f(o.v$.promo.$errors,(s,a)=>(n(),i("small",{class:"error",key:a},d(s.$message),1))),128))]),e("div",oe,[re,u(e("input",{type:"text",class:y(["form-control",{"border border-danger":o.v$.price.$errors.length>0}]),placeholder:"100",id:"exampleInputTitleUZ","onUpdate:modelValue":r[2]||(r[2]=s=>t.price=s)},null,2),[[g,t.price]]),(n(!0),i(m,null,f(o.v$.price.$errors,(s,a)=>(n(),i("small",{class:"error",key:a},d(s.$message),1))),128))]),e("div",ne,[ie,u(e("input",{type:"number",class:"form-control",placeholder:"1",id:"exampleInputTitlewinnerUZ","onUpdate:modelValue":r[3]||(r[3]=s=>t.winner=s)},null,512),[[g,t.winner]])])]),e("div",le,[e("div",ae,[ce,u(e("input",{type:"datetime-local",class:y(["form-control",{"border border-danger":o.v$.startDate.$errors.length>0}]),id:"exampleInputstartRu","onUpdate:modelValue":r[4]||(r[4]=s=>t.startDate=s)},null,2),[[g,t.startDate]]),(n(!0),i(m,null,f(o.v$.startDate.$errors,(s,a)=>(n(),i("small",{class:"error",key:a},d(s.$message),1))),128))]),e("div",de,[pe,u(e("input",{type:"datetime-local",class:y(["form-control",{"border border-danger":o.v$.startDate.$errors.length>0}]),id:"exampleInputendUZ","onUpdate:modelValue":r[5]||(r[5]=s=>t.endDate=s)},null,2),[[g,t.endDate]]),(n(!0),i(m,null,f(o.v$.endDate.$errors,(s,a)=>(n(),i("small",{class:"error",key:a},d(s.$message),1))),128))])]),t.added?b("",!0):(n(),i("button",{key:0,type:"submit",disabled:_.isDisabled,class:"btn btn-primary mr-2"},"Update",8,me))],32)])])])])])],64)}const ye=U(C,[["render",ue],["__scopeId","data-v-53f2fcce"]]);export{ye as default};
