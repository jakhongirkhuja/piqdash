import{G as w}from"./GoBackButton.8ec57f12.js";import{c as S}from"./vue-datepicker.es.17b3f44e.js";import{h as I}from"./maska.esm.cd315c5a.js";import{u as C,r as z,m as T,b as v}from"./index.esm.b21b73c4.js";import{_ as j,a4 as B,a5 as L,r as x,o as i,c as a,f as G,a as n,t as c,F as p,e as g,d as h,l as A,w as y,v as k,n as f,a0 as E,p as b,a2 as q,a3 as U}from"./index.34e73fda.js";import{s as M}from"./globalFunction.5ce06618.js";const N={setup(){return{v$:C()}},directives:{maska:I},components:{GoBackButton:w,Datepicker:S,yandexMap:B,ymapMarker:L},data(){return{url:"https://api.pharmiq.uz/",hideGroups:!0,city_id:14,region_id:192,groups:[],companyName:"",companyId:0,banner_ru:[],banner_ru_prev:null,banner_uz:[],banner_uz_prev:null,title_ru:"",title_uz:"",body_ru:"",startDate:null,endDate:null,body_uz:"",categories:[],added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,monetized:!1,price:0,category_id:1,storeLandmark_ru:"",storeLandmark_uz:"",lat:null,long:null,cities:[],regions:[]}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{title_ru:{required:z,minLengthValue:T(5)},city_id:{required:v(()=>this.hideGroups)},region_id:{required:v(()=>this.hideGroups)},storeLandmark_ru:{required:v(()=>this.hideGroups)}}},methods:{onChangeCities(l){this.getRegions(l.target.value)},getGroups(){let l=this.url+"api/v1/groups?page=1",t=localStorage.getItem("token");const d={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(l,d).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{this.groups=e.data,this.groups.length>0&&(this.group_id=this.groups[0].id)})},getAddressByCoor(l,t){this.lat=l,this.long=t;let d=this.url+"api/v1/getAdressByCoor?lat="+l+"&long="+t,e=localStorage.getItem("token");const o={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(d,o).then(s=>(s.status==401&&(localcategoryage.removeItem("token"),localcategoryage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{console.log(s),this.storeLandmark_ru="",this.storeLandmark_uz="",s.city&&s.region.id&&(this.city_id=s.city.id,this.getRegions(14,s.region.id)),s.street||s.house?(s.street&&(this.storeLandmark_ru+=s.street),s.house&&(this.storeLandmark_ru+=" "+s.house)):(s.other&&(this.storeLandmark_ru+=" "+s.other),s.area&&(this.storeLandmark_ru+=" "+s.area))})},async requestApi(){const l={company_id:this.companyId,teamName:this.title_ru,teamType:this.monetized?1:0},t=M(),d=Object.assign(l,t);var e=new FormData;for(const o in d)e.append(o,d[o]);this.monetized==!1&&(e.append("city_id",this.city_id),e.append("region_id",this.region_id),e.append("addressType",1),e.append("addressline",this.storeLandmark_ru),this.lat&&this.long&&(e.append("latitude",this.lat),e.append("longitude",this.long)));try{let o=localStorage.getItem("token");const s=await fetch(this.url+"api/v1/company/team/create",{method:"POST",body:e,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+o}}),_=await s.json();window.scrollTo({top:0,behavior:"smooth"}),s.status==401?this.resStringError=_.message:_.error?typeof _.message=="object"?this.resError=_.message:this.resStringError=_.message:this.resSuccess="Company Team Successfully Added"}catch(o){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",o)}},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},getvalue(){this.monetized?this.hideGroups=!1:(this.hideGroups=!0,this.showmap())},getCompanyById(){let l=this.url+"api/v1/company/getCompanyId/"+this.$route.params.company_id,t=localStorage.getItem("token");const d={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(l,d).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{e!=null&&(this.companyId=e.id,this.companyName=e.companyName)})},getCities(){let l=this.url+"api/v1/show/cities",t=localStorage.getItem("token");const d={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t})};fetch(l,d).then(e=>(e.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),e.json())).then(e=>{this.cities=e})},getRegions(l,t){let d=this.url+"api/v1/show/regions/"+l,e=localStorage.getItem("token");const o={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+e})};fetch(d,o).then(s=>(s.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),s.json())).then(s=>{this.regions=s,t?this.region_id=t:this.region_id=s[0]!==void 0?s[0].id:null})},showmap(){ymaps.ready(l=>{var t=new ymaps.Map("map",{center:[41.311081,69.240562],zoom:11},{searchControlProvider:"yandex#search"});console.log(this.lat),t.events.add("click",d=>{if(t.balloon.isOpen())t.balloon.close();else{var e=d.get("coords");t.balloon.open(e,{contentBody:"<p>Coordinates: "+[e[0].toPrecision(6),e[1].toPrecision(6)].join(", ")+"</p>",contentFooter:"<sup>Click again</sup>"}),this.getAddressByCoor(e[0],e[1])}})})}},created(){this.userInfo=JSON.parse(localStorage.getItem("user")),this.$route.params.company_id==null||this.$route.params.company_id==""||(this.getCompanyById(),this.getCities(),this.getRegions(14),this.showmap())}},u=l=>(q("data-v-d73ec59d"),l=l(),U(),l),V={class:"mt-3"},R={class:"row"},D={class:"col-md-12 grid-margin stretch-card"},F={class:"card"},H={class:"card-body"},O={class:"card-title"},P={class:"error"},J={key:1,class:"error"},$={key:2,class:"success"},K=u(()=>n("div",{class:"form-group row"},null,-1)),Q={class:"form-group row"},W={class:"col-md-6"},X=u(()=>n("label",{for:"exampleInputTitleRu"},"Team Name",-1)),Y={class:"col-md-6 text-center"},Z=u(()=>n("label",{for:"exampleInputstartRu"},"Team Type",-1)),ee=u(()=>n("br",null,null,-1)),te={class:"language-switcher"},oe=u(()=>n("span",{class:"slider round"},null,-1)),se=u(()=>n("span",{class:"select-ru"},"Branch",-1)),re=u(()=>n("span",{class:"select-uz"},"Special",-1)),ne={class:"form-group row"},ie={key:0,class:"col-md-12 mt-4"},ae=u(()=>n("div",{id:"map",style:{"min-width":"95%",height:"400px",overflow:"hidden"}},null,-1)),le=[ae],de={key:0,class:"form-group row"},ce={class:"col-md-6"},ue=u(()=>n("label",{class:"col-sm-3",for:"banner"},"Cities",-1)),pe=["value"],me={class:"col-md-6"},he=u(()=>n("label",{class:"col-sm-3",for:"banner"},"Regions",-1)),_e=["value"],ge={class:"col-md-12"},ye=u(()=>n("label",{for:"exampleInputLandMark"},"Street, house",-1)),fe=["disabled"];function ve(l,t,d,e,o,s){const _=x("GoBackButton");return i(),a(p,null,[G(_),n("div",V,[n("div",R,[n("div",D,[n("div",F,[n("div",H,[n("h4",O,"Add Teams to "+c(o.companyName),1),o.resError?(i(!0),a(p,{key:0},g(o.resError,(r,m)=>(i(),a("p",P,c(m)+" : "+c(r[0]),1))),256)):h("",!0),o.resStringError?(i(),a("p",J,c(o.resStringError),1)):h("",!0),o.resSuccess?(i(),a("p",$,c(o.resSuccess),1)):h("",!0),n("form",{class:"forms-sample",onSubmit:t[7]||(t[7]=A(r=>s.submitForm(),["prevent"]))},[K,n("div",Q,[n("div",W,[X,y(n("input",{type:"text",class:f(["form-control",{"border border-danger":e.v$.title_ru.$errors.length>0}]),id:"exampleInputTitleRu","onUpdate:modelValue":t[0]||(t[0]=r=>o.title_ru=r)},null,2),[[k,o.title_ru]]),(i(!0),a(p,null,g(e.v$.title_ru.$errors,(r,m)=>(i(),a("small",{class:"error",key:m},c(r.$message),1))),128))]),n("div",Y,[Z,ee,n("label",te,[y(n("input",{onChange:t[1]||(t[1]=(...r)=>s.getvalue&&s.getvalue(...r)),type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=r=>o.monetized=r)},null,544),[[E,o.monetized]]),oe,se,re])])]),n("div",ne,[o.hideGroups?(i(),a("div",ie,le)):h("",!0)]),o.hideGroups?(i(),a("div",de,[n("div",ce,[ue,y(n("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.city_id=r),onChange:t[4]||(t[4]=r=>s.onChangeCities(r)),class:f(["form-control",{"border border-danger":e.v$.city_id.$errors.length>0}])},[(i(!0),a(p,null,g(o.cities.slice(0,14),r=>(i(),a(p,{key:r.id},[r?(i(),a("option",{key:0,value:r.id},c(r.name_ru),9,pe)):h("",!0)],64))),128))],34),[[b,o.city_id]]),(i(!0),a(p,null,g(e.v$.city_id.$errors,(r,m)=>(i(),a("small",{class:"error",key:m},c(r.$message),1))),128))]),n("div",me,[he,y(n("select",{"onUpdate:modelValue":t[5]||(t[5]=r=>o.region_id=r),class:f(["form-control",{"border border-danger":e.v$.region_id.$errors.length>0}])},[(i(!0),a(p,null,g(o.regions,r=>(i(),a("option",{key:r.id,value:r.id},c(r.name_ru),9,_e))),128))],2),[[b,o.region_id]]),(i(!0),a(p,null,g(e.v$.region_id.$errors,(r,m)=>(i(),a("small",{class:"error",key:m},c(r.$message),1))),128))]),n("div",ge,[ye,y(n("input",{type:"text",class:f(["form-control",{"border border-danger":e.v$.storeLandmark_ru.$errors.length>0}]),placeholder:"Street, house",id:"exampleInputLandMark","onUpdate:modelValue":t[6]||(t[6]=r=>o.storeLandmark_ru=r)},null,2),[[k,o.storeLandmark_ru]]),(i(!0),a(p,null,g(e.v$.storeLandmark_ru.$errors,(r,m)=>(i(),a("small",{class:"error",key:m},c(r.$message),1))),128))])])):h("",!0),o.companyId?(i(),a(p,{key:1},[o.added?h("",!0):(i(),a("button",{key:0,type:"submit",disabled:s.isDisabled,class:"btn btn-primary mr-2"},"Create",8,fe))],64)):h("",!0)],32)])])])])])],64)}const ze=j(N,[["render",ve],["__scopeId","data-v-d73ec59d"]]);export{ze as default};
