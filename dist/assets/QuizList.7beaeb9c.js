import{C as S,P as v}from"./Pagination.b8ff8fbc.js";import{L as y}from"./LanguageSwitcher.c9c9f8e9.js";import{s as q}from"./globalFunction.5ce06618.js";import{_ as w,r as _,o as l,c as n,a as e,b as g,d as u,w as k,v as C,f as A,t as a,F as p,e as f,a2 as P,a3 as T,h as N}from"./index.34e73fda.js";const E={data(){return{imageUrl:"https://api.pharmiq.uz/files/quiz/",disabled:!1,modelName:"",modelUserId:"",currentPage:1,last_page:1,total:1,per_page:1,quizzes:[],response:null,resError:!1,courseSearch:"",resSuccess:!1,resStringError:"",submitButton:!0,quizzesearch:"",timerId:null,url:"https://api.pharmiq.uz/",loading:!0,userInfo:null}},components:{CrudButton:S,Pagination:v,LanguageSwitcher:y},computed:{},methods:{searchcourse(){clearTimeout(this.timerId),this.courseSearch.length>4&&(this.loading=!0,this.timerId=setTimeout(()=>{this.requestApi(1,this.courseSearch)},2e3)),this.courseSearch==""&&(this.loading=!0,this.timerId=setTimeout(()=>this.requestApi(this.currentPage),2e3))},checkStatus(t,i){let d=new Date(t);return i&&new Date>i?"Arxived":d>new Date?(console.log(d,new Date),"upgoing"):(d<=new Date,"ongoing")},showImageUrl(t){return this.imageUrl+t},searchquiz(){clearTimeout(this.timerId),this.quizzesearch!=""?(this.loading=!0,this.timerId=setTimeout(()=>{this.requestApi(1,this.quizzesearch)},2e3)):(this.loading=!0,this.timerId=setTimeout(()=>this.requestApi(this.currentPage),2e3))},showquiz(t){this.$router.push({name:"quizzes.show",params:{id:t}})},openmodel(t,i){this.modelUserId=t,this.modelName="",this.submitButton=!0,this.resError=!1,this.resSuccess=!1,this.resStringError="",$("#exampleModal").modal("show")},showUrl(){console.log("https://api.pharmiq.uz/")},editquiz(t){this.$router.push({name:"quizzes.edit",params:{id:t}})},onPageChange(t){console.log(t),this.currentPage=t,this.loading=!0,this.requestApi(t),localStorage.setItem("currentPage",t)},refreshList(){this.loading=!0,this.requestApi(1)},async requestApiDelete(){this.disabled=!0;const t={quiz_id:this.modelUserId},i=q(),d=Object.assign(t,i);try{let h=localStorage.getItem("token");console.log(this.modelUserId);const o=await(await fetch(this.url+"api/v1/quizz/delete",{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json",accept:"application/json",Authorization:"Bearer "+h}})).json();o.error?typeof o.message=="object"?this.resError=o.message:this.resStringError=o.message:(this.resSuccess="Successfully Deleted",this.requestApi(1),this.submitButton=!1)}catch(h){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",h)}},requestApi(t,i=null){let d=this.url+"api/v1/quizz?page="+t;i&&(d=this.url+"api/v1/quizz?page=1&search="+i);let h=localStorage.getItem("token");const s={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+h})};fetch(d,s).then(o=>(o.status==401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),o.json())).then(o=>{this.response=o,this.last_page=o.last_page,this.total=o.total,this.per_page=o.per_page,this.quizzes=o.data,console.log(this.quizzes),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{this.loading=!1},1e3)})}},mounted(){this.$i18n.locale="ru",console.log(this.$i18n.availableLocales)},created(){this.userInfo=JSON.parse(localStorage.getItem("user"));const t=localStorage.getItem("currentPage");t&&(this.currentPage=parseInt(t)),this.requestApi(1)}},c=t=>(P("data-v-a5e5d2f3"),t=t(),T(),t),L={class:"row"},x={class:"col-md-3"},B={class:"col-md-6"},D={class:"col-md-3 text-center"},U={class:"mt-3"},j={class:"row"},O={class:"col-12"},M={class:"table-responsive"},Q={class:"table"},J={class:"thead-dark"},V=c(()=>e("th",{scope:"col"},"Lesson Quiz",-1)),R=c(()=>e("th",{scope:"col"},"IQC",-1)),F=c(()=>e("th",{scope:"col"},"Time Limit",-1)),G=c(()=>e("th",{scope:"col"},"Right Answers",-1)),H=c(()=>e("th",{scope:"col"},"Questions",-1)),K={scope:"col"},W={key:0},X={class:"actions"},Y=["onClick"],Z=c(()=>e("i",{class:"ti ti-pencil-alt","data-toggle":"tooltip",title:"Edit"},null,-1)),ee=[Z],te=["onClick"],se=c(()=>e("i",{class:"ti ti-trash","data-toggle":"tooltip",title:"Edit"},null,-1)),oe=[se],re={class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ie={class:"modal-dialog",role:"document"},le={class:"modal-content"},ne=c(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Delete quiz"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"\xD7")])],-1)),ae={class:"modal-body text-center"},ce={class:"error"},ue={key:1,class:"error"},de={key:2,class:"success"},he=c(()=>e("h4",null,"Are you sure you want to delete this quiz?",-1)),pe={class:"modal-footer"},me=c(()=>e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"},"Close",-1)),_e=["disabled"],ge={key:0,class:"loading"},fe=c(()=>e("img",{src:N},null,-1)),Ie=[fe];function be(t,i,d,h,s,o){const I=_("CrudButton"),b=_("LanguageSwitcher"),z=_("Pagination");return l(),n(p,null,[e("div",L,[e("div",x,[s.userInfo&&(s.userInfo.role=="Creator"||s.userInfo.role=="Owner")?(l(),g(I,{key:0,urlName:"quizzes.add",btnName:"Add quiz"})):u("",!0)]),e("div",B,[k(e("input",{type:"search",onInput:i[0]||(i[0]=(...r)=>o.searchcourse&&o.searchcourse(...r)),"onUpdate:modelValue":i[1]||(i[1]=r=>s.courseSearch=r),class:"form-control",placeholder:"Search"},null,544),[[C,s.courseSearch]])]),e("div",D,[A(b)])]),e("div",U,[e("div",j,[e("div",O,[e("div",M,[e("table",Q,[e("thead",J,[e("tr",null,[V,R,F,G,H,e("th",K,a(t.$t("actions")),1)])]),e("tbody",null,[(l(!0),n(p,null,f(s.quizzes,r=>(l(),n(p,{key:r.id},[r.lesson?(l(),n("tr",W,[e("td",null,a(t.$i18n.locale=="ru"?JSON.parse(r.lesson.lessonTitleName).ru:JSON.parse(r.lesson.lessonTitleName).uz),1),e("td",null,a(r.prizeIQC),1),e("td",null,a(r.timeLimits),1),e("td",null,a(r.numberRightAnswersToPass),1),e("td",null,a(r.questions.length),1),e("td",X,[s.userInfo&&(s.userInfo.role=="Creator"||s.userInfo.role=="Owner")?(l(),n("div",{key:0,onClick:m=>o.editquiz(r.id),class:"edit mr-2 cursor-pointer"},ee,8,Y)):u("",!0),s.userInfo&&(s.userInfo.role=="Creator"||s.userInfo.role=="Owner")?(l(),n("div",{key:1,"data-toggle":"modal","data-target":"#exampleModal cursor-pointer",onClick:m=>o.openmodel(r.id),class:"delete text-danger"},oe,8,te)):u("",!0)])])):u("",!0)],64))),128))])])]),s.last_page!=1?(l(),g(z,{key:0,"total-pages":this.last_page,total:this.total,"per-page":this.per_page,"current-page":s.currentPage,onPagechanged:o.onPageChange},null,8,["total-pages","total","per-page","current-page","onPagechanged"])):u("",!0)])])]),e("div",re,[e("div",ie,[e("div",le,[ne,e("div",ae,[s.resError?(l(!0),n(p,{key:0},f(s.resError,(r,m)=>(l(),n("p",ce,a(m)+" : "+a(r[0]),1))),256)):u("",!0),s.resStringError?(l(),n("p",ue,a(s.resStringError),1)):u("",!0),s.resSuccess?(l(),n("p",de,a(s.resSuccess),1)):u("",!0),he,e("h4",null,a(s.modelName),1),e("p",null,"quizId: "+a(s.modelUserId),1)]),e("div",pe,[me,s.submitButton?(l(),n("button",{key:0,disabled:s.disabled,type:"button",onClick:i[2]||(i[2]=(...r)=>o.requestApiDelete&&o.requestApiDelete(...r)),class:"btn btn-primary"},"Delete quiz",8,_e)):u("",!0)])])])]),s.loading?(l(),n("div",ge,Ie)):u("",!0)],64)}const qe=w(E,[["render",be],["__scopeId","data-v-a5e5d2f3"]]);export{qe as default};
