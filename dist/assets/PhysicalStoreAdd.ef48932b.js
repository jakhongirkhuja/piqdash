import{G as I}from"./GoBackButton.8ec57f12.js";import{c as w}from"./vue-datepicker.es.17b3f44e.js";import{h as z}from"./maska.esm.cd315c5a.js";import{u as L,r as _,m as b}from"./index.esm.b21b73c4.js";import{_ as C,a4 as S,a5 as D,r as T,o as n,c as a,f as U,a as t,F as u,e as m,d as y,t as d,l as j,w as v,p as x,n as g,v as k,a2 as B,a3 as A}from"./index.34e73fda.js";import{s as E}from"./globalFunction.5ce06618.js";const O={setup(){return{v$:L()}},directives:{maska:z},components:{GoBackButton:I,Datepicker:w,yandexMap:S,ymapMarker:D},data(){return{url:"https://api.pharmiq.uz/",name:"",added:!1,resError:!1,resSuccess:!1,resStringError:"",userInfo:null,descriptionText_ru:"",descriptionText_uz:"",categoryID:null,categories:[],storeOwners:[],storeOwnerID:null,storeLandmark_ru:"",storeLandmark_uz:"",lat:null,long:null,mainContact:"",extraContact:""}},computed:{isDisabled:function(){if(this.v$.$touch(),this.v$.$error)return!0}},validations(){return{descriptionText_ru:{required:_,minLengthValue:b(5)},descriptionText_uz:{required:_,minLengthValue:b(5)},lat:{required:_},long:{required:_},mainContact:{required:_},extraContact:{required:_},storeOwnerID:{required:_},name:{required:_,minLengthValue:b(3)},storeLandmark_ru:{required:_},storeLandmark_uz:{required:_},categoryID:{required:_}}},methods:{async requestApi(){this.added=!0;const c={latitude:this.lat,longitude:this.long,landmark_ru:this.storeLandmark_ru,landmark_uz:this.storeLandmark_uz,description_ru:this.descriptionText_ru,description_uz:this.descriptionText_uz,name:this.name,category_id:this.categoryID,owner:this.storeOwnerID,mainContact:this.mainContact,extraContact:this.extraContact},o=E(),h=Object.assign(c,o);var r=new FormData;r.append("img",this.banner_ru);for(const s in h)r.append(s,h[s]);try{let s=localStorage.getItem("token");const i=await fetch(this.url+"api/v1/store/physicalstore/add",{method:"POST",body:r,headers:{"Accept-Language":"en-US,en;q=0.8",accept:"application/json",Authorization:"Bearer "+s}}),f=await i.json();window.scrollTo({top:0,behavior:"smooth"}),i.status==401?(this.resStringError=f.message,this.added=!1):f.error?(typeof f.message=="object"?this.resError=f.message:this.resStringError=f.message,this.added=!1):this.resSuccess="Store Successfully Added"}catch(s){console.error("\u041E\u0448\u0438\u0431\u043A\u0430:",s)}},uploadFilebannerRu(c){var o=c.target.files||c.dataTransfer.files;if(!o.length){this.banner_ru=[],this.banner_ru_prev="";return}this.banner_ru=o[0],this.banner_ru_prev=URL.createObjectURL(o[0])},getAddressByCoor(c,o){this.lat=c,this.long=o;let h=this.url+"api/v1/getAdressByCoor?lat="+c+"&long="+o,r=localStorage.getItem("token");const s={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r})};fetch(h,s).then(i=>(i.status==401&&(localcategoryage.removeItem("token"),localcategoryage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),i.json())).then(i=>{this.storeLandmark_ru="",this.storeLandmark_uz="",i.street||i.house?(i.street&&(this.storeLandmark_ru+=i.street,this.storeLandmark_uz+=i.street),i.house&&(this.storeLandmark_ru+=" "+i.house,this.storeLandmark_uz+=" "+i.house)):(i.other&&(this.storeLandmark_ru+=" "+i.other,this.storeLandmark_uz+=" "+i.other),i.area&&(this.storeLandmark_ru+=" "+i.area,this.storeLandmark_uz+=" "+i.area)),console.log(this.storeLandmark_ru)})},submitForm(){this.v$.$touch(),!this.v$.$error&&this.requestApi()},requestGetcategories(){let c=this.url+"api/v1/store/category?page=1",o=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(c,h).then(r=>(r.status==401&&(localcategoryage.removeItem("token"),localcategoryage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.categories=r.data})},requestGetStoreOwners(){let c=this.url+"api/v1/store/storeOwner",o=localStorage.getItem("token");const h={method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+o})};fetch(c,h).then(r=>(r.status==401&&(localcategoryage.removeItem("token"),localcategoryage.removeItem("user"),window.location.href="https://go.pharmiq.uz/"),r.json())).then(r=>{this.storeOwners=r.data})}},created(){this.requestGetcategories(),this.requestGetStoreOwners(),ymaps.ready(c=>{var o=new ymaps.Map("map",{center:[41.311081,69.240562],zoom:11},{searchControlProvider:"yandex#search"});console.log(this.lat),o.events.add("click",h=>{if(o.balloon.isOpen())o.balloon.close();else{var r=h.get("coords");o.balloon.open(r,{contentBody:"<p>Coordinates: "+[r[0].toPrecision(6),r[1].toPrecision(6)].join(", ")+"</p>",contentFooter:"<sup>Click again</sup>"}),this.getAddressByCoor(r[0],r[1])}})})}},p=c=>(B("data-v-fc1117a4"),c=c(),A(),c),V={class:"mt-3"},M={class:"row"},$={class:"col-md-12 grid-margin stretch-card"},q={class:"card"},G={class:"card-body"},N=p(()=>t("h4",{class:"card-title"},"Add Store",-1)),R={class:"error"},P={key:1,class:"error"},F={key:2,class:"success"},H={class:"form-group row"},J={class:"col-md-6"},K=p(()=>t("label",{for:"banner"},"Category",-1)),Q=p(()=>t("option",{disabled:"",value:"0"},"Please select one",-1)),W=["value"],X={class:"col-md-6"},Y=p(()=>t("label",{for:"banner"},"Store Owner",-1)),Z=p(()=>t("option",{disabled:"",value:"0"},"Please select one",-1)),ee=["value"],re={class:"col-md-12"},te=p(()=>t("label",{for:"exampleInputNameRu"},"Name",-1)),oe={class:"col-md-6"},se=p(()=>t("label",{for:"exampleInputDescriptionRu"},"Description Ru",-1)),ne={class:"col-md-6"},ae=p(()=>t("label",{for:"exampleInputDescriptionUz"},"Description Uz",-1)),le={class:"col-md-12 mt-4"},ie={class:"col-md-6"},ce=p(()=>t("label",{for:"exampleInputLandMark"},"Street, house Ru",-1)),de={class:"col-md-6"},ue=p(()=>t("label",{for:"exampleInputLandMarkUz"},"Street, house Uz",-1)),me={class:"col-md-6"},pe=p(()=>t("label",{for:"exampleInputMainContact"},"Main Contact",-1)),he={class:"col-md-6"},_e=p(()=>t("label",{for:"exampleInputExtraContact"},"Extra Contact",-1)),ge=["disabled"];function ve(c,o,h,r,s,i){const f=T("GoBackButton");return n(),a(u,null,[U(f),t("div",V,[t("div",M,[t("div",$,[t("div",q,[t("div",G,[N,s.resError?(n(!0),a(u,{key:0},m(s.resError,(e,l)=>(n(),a("p",R,d(l)+" : "+d(e[0]),1))),256)):y("",!0),s.resStringError?(n(),a("p",P,d(s.resStringError),1)):y("",!0),s.resSuccess?(n(),a("p",F,d(s.resSuccess),1)):y("",!0),t("form",{class:"forms-sample",onSubmit:o[9]||(o[9]=j(e=>i.submitForm(),["prevent"]))},[t("div",H,[t("div",J,[K,v(t("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>s.categoryID=e),class:g(["form-control",{"border border-danger":r.v$.categoryID.$errors.length>0}])},[Q,(n(!0),a(u,null,m(s.categories,e=>(n(),a("option",{key:e.id,value:e.id},d(JSON.parse(e.name).ru),9,W))),128))],2),[[x,s.categoryID]]),(n(!0),a(u,null,m(r.v$.categoryID.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",X,[Y,v(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>s.storeOwnerID=e),class:g(["form-control",{"border border-danger":r.v$.storeOwnerID.$errors.length>0}])},[Z,(n(!0),a(u,null,m(s.storeOwners,e=>{var l;return n(),a("option",{key:e.id,value:(l=e.phonebook)==null?void 0:l.user_id},d(e.firstName+" "+e.lastName),9,ee)}),128))],2),[[x,s.storeOwnerID]]),(n(!0),a(u,null,m(r.v$.storeOwnerID.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",re,[te,v(t("input",{type:"text",class:g(["form-control",{"border border-danger":r.v$.name.$errors.length>0}]),placeholder:"Store Name",id:"exampleInputNameRu","onUpdate:modelValue":o[2]||(o[2]=e=>s.name=e)},null,2),[[k,s.name]]),(n(!0),a(u,null,m(r.v$.name.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",oe,[se,v(t("textarea",{rows:"10",type:"text",class:g(["form-control",{"border border-danger":r.v$.descriptionText_ru.$errors.length>0}]),id:"exampleInputDescriptionRu","onUpdate:modelValue":o[3]||(o[3]=e=>s.descriptionText_ru=e)},null,2),[[k,s.descriptionText_ru]]),(n(!0),a(u,null,m(r.v$.descriptionText_ru.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",ne,[ae,v(t("textarea",{rows:"10",type:"text",class:g(["form-control",{"border border-danger":r.v$.descriptionText_uz.$errors.length>0}]),id:"exampleInputDescriptionUz","onUpdate:modelValue":o[4]||(o[4]=e=>s.descriptionText_uz=e)},null,2),[[k,s.descriptionText_uz]]),(n(!0),a(u,null,m(r.v$.descriptionText_uz.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",le,[t("div",{id:"map",style:{"min-width":"95%",height:"400px",overflow:"hidden"},class:g({"border border-danger":r.v$.lat.$errors.length>0})},null,2),(n(!0),a(u,null,m(r.v$.lat.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},"Select Address in Map"))),128))]),t("div",ie,[ce,v(t("input",{type:"text",class:g(["form-control",{"border border-danger":r.v$.storeLandmark_ru.$errors.length>0}]),placeholder:"Street, house",id:"exampleInputLandMark","onUpdate:modelValue":o[5]||(o[5]=e=>s.storeLandmark_ru=e)},null,2),[[k,s.storeLandmark_ru]]),(n(!0),a(u,null,m(r.v$.storeLandmark_ru.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",de,[ue,v(t("input",{type:"text",class:g(["form-control",{"border border-danger":r.v$.storeLandmark_uz.$errors.length>0}]),placeholder:"Street, house",id:"exampleInputLandMarkUz","onUpdate:modelValue":o[6]||(o[6]=e=>s.storeLandmark_uz=e)},null,2),[[k,s.storeLandmark_uz]]),(n(!0),a(u,null,m(r.v$.storeLandmark_uz.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",me,[pe,v(t("input",{type:"text",class:g(["form-control",{"border border-danger":r.v$.mainContact.$errors.length>0}]),placeholder:"998991112233",id:"exampleInputMainContact","onUpdate:modelValue":o[7]||(o[7]=e=>s.mainContact=e)},null,2),[[k,s.mainContact]]),(n(!0),a(u,null,m(r.v$.mainContact.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))]),t("div",he,[_e,v(t("input",{type:"text",class:g(["form-control",{"border border-danger":r.v$.extraContact.$errors.length>0}]),placeholder:"998991112233",id:"exampleInputExtraContact","onUpdate:modelValue":o[8]||(o[8]=e=>s.extraContact=e)},null,2),[[k,s.extraContact]]),(n(!0),a(u,null,m(r.v$.extraContact.$errors,(e,l)=>(n(),a("small",{class:"error",key:l},d(e.$message),1))),128))])]),s.added?y("",!0):(n(),a("button",{key:0,type:"submit",disabled:i.isDisabled,class:"btn btn-primary mr-2"},"Create",8,ge))],32)])])])])])],64)}const we=C(O,[["render",ve],["__scopeId","data-v-fc1117a4"]]);export{we as default};
